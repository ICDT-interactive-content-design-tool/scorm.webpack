/*! For license information please see bundle.js.LICENSE.txt */
(()=>{"use strict";var e,t={249:(e,t,i)=>{function n(e,t){return t.forEach((function(t){t&&"string"!=typeof t&&!Array.isArray(t)&&Object.keys(t).forEach((function(i){if("default"!==i&&!(i in e)){var n=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(e,i,n.get?n:{enumerable:!0,get:function(){return t[i]}})}}))})),Object.freeze(e)}i.r(t),i.d(t,{APP_FONT:()=>N,APP_FONT_Content:()=>_,LocalStorage_GetClipboard:()=>Wt,LocalStorage_GetConfig:()=>Qt,LocalStorage_GetData:()=>Gt,LocalStorage_SetClipboard:()=>Vt,LocalStorage_SetConfig:()=>Ut,LocalStorage_SetData:()=>Dt,V_ForeignObjectType:()=>u,V_ID:()=>r,V_Keyboard:()=>v,V_MediaType:()=>c,V_OssType:()=>h,V_PenType:()=>l,V_PointerType:()=>o,V_PolygonRatio:()=>d,V_PolygonType:()=>s,V_ShapeType:()=>a,animate:()=>gn,animateIn:()=>pn,animateOut:()=>yn,attributeDominantBaseline:()=>eo,attributeFill:()=>Br,attributeFillOpacity:()=>Rr,attributeFontFamily:()=>Qr,attributeFontSize:()=>Vr,attributeFontStyle:()=>Wr,attributeFontWeight:()=>Ur,attributeLetterSpacing:()=>Xr,attributeOpacity:()=>Ar,attributePreserveAspectRatio:()=>Dr,attributeR:()=>to,attributeRx:()=>io,attributeRy:()=>no,attributeStroke:()=>Mr,attributeStrokeDasharray:()=>Fr,attributeStrokeLinecap:()=>Kr,attributeStrokeLinejoin:()=>Gr,attributeStrokeOpacity:()=>Lr,attributeStrokeWidth:()=>Pr,attributeTextAnchor:()=>Zr,attributeTextDecoration:()=>Yr,attributeTextLength:()=>Hr,attributeWordSpacing:()=>qr,combineData:()=>vn,extractFont:()=>E,extractFontFromData:()=>I,extractFromDataV1:()=>xe,extractFromSVG:()=>an,extractSourceV1:()=>we,getMediaViewerUrl:()=>T,icdt:()=>nn,icdt_ActiveNodes:()=>ct,icdt_AlignBottom:()=>xr,icdt_AlignCenter:()=>kr,icdt_AlignLeft:()=>br,icdt_AlignMiddle:()=>Or,icdt_AlignParentBottom:()=>Ir,icdt_AlignParentCenter:()=>zr,icdt_AlignParentLeft:()=>_r,icdt_AlignParentMiddle:()=>Jr,icdt_AlignParentRight:()=>Er,icdt_AlignParentTop:()=>Nr,icdt_AlignRight:()=>Sr,icdt_AlignStretchX:()=>jr,icdt_AlignStretchY:()=>Tr,icdt_AlignTop:()=>wr,icdt_IndexComponent:()=>Mi,icdt_Init:()=>Fi,icdt_Interactive:()=>xi,icdt_InteractiveComponent:()=>Oi,icdt_Keyboard:()=>ii,icdt_KeyboardComponent:()=>ni,icdt_PenComponent:()=>ki,icdt_PointerScale:()=>rt,icdt_RenderComponent:()=>Ht,icdt_RoundNumber:()=>B,icdt_Run:()=>Be,icdt_SlideClearNodeIndex:()=>Pi,icdt_SortComponent:()=>Xt,icdt_StretchParentX:()=>$r,icdt_StretchParentY:()=>Cr,icdt_Svg:()=>Me,icdt_SvgRenew:()=>Fe,icdt_SyncSvgBackground:()=>Le,icdt_SyncSvgNode:()=>Ke,icdt_SyncSvgNode4Design:()=>We,icdt_SyncSvgNodeAttribute:()=>Ge,icdt_SyncSvgNodeSource:()=>Qe,icdt_SyncSvgNodeStyle:()=>De,icdt_SyncSvgNodeStyleActive:()=>Ue,icdt_SyncSvgStyle:()=>Pe,interactiveClickActionFinish:()=>Gn,interactiveClickActionIteration:()=>Kn,interactiveClickActionPoints:()=>Pn,interactiveClickActionTime:()=>Fn,interactiveClickActionValue:()=>Ln,interactiveClickAudioAsync:()=>Wn,interactiveClickAudioFinish:()=>Un,interactiveClickAudioIteration:()=>Qn,interactiveClickAudioSource:()=>Dn,interactiveClickAudioTime:()=>Vn,interactiveClickImageSource:()=>dr,interactiveClickLinkSource:()=>cr,interactiveClickLinkSourceUrl:()=>hr,interactiveClickMedia:()=>sr,interactiveClickSlide:()=>ar,interactiveClickText:()=>vr,interactiveClickTriggerHideAsync:()=>or,interactiveClickTriggerHideId:()=>nr,interactiveClickTriggerHideIds:()=>rr,interactiveClickTriggerHideTime:()=>lr,interactiveClickTriggerRunAsync:()=>tr,interactiveClickTriggerRunId:()=>Zn,interactiveClickTriggerRunIds:()=>er,interactiveClickTriggerRunTime:()=>ir,interactiveClickTriggerShowAsync:()=>qn,interactiveClickTriggerShowId:()=>Hn,interactiveClickTriggerShowIds:()=>Xn,interactiveClickTriggerShowTime:()=>Yn,interactiveClickVideoSource:()=>ur,interactiveShowActionFinish:()=>Sn,interactiveShowActionIteration:()=>wn,interactiveShowActionPoints:()=>mn,interactiveShowActionTime:()=>bn,interactiveShowActionValue:()=>fn,interactiveShowAudioAsync:()=>_n,interactiveShowAudioFinish:()=>On,interactiveShowAudioIteration:()=>kn,interactiveShowAudioSource:()=>xn,interactiveShowAudioTime:()=>Nn,interactiveShowTriggerHideAsync:()=>Rn,interactiveShowTriggerHideId:()=>An,interactiveShowTriggerHideIds:()=>Bn,interactiveShowTriggerHideTime:()=>Mn,interactiveShowTriggerRunAsync:()=>$n,interactiveShowTriggerRunId:()=>jn,interactiveShowTriggerRunIds:()=>Tn,interactiveShowTriggerRunTime:()=>Cn,interactiveShowTriggerShowAsync:()=>zn,interactiveShowTriggerShowId:()=>En,interactiveShowTriggerShowIds:()=>In,interactiveShowTriggerShowTime:()=>Jn,isColorHex:()=>rn,isColorRGB:()=>on,isColorText:()=>ln,lib_rgba2hex:()=>z,sizeHeight:()=>ei,sizeRotate:()=>ti,sizeWidth:()=>Zt,sizeX:()=>qt,sizeY:()=>Yt,sourceAudio:()=>yt,sourceEmbed:()=>xt,sourceFile:()=>mt,sourceHtml:()=>vt,sourceIframe:()=>bt,sourceImage:()=>pt,sourceInputPlaceholder:()=>St,sourceLink:()=>gt,sourceText:()=>ht,sourceTrack:()=>wt,sourceVideo:()=>ft,styleBackgroundColor:()=>po,styleBackgroundOpacity:()=>yo,styleBorderColor:()=>ao,styleBorderOpacity:()=>so,styleBorderRadius:()=>uo,styleBorderStyle:()=>lo,styleBorderWidth:()=>oo,styleColor:()=>vo,styleFontFamily:()=>co,styleFontSize:()=>ho,styleOpacity:()=>go,stylePadding:()=>ro,svgBackgroundColor:()=>So,svgBackgroundImage:()=>ko,svgBackgroundOpacity:()=>xo,svgCreate_RectCenterAttribute:()=>g,svgDesign_LineAttribute:()=>p,svgDesign_RectAttribute:()=>y,svgDesign_RectCenterAttribute:()=>f,svgInteractive_LineAttribute:()=>S,svgInteractive_RectCenterAttribute:()=>x,svgSelect_RectNodeAttribute:()=>m,svgSelect_RectTextNodeAttribute:()=>b,svgSelect_TextNodeAttribute:()=>w,svgSetIdx_RectNodeAttribute:()=>k,svgViewBoxHeight:()=>wo,svgViewBoxWidth:()=>bo,svgViewBoxX:()=>fo,svgViewBoxY:()=>mo,syncBackground:()=>tt,syncNodeCreate:()=>Ve,syncNodeIndex:()=>et,syncNodeInteractive:()=>Ze,syncNodeResize:()=>He,syncNodeScan:()=>Ye,syncNodeSelect:()=>qe,syncResizeNodes:()=>Xe,syncSvg:()=>Re,syncTest:()=>it,variableClickOperator:()=>yr,variableClickValue:()=>mr,variableClickValueType:()=>fr,variableClickVariable:()=>pr,variableInputVariable:()=>gr});const r={RESIZE_GROUP:"icdt-resize-g",SELECT_GROUP:"icdt-select-g",SCAN_GROUP:"icdt-scan-g",CREATE_GROUP:"icdt-create-g",INTERACTIVE_GROUP:"icdt-interactive-g",INDEX_GROUP:"icdt-index-g",BACKGROUND_GROUP:"icdt-background-g",TEST_GROUP:"icdt-test-g"},o={POINTER:0,HAND:1,PEN:2,SHAPE:3,FOREIGNOBJECT:6,IMAGE:7,TEXT:4,ERASER:5,INDEX:8},l={DRAW:1,HIGHTLIGH:2,INTERACTIVE:3},a={GROUP:0,CIRCLE:1,ELLIPSE:2,LINE:5,RECT:3,POLYGON:4,FOREIGNOBJECT:6,IMAGE:9,TEXT:7,TSPAN:10,PATH:8,POLYLINE:11},s={TRIANGLE_ISOSCELES:3,TRIANGLE_EQUILATERAL:31,RECTANGLE:4,PENTAGON:5,HEXAGON:6,BOOKMARK:101,COMMENT:102,CROSS:104,ARROW_ONEWAY:201,ARROW_TWOWAY:202,STAR_FOUR:304,STAR_FIVE:305,STAR_SIX:306},d=[{name:"tam giác vuông",type:s.TRIANGLE_ISOSCELES,ratios:[[0,0],[1,1],[0,1]]},{name:"tam giác cân",type:s.TRIANGLE_EQUILATERAL,ratios:[[.5,0],[0,1],[1,1]]},{name:"hình chữ nhật",type:s.RECTANGLE,ratios:[[0,0],[1,0],[1,1],[0,1]]},{name:"hình ngũ giác đều",type:s.PENTAGON,ratios:[[.5,0],[1,.4],[.8,1],[.2,1],[0,.4]]},{name:"hình lục giác đều",type:s.HEXAGON,ratios:[[.5,0],[1,.25],[1,.75],[.5,1],[0,.75],[0,.25]]},{name:"khung đánh dấu vị trí",type:s.BOOKMARK,ratios:[[0,0],[1,0],[1,.8],[.5,1],[0,.8]]},{name:"khung đánh trò chuyện",type:s.COMMENT,ratios:[[0,0],[1,0],[1,.9],[.3,.9],[.2,1],[.1,.9],[0,.9]]},{name:"hình chữ thập",type:s.CROSS,ratios:[[0,.3],[.3,.3],[.3,0],[.7,0],[.7,.3],[1,.3],[1,.7],[.7,.7],[.7,1],[.3,1],[.3,.7],[0,.7]]},{name:"hình mũi tên 1 chiều",type:s.ARROW_ONEWAY,ratios:[[0,.2],[.8,.2],[.8,0],[1,.5],[.8,1],[.8,.8],[0,.8]]},{name:"hình mũi tên 2 chiều",type:s.ARROW_TWOWAY,ratios:[[.2,0],[.2,.2],[.8,.2],[.8,0],[1,.5],[.8,1],[.8,.8],[.2,.8],[.2,1],[0,.5]]},{name:"hình ngôi sao 4 cánh",type:s.STAR_FOUR,ratios:[[.5,0],[.65,.35],[1,.5],[.65,.65],[.5,1],[.35,.65],[0,.5],[.35,.35]]},{name:"hình ngôi sao 5 cánh",type:s.STAR_FIVE,ratios:[[.5,0],[.625,.4],[1,.4],[.675,.625],[.8,1],[.5,.775],[.2,1],[.325,.625],[0,.4],[.375,.4]]},{name:"hình ngôi sao 6 cánh",type:s.STAR_SIX,ratios:[[.5,0],[.667,.25],[1,.25],[.5+.334,.5],[1,.75],[.667,.75],[.5,1],[.334,.75],[0,.75],[.167,.5],[0,.25],[.334,.25]]}],u={IMAGE:1,HTML:2,AUDIO:3,VIDEO:4},c={TEXT:900,IMAGE:901,AUDIO:902,VIDEO:903,LINK:904,ZIP:905,HTML:906,TRACK:907,OFFICE:908,WORD:916,EXCEL:917,POWERPOINT:918,PDF:909,PHET:910,IMAGE_ANIMATION:911,SCORM:912},h={ONEDRIVE:1e3,GOOGLEDRIVE:1001,YOUTUBE:1002,SCORM:1003,PHET:1005,OTHER:1004},v={Digit1:49,Digit2:50,Digit3:51,Digit4:52,Digit5:53,Digit6:54,Digit7:55,Digit8:56,Digit9:57,Digit0:48,KeyA:65,KeyB:66,KeyC:67,KeyD:68,KeyE:69,KeyF:70,KeyG:71,KeyH:72,KeyI:73,KeyJ:74,KeyK:75,KeyL:76,KeyM:77,KeyN:78,KeyO:79,KeyP:80,KeyQ:81,KeyR:82,KeyS:83,KeyT:84,KeyU:85,KeyV:86,KeyW:87,KeyX:88,KeyY:89,KeyZ:90,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,Insert:45,Delete:46,Home:36,End:35,PageUp:33,PageDown:34,ArrowUp:38,ArrowDown:40,ArrowLeft:37,ArrowRight:39,Escape:27,Tab:9,Backspace:8,Enter:13,Space:32,BracketLeft:219,BracketRight:221,Minus:189,Equal:187},g={fill:"transparent",stroke:"#129bff",strokeWidth:1},p={stroke:"#0D99FF",strokeWidth:1,strokeLinecap:"square",strokeDasharrays:[2,5]},y={fill:"#FFFFFF",stroke:"#0D99FF",strokeWidth:1,width:7,height:7},f={fill:"transparent",stroke:"transparent",strokeWidth:1},m={fill:"none",stroke:"#2299F8",strokeWidth:1},b={fill:"#0D99FF",rx:4},w={fill:"#fff",alignmentBaseline:"central",textAnchor:"middle",fontSize:14},S={stroke:"#129bff",strokeWidth:1,strokeLinecap:"square",strokeDasharray:8},x={fill:"transparent"},k={fill:"none",stroke:"#999",strokeWidth:1,strokeDasharray:2};function O(e,t,i,n){return new(i||(i=Promise))((function(r,o){function l(e){try{s(n.next(e))}catch(e){o(e)}}function a(e){try{s(n.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(l,a)}s((n=n.apply(e,t||[])).next())}))}"function"==typeof SuppressedError&&SuppressedError;const _=(e,t)=>{if(!e.length)return;let i=n=>{n&&(document.head.querySelector(`:scope > style[rel="${n}"]`)||document.head.querySelector(`:scope > link[name="${n}"]`)?i(e.shift()):N([n],t).then((t=>{let r=window.document.createElement("style");r.setAttribute("rel",n),r.textContent=t,window.document.head.appendChild(r),i(e.shift())})))};i(e.shift())},N=(e,t)=>O(void 0,void 0,void 0,(function*(){let i=`\n/*!\n * Tabca v1.0.0 (https://tabca.vn)\n * Copyright 2024, Created by Middle Kien. All rights reserved.\n *\n * Tabca commercial licenses may be obtained at https://tabca.vn\n *\n * If you do not own a commercial license, this file shall be governed by the trial license terms.\n * ${e}\n */\n`;var n=[];return e.map((e=>{let i=e.replace(/\s+/g,""),r=e.replace(/[^a-zA-Z0-9]/g,"");n=[...n,new Promise(((n,o)=>{let l=`${t}/${r}/${r}-Regular.ttf`;fetch(l).then((t=>{t.ok?n(`/*normal*/\n                                    @font-face {\n                                        font-family: '${e}';\n                                        src: local('${e} Regular'),\n                                            local('${i}-Regular'),\n                                            url('${l}') format('truetype');\n                                        font-weight: normal;\n                                        font-style: normal;\n                                        font-display: swap;\n                                    }\n                                    `.replace(/\t|\n|\s\s+/g,"").replace(/:\s/g,":")):n(null)})).catch((()=>{n(null)}))})),new Promise(((n,o)=>{let l=`${t}/${r}/${r}-Italic.ttf`;fetch(l).then((t=>{t.ok?n(`/*italic*/\n                                    @font-face {\n                                        font-family: '${e}';\n                                        src: local('${e} Italic'),\n                                            local('${i}-Italic'),\n                                            url('${l}') format('truetype');\n                                        font-weight: normal;\n                                        font-style: italic;\n                                        font-display: swap;\n                                    }\n                                    `.replace(/\t|\n|\s\s+/g,"").replace(/:\s/g,":")):n(null)})).catch((()=>{n(null)}))})),new Promise(((n,o)=>{let l=`${t}/${r}/${r}-Bold.ttf`;fetch(l).then((t=>{t.ok?n(`/*bold*/\n                                    @font-face {\n                                        font-family: '${e}';\n                                        src: local('${e} Bold'),\n                                            local('${i}-Bold'),\n                                            url('${l}') format('truetype');\n                                        font-weight: bold;\n                                        font-style: normal;\n                                        font-display: swap;\n                                    }`.replace(/\t|\n|\s\s+/g,"").replace(/:\s/g,":")):n(null)})).catch((()=>{n(null)}))})),new Promise(((n,o)=>{let l=`${t}/${r}/${r}-BoldItalic.ttf`;fetch(l).then((t=>{t.ok?n(`/*bold italic*/\n                                    @font-face {\n                                        font-family: '${e}';\n                                        src: local('${e} Bold Italic'),\n                                            local('${i}-BoldItalic'),\n                                            url('${l}') format('truetype');\n                                        font-weight: bold;\n                                        font-style: italic;\n                                        font-display: swap;\n                                    }`.replace(/\t|\n|\s\s+/g,"").replace(/:\s/g,":")):n(null)})).catch((()=>{n(null)}))})),new Promise(((n,o)=>{let l=`${t}/${r}/${r}-Thin.ttf`;fetch(l).then((t=>{t.ok?n(`/*100*/\n                                    @font-face {\n                                        font-family: '${e}';\n                                        src: local('${e} Thin'),\n                                            local('${i}-Thin'),\n                                            url('${l}') format('truetype');\n                                        font-weight: 100;\n                                        font-style: normal;\n                                        font-display: swap;\n                                    }`.replace(/\t|\n|\s\s+/g,"").replace(/:\s/g,":")):n(null)})).catch((()=>{n(null)}))})),new Promise(((n,o)=>{let l=`${t}/${r}/${r}-ThinItalic.ttf`;fetch(l).then((t=>{t.ok?n(`/*100 italic*/\n                                    @font-face {\n                                        font-family: '${e}';\n                                        src: local('${e} Thin Italic'),\n                                            local('${i}-ThinItalic'),\n                                            url('${l}') format('truetype');\n                                        font-weight: 100;\n                                        font-style: italic;\n                                        font-display: swap;\n                                    }`.replace(/\t|\n|\s\s+/g,"").replace(/:\s/g,":")):n(null)})).catch((()=>{n(null)}))})),new Promise(((n,o)=>{let l=`${t}/${r}/${r}-ExtraLight.ttf`;fetch(l).then((t=>{t.ok?n(`/*200*/\n                                    @font-face {\n                                        font-family: '${e}';\n                                        src: local('${e} ExtraLight'),\n                                            local('${i}-ExtraLight'),\n                                            url('${l}') format('truetype');\n                                        font-weight: 200;\n                                        font-style: normal;\n                                        font-display: swap;\n                                    }`.replace(/\t|\n|\s\s+/g,"").replace(/:\s/g,":")):n(null)})).catch((()=>{n(null)}))})),new Promise(((n,o)=>{let l=`${t}/${r}/${r}-ExtraLightItalic.ttf`;fetch(l).then((t=>{t.ok?n(`/*200 italic*/\n                                    @font-face {\n                                        font-family: '${e}';\n                                        src: local('${e} ExtraLight Italic'),\n                                            local('${i}-ExtraLightItalic'),\n                                            url('${l}') format('truetype');\n                                        font-weight: 200;\n                                        font-style: italic;\n                                        font-display: swap;\n                                    }`.replace(/\t|\n|\s\s+/g,"").replace(/:\s/g,":")):n(null)})).catch((()=>{n(null)}))})),new Promise(((n,o)=>{let l=`${t}/${r}/${r}-UltraLight.ttf`;fetch(l).then((t=>{t.ok?n(`/*200*/\n                                    @font-face {\n                                        font-family: '${e}';\n                                        src: local('${e} UltraLight'),\n                                            local('${i}-UltraLight'),\n                                            url('${l}') format('truetype');\n                                        font-weight: 200;\n                                        font-style: normal;\n                                        font-display: swap;\n                                    }`.replace(/\t|\n|\s\s+/g,"").replace(/:\s/g,":")):n(null)})).catch((()=>{n(null)}))})),new Promise(((n,o)=>{let l=`${t}/${r}/${r}-UltraLightItalic.ttf`;fetch(l).then((t=>{t.ok?n(`/*200 italic*/\n                                    @font-face {\n                                        font-family: '${e}';\n                                        src: local('${e} UltraLight Italic'),\n                                            local('${i}-UltraLightItalic'),\n                                            url('${l}') format('truetype');\n                                        font-weight: 200;\n                                        font-style: italic;\n                                        font-display: swap;\n                                    }`.replace(/\t|\n|\s\s+/g,"").replace(/:\s/g,":")):n(null)})).catch((()=>{n(null)}))})),new Promise(((n,o)=>{let l=`${t}/${r}/${r}-Light.ttf`;fetch(l).then((t=>{t.ok?n(`/*300*/\n                                    @font-face {\n                                        font-family: '${e}';\n                                        src: local('${e} Light'),\n                                            local('${i}-Light'),\n                                            url('${l}') format('truetype');\n                                        font-weight: 300;\n                                        font-style: normal;\n                                        font-display: swap;\n                                    }`.replace(/\t|\n|\s\s+/g,"").replace(/:\s/g,":")):n(null)})).catch((()=>{n(null)}))})),new Promise(((n,o)=>{let l=`${t}/${r}/${r}-LightItalic.ttf`;fetch(l).then((t=>{t.ok?n(`/*300 italic*/\n                                    @font-face {\n                                        font-family: '${e}';\n                                        src: local('${e} Light Italic'),\n                                            local('${i}-LightItalic'),\n                                            url('${l}') format('truetype');\n                                        font-weight: 300;\n                                        font-style: italic;\n                                        font-display: swap;\n                                    }`.replace(/\t|\n|\s\s+/g,"").replace(/:\s/g,":")):n(null)})).catch((()=>{n(null)}))})),new Promise(((n,o)=>{let l=`${t}/${r}/${r}-Regular.ttf`;fetch(l).then((t=>{t.ok?n(`/*400*/\n                                    @font-face {\n                                        font-family: '${e}';\n                                        src: local('${e} Regular'),\n                                            local('${i}-Regular'),\n                                            url('${l}') format('truetype');\n                                        font-weight: 400;\n                                        font-style: normal;\n                                        font-display: swap;\n                                    }`.replace(/\t|\n|\s\s+/g,"").replace(/:\s/g,":")):n(null)})).catch((()=>{n(null)}))})),new Promise(((n,o)=>{let l=`${t}/${r}/${r}-Normal.ttf`;fetch(l).then((t=>{t.ok?n(`/*400*/\n                                    @font-face {\n                                        font-family: '${e}';\n                                        src: local('${e} Normal'),\n                                            local('${i}-Normal'),\n                                            url('${l}') format('truetype');\n                                        font-weight: 400;\n                                        font-style: normal;\n                                        font-display: swap;\n                                    }`.replace(/\t|\n|\s\s+/g,"").replace(/:\s/g,":")):n(null)})).catch((()=>{n(null)}))})),new Promise(((n,o)=>{let l=`${t}/${r}/${r}-Italic.ttf`;fetch(l).then((t=>{t.ok?n(`/*400 italic*/\n                                    @font-face {\n                                        font-family: '${e}';\n                                        src: local('${e} Italic'),\n                                            local('${i}-Italic'),\n                                            url('${l}') format('truetype');\n                                        font-weight: 400;\n                                        font-style: italic;\n                                        font-display: swap;\n                                    }`.replace(/\t|\n|\s\s+/g,"").replace(/:\s/g,":")):n(null)})).catch((()=>{n(null)}))})),new Promise(((n,o)=>{let l=`${t}/${r}/${r}-Medium.ttf`;fetch(l).then((t=>{t.ok?n(`/*500*/\n                                    @font-face {\n                                        font-family: '${e}';\n                                        src: local('${e} Medium'),\n                                            local('${i}-Medium'),\n                                            url('${l}') format('truetype');\n                                        font-weight: 500;\n                                        font-style: normal;\n                                        font-display: swap;\n                                    }`.replace(/\t|\n|\s\s+/g,"").replace(/:\s/g,":")):n(null)})).catch((()=>{n(null)}))})),new Promise(((n,o)=>{let l=`${t}/${r}/${r}-MediumItalic.ttf`;fetch(l).then((t=>{t.ok?n(`/*500 italic*/\n                                    @font-face {\n                                        font-family: '${e}';\n                                        src: local('${e} Medium Italic'),\n                                            local('${i}-MediumItalic'),\n                                            url('${l}') format('truetype');\n                                        font-weight: 500;\n                                        font-style: italic;\n                                        font-display: swap;\n                                    }`.replace(/\t|\n|\s\s+/g,"").replace(/:\s/g,":")):n(null)})).catch((()=>{n(null)}))})),new Promise(((n,o)=>{let l=`${t}/${r}/${r}-SemiBold.ttf`;fetch(l).then((t=>{t.ok?n(`/*600*/\n                                    @font-face {\n                                        font-family: '${e}';\n                                        src: local('${e} SemiBold'),\n                                            local('${i}-SemiBold'),\n                                            url('${l}') format('truetype');\n                                        font-weight: 600;\n                                        font-style: normal;\n                                        font-display: swap;\n                                    }`.replace(/\t|\n|\s\s+/g,"").replace(/:\s/g,":")):n(null)})).catch((()=>{n(null)}))})),new Promise(((n,o)=>{let l=`${t}/${r}/${r}-SemiBoldItalic.ttf`;fetch(l).then((t=>{t.ok?n(`/*600 italic*/\n                                    @font-face {\n                                        font-family: '${e}';\n                                        src: local('${e} SemiBold Italic'),\n                                            local('${i}-SemiBoldItalic'),\n                                            url('${l}') format('truetype');\n                                        font-weight: 600;\n                                        font-style: italic;\n                                        font-display: swap;\n                                    }`.replace(/\t|\n|\s\s+/g,"").replace(/:\s/g,":")):n(null)})).catch((()=>{n(null)}))})),new Promise(((n,o)=>{let l=`${t}/${r}/${r}-DemiBold.ttf`;fetch(l).then((t=>{t.ok?n(`/*600*/\n                                    @font-face {\n                                        font-family: '${e}';\n                                        src: local('${e} DemiBold'),\n                                            local('${i}-DemiBold'),\n                                            url('${l}') format('truetype');\n                                        font-weight: 600;\n                                        font-style: normal;\n                                        font-display: swap;\n                                    }`.replace(/\t|\n|\s\s+/g,"").replace(/:\s/g,":")):n(null)})).catch((()=>{n(null)}))})),new Promise(((n,o)=>{let l=`${t}/${r}/${r}-DemiBoldItalic.ttf`;fetch(l).then((t=>{t.ok?n(`/*600 italic*/\n                                    @font-face {\n                                        font-family: '${e}';\n                                        src: local('${e} DemiBold Italic'),\n                                            local('${i}-DemiBoldItalic'),\n                                            url('${l}') format('truetype');\n                                        font-weight: 600;\n                                        font-style: italic;\n                                        font-display: swap;\n                                    }`.replace(/\t|\n|\s\s+/g,"").replace(/:\s/g,":")):n(null)})).catch((()=>{n(null)}))})),new Promise(((n,o)=>{let l=`${t}/${r}/${r}-Bold.ttf`;fetch(l).then((t=>{t.ok?n(`/*700*/\n                                    @font-face {\n                                        font-family: '${e}';\n                                        src: local('${e} Bold'),\n                                            local('${i}-Bold'),\n                                            url('${l}') format('truetype');\n                                        font-weight: 700;\n                                        font-style: normal;\n                                        font-display: swap;\n                                    }`.replace(/\t|\n|\s\s+/g,"").replace(/:\s/g,":")):n(null)})).catch((()=>{n(null)}))})),new Promise(((n,o)=>{let l=`${t}/${r}/${r}-BoldItalic.ttf`;fetch(l).then((t=>{t.ok?n(`/*700 italic*/\n                                    @font-face {\n                                        font-family: '${e}';\n                                        src: local('${e} Bold Italic'),\n                                            local('${i}-BoldItalic'),\n                                            url('${l}') format('truetype');\n                                        font-weight: 700;\n                                        font-style: italic;\n                                        font-display: swap;\n                                    }`.replace(/\t|\n|\s\s+/g,"").replace(/:\s/g,":")):n(null)})).catch((()=>{n(null)}))})),new Promise(((n,o)=>{let l=`${t}/${r}/${r}-ExtraBold.ttf`;fetch(l).then((t=>{t.ok?n(`/*800*/\n                                    @font-face {\n                                        font-family: '${e}';\n                                        src: local('${e} ExtraBold'),\n                                            local('${i}-ExtraBold'),\n                                            url('${l}') format('truetype');\n                                        font-weight: 800;\n                                        font-style: normal;\n                                        font-display: swap;\n                                    }`.replace(/\t|\n|\s\s+/g,"").replace(/:\s/g,":")):n(null)})).catch((()=>{n(null)}))})),new Promise(((n,o)=>{let l=`${t}/${r}/${r}-ExtraBoldItalic.ttf`;fetch(l).then((t=>{t.ok?n(`/*800 italic*/\n                                    @font-face {\n                                        font-family: '${e}';\n                                        src: local('${e} ExtraBold Italic'),\n                                            local('${i}-ExtraBoldItalic'),\n                                            url('${l}') format('truetype');\n                                        font-weight: 800;\n                                        font-style: italic;\n                                        font-display: swap;\n                                    }`.replace(/\t|\n|\s\s+/g,"").replace(/:\s/g,":")):n(null)})).catch((()=>{n(null)}))})),new Promise(((n,o)=>{let l=`${t}/${r}/${r}-UltraBold.ttf`;fetch(l).then((t=>{t.ok?n(`/*800*/\n                                    @font-face {\n                                        font-family: '${e}';\n                                        src: local('${e} UltraBold'),\n                                            local('${i}-UltraBold'),\n                                            url('${l}') format('truetype');\n                                        font-weight: 800;\n                                        font-style: normal;\n                                        font-display: swap;\n                                    }`.replace(/\t|\n|\s\s+/g,"").replace(/:\s/g,":")):n(null)})).catch((()=>{n(null)}))})),new Promise(((n,o)=>{let l=`${t}/${r}/${r}-UltraBoldItalic.ttf`;fetch(l).then((t=>{t.ok?n(`/*800 italic*/\n                                    @font-face {\n                                        font-family: '${e}';\n                                        src: local('${e} UltraBold Italic'),\n                                            local('${i}-UltraBoldItalic'),\n                                            url('${l}') format('truetype');\n                                        font-weight: 800;\n                                        font-style: italic;\n                                        font-display: swap;\n                                    }`.replace(/\t|\n|\s\s+/g,"").replace(/:\s/g,":")):n(null)})).catch((()=>{n(null)}))})),new Promise(((n,o)=>{let l=`${t}/${r}/${r}-Black.ttf`;fetch(l).then((t=>{t.ok?n(`/*900*/\n                                    @font-face {\n                                        font-family: '${e}';\n                                        src: local('${e} Black'),\n                                            local('${i}-Black'),\n                                            url('${l}') format('truetype');\n                                        font-weight: 900;\n                                        font-style: normal;\n                                        font-display: swap;\n                                    }`.replace(/\t|\n|\s\s+/g,"").replace(/:\s/g,":")):n(null)})).catch((()=>{n(null)}))})),new Promise(((n,o)=>{let l=`${t}/${r}/${r}-BlackItalic.ttf`;fetch(l).then((t=>{t.ok?n(`/*900 italic*/\n                                    @font-face {\n                                        font-family: '${e}';\n                                        src: local('${e} Black Italic'),\n                                            local('${i}-BlackItalic'),\n                                            url('${l}') format('truetype');\n                                        font-weight: 900;\n                                        font-style: italic;\n                                        font-display: swap;\n                                    }`.replace(/\t|\n|\s\s+/g,"").replace(/:\s/g,":")):n(null)})).catch((()=>{n(null)}))})),new Promise(((n,o)=>{let l=`${t}/${r}/${r}-Heavy.ttf`;fetch(l).then((t=>{t.ok?n(`/*900*/\n                                    @font-face {\n                                        font-family: '${e}';\n                                        src: local('${e} Heavy'),\n                                            local('${i}-Heavy'),\n                                            url('${l}') format('truetype');\n                                        font-weight: 900;\n                                        font-style: normal;\n                                        font-display: swap;\n                                    }`.replace(/\t|\n|\s\s+/g,"").replace(/:\s/g,":")):n(null)})).catch((()=>{n(null)}))})),new Promise(((n,o)=>{let l=`${t}/${r}/${r}-HeavyItalic.ttf`;fetch(l).then((t=>{t.ok?n(`/*900 italic*/\n                                    @font-face {\n                                        font-family: '${e}';\n                                        src: local('${e} Heavy Italic'),\n                                            local('${i}-HeavyItalic'),\n                                            url('${l}') format('truetype');\n                                        font-weight: 900;\n                                        font-style: italic;\n                                        font-display: swap;\n                                    }`.replace(/\t|\n|\s\s+/g,"").replace(/:\s/g,":")):n(null)})).catch((()=>{n(null)}))}))]})),Promise.all(n).then((e=>i+e.filter((e=>e)).join("\n")))})),E=e=>{var t,i,n,r={};let o=/Italic$/,l=/Thin$/,a=/ExtraLight|UltraLight$/i,s=/Light$/,d=/Regular|Normal$/,u=/Medium$/,c=/SemiBold|DemiBold$/i,h=/Bold$/,v=/ExtraBold|UltraBold$/i,g=/Black|Heavy$/;return(e=null!==(n=null===(i=null===(t=e.split(","))||void 0===t?void 0:t.shift())||void 0===i?void 0:i.trim().replace(/[^a-zA-Z_-\s]/g,""))&&void 0!==n?n:"").match(o)&&(r.fontStyle="italic",e=e.replace(o,"").trim()),e.match(l)?(r.fontWeight=100,e=e.replace(l,"").trim()):e.match(a)?(r.fontWeight=200,e=e.replace(a,"").trim()):e.match(s)?(r.fontWeight=300,e=e.replace(s,"").trim()):e.match(d)?(r.fontWeight=400,e=e.replace(d,"").trim()):e.match(u)?(r.fontWeight=500,e=e.replace(u,"").trim()):e.match(c)?(r.fontWeight=600,e=e.replace(c,"").trim()):e.match(h)?(r.fontWeight=700,e=e.replace(h,"").trim()):e.match(v)?(r.fontWeight=800,e=e.replace(v,"").trim()):e.match(g)&&(r.fontWeight=900,e=e.replace(g,"").trim()),r.fontFamily=e.replace(/[\-\_\s]+$/,""),r},I=e=>{let t=[];return[/font-family\s*:\s*([^;]+);/g,/"fontFamily":"([a-zA-Z0-9\-\_\'\s]+)"/g].forEach((i=>{var n,r;t=[...t,...null!==(r=null===(n=e.replace(/&quot;/g,"'").match(i))||void 0===n?void 0:n.filter(((e,t,i)=>i.indexOf(e)==t)).map((e=>e.replace(i,"$1").replace(/[^a-zA-Z0-9\-\_\s\,]/g,"").trim())).filter(((e,t,i)=>e&&i.indexOf(e)==t)))&&void 0!==r?r:[]]})),t.filter(((e,t,i)=>i.indexOf(e)==t)).map((e=>E(e).fontFamily)).filter((e=>!!e)).filter(((e,t,i)=>i.indexOf(e)==t))},z=(e,t)=>{if(!e)return"";let i=e.replace(/\s/g,"").match(/^rgba?\((\d+),(\d+),(\d+),?([^,\s)]+)?/i),n=(i&&i[4]||"").trim(),r=i?(256|i[1]).toString(16).slice(1)+(256|i[2]).toString(16).slice(1)+(256|i[3]).toString(16).slice(1):e;if("0"==n)return"transparent";if(t){let e;e=""!==n?n:"01",e=(255*e|256).toString(16).slice(1),r+=e}return`#${r}`};var J=/^#?[a-fA-F0-9]+$/;const j=(e,t)=>{if("none"==(e=null!=e?e:""))return"none";if("transparent"==e)return"rgba(0,0,0,0)";if(e.includes("rgba("))return e;if(e.includes("rgb(")&&(e=z(e)),!(e=e.replace(/[^0-9a-fA-F]/g,"")))return"";if(!J.test(e))return console.error(`hex2rgba -> ${e}: first argument has invalid hexadecimal characters`),"";if("#"===e[0]&&(e=e.slice(1)),3===e.length){let t=e.split("");t.splice(2,0,e[2]),t.splice(1,0,e[1]),t.splice(0,0,e[0]),e=t.join("")}if(6!==e.length)return console.error("hex2rgba: first argument has invalid hexadecimal length"),"";var i=[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)];return(t="number"==typeof t?t:parseFloat(t))>=0&&t<=1?i.push(t):i.push(1),"rgba("+i.join(",")+")"},T=e=>{var t,i,n,r,o;switch(null==e?void 0:e.type){case c.IMAGE:return location.protocol.match(/^http(s)?/)?`assets/iframe/lib/mk-image-viewer/viewer.html?url=${encodeURIComponent(e.readfileuploadurl+""+e.path)}`:""+e.readfileuploadurl+e.path;case c.AUDIO:return location.protocol.match(/^http(s)?/)?`assets/iframe/lib/mk-audio-player-2/player.html?url=${encodeURIComponent(e.readfileuploadurl+""+e.path)}`:""+e.readfileuploadurl+e.path;case c.VIDEO:return location.protocol.match(/^http(s)?/)?`assets/iframe/lib/mk-video-player/player.html?url=${encodeURIComponent(e.readfileuploadurl+""+e.path)}`:""+e.readfileuploadurl+e.path;case c.OFFICE:case c.WORD:case c.EXCEL:case c.POWERPOINT:return location.protocol.match(/^http(s)?/)?`assets/iframe/lib/ONLYOFFICE/player.html?url=${encodeURIComponent(e.readfileuploadurl+""+e.path)}`:""+e.readfileuploadurl+e.path;case c.PDF:return location.protocol.match(/^http(s)?/)?"assets/iframe/lib/PDFReader/web/viewer.html?file="+e.readfileuploadurl+e.path:""+e.readfileuploadurl+e.path;case c.HTML:case c.IMAGE_ANIMATION:case c.PHET:return""+e.readfileuploadurl+e.path;case c.ZIP:case c.SCORM:return"imsmanifest.xml"==(null===(i=null===(t=e.path)||void 0===t?void 0:t.split("/"))||void 0===i?void 0:i.pop())?"assets/iframe/lib/ScormPool_Player/player.html?url="+e.readfileuploadurl+e.path:""+e.readfileuploadurl+e.path;case c.TRACK:case c.TEXT:return""+e.readfileuploadurl+e.path;case c.LINK:switch(e.oss){case h.SCORM:return"assets/iframe/lib/ScormPool_Player/player.html?url="+e.url;case h.YOUTUBE:return null!==(n=C(e.url))&&void 0!==n?n:"";case h.PHET:return null!==(r=e.url)&&void 0!==r?r:"";default:return null!==(o=e.url)&&void 0!==o?o:""}default:return""+e.readfileuploadurl+e.path}},C=e=>{let t=A(e);return t?"https://www.youtube.com/embed/"+t+"?"+jQuery.param({wmode:"opaque",border:0,hd:1,autoplay:!1,autohide:1,enablejsapi:1,modestbranding:1,version:3,hl:"vi_VN",rel:0,showinfo:0,iv_load_policy:3}):null},A=e=>{let t=null==e?void 0:e.match(/(?:.+?)?(?:\/v\/|watch\/|\?v\=|\&v\=|youtu\.be\/|\/v\=|^youtu\.be\/|embed\/)([a-zA-Z0-9_-]{11})+/);return t&&t.length>=2?t[1]:null},B=(e,t)=>(t=null!=t?t:100,Math.round((e+Number.EPSILON)*t)/t),R=e=>B(e/nn.screen.scale),M=(e,t,i)=>{let n=(null==t?void 0:t.size)||{x:0,y:0,width:10,height:10},r=(null==t?void 0:t.attribute)||{fill:nn.attribute.fill,stroke:nn.attribute.stroke,strokeWidth:nn.attribute.strokeWidth};return{nodeId:e,element:Ke(e,a.RECT,"rect",{size:n,attribute:r},i),size:n,attribute:r}},L=(e,t,i)=>{let n=(null==t?void 0:t.size)||{x:0,y:0,width:10,height:10},r=(null==t?void 0:t.attribute)||{preserveAspectRatio:"none"},o=(null==t?void 0:t.source)||{type:"image",image:{url:"../../assets/image-svg/logo.svg",path:"assets/image-svg/logo.svg",name:"logo.svg"}};return{nodeId:e,element:Ke(e,a.IMAGE,"image",{size:n,attribute:r,source:o},i),size:n,attribute:r,source:o}},P=(e,t,i)=>{let n=(null==t?void 0:t.size)||{x:0,y:0,width:10,height:10},r=(null==t?void 0:t.attribute)||{fill:nn.attribute.fill,stroke:nn.attribute.stroke,strokeWidth:nn.attribute.strokeWidth};return{nodeId:e,element:Ke(e,a.CIRCLE,"circle",{size:n,attribute:r},i),size:n,attribute:r}},F=(e,t,i)=>{var n;if(!t.value)return void i();let r=jQuery("#"+e).parents("g");if(!r.length)return void i();let{size:o}=t.node;r.css("transform-origin",`${o.x+o.width/2}px ${o.y+o.height/2}px`);let l="",a=null!==(n=t.iteration)&&void 0!==n?n:0,s=[];(t.value||"").match(/animation((-[a-zA-Z0-9]+)+)?(\s+||\")/gm)?s.push(t.value):t.value?["top-left","top","top-right","left","right","bottom-left","bottom","bottom-right"].includes(t.value)?(s.push("animation"),s.push(`animation-${t.value}`)):(s.push("animate__animated"),s.push(`animate__${t.value}`)):(s.push("animation"),s.push("animation-fadein")),a<0?(s.push("animation-iteration-infinite"),i(),i=function(){}):a>0&&s.push("animation-iteration-"+(a+1)),l=s.join(" "),function(e){let t=function(){r.data("animate-running")?r.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",(function(){r.data("animate-running",!1),setTimeout((function(){e()}),100)})):e()};r.hasClass("animation")?setTimeout((function(){t()})):t()}((function(){var n;K(e),(a>0||a<0)&&r.one("animationiteration",(function(){t.slideStatus===Be.slideStatus||(r.data("animate-running",!1),K(e),t.slideStatus===Be.slideStatus&&i())})),r.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",(function(){var n;switch(r.data("animate-running",!1),K(e),t.finish){default:case 0:case 1:break;case 2:F(e,{node:t.node,value:null===(n=t.node.animate)||void 0===n?void 0:n.out,nodeStatus:t.nodeStatus,slideStatus:t.slideStatus},(()=>{r.addClass("hide")}))}t.slideStatus===Be.slideStatus&&i()})),r.attr("data-class",null!==(n=r.attr("class"))&&void 0!==n?n:""),r.addClass(l),r.data("animate-running",!0)}))},K=function(e){var t,i,n=jQuery("#"+e).parents("g"),r=null===(t=n.attr("class"))||void 0===t?void 0:t.match(/animation((-[a-zA-Z0-9]+)+)?(\s+||\")/gm),o=null===(i=n.attr("class"))||void 0===i?void 0:i.match(/animate((__[a-zA-Z0-9]+)+)?(\s+||\")/gm);r&&r.forEach((function(e){jQuery(n).removeClass(e)})),o&&o.forEach((function(e){jQuery(n).removeClass(e)}));let l=n.attr("data-class");l&&(n.attr("class",l),n.removeAttr("data-class")),jQuery(n).data("animation-running",!1)},G=(e,t,i)=>{var n;if(!t.value)return void i();let r=jQuery("#"+e).parents("g");if(!r.length)return void i();let{size:o}=t.node;r.css("transform-origin",`${o.x+o.width/2}px ${o.y+o.height/2}px`);let l="",a=null!==(n=t.iteration)&&void 0!==n?n:0,s=[];(t.value||"").match(/animation((-[a-zA-Z0-9]+)+)?(\s+||\")/gm)?s.push(t.value):(s.push("animation"),t.value?s.push("animation-"+t.value):s.push("animation-fadein")),a<0?(s.push("animation-iteration-infinite"),i(),i=function(){}):a>0&&s.push("animation-iteration-"+(a+1)),l=s.join(" "),function(e){let t=function(){r.data("animate-running")?r.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",(function(){r.data("animate-running",!1),setTimeout((function(){e()}),100)})):e()};r.hasClass("animation")?setTimeout((function(){t()})):t()}((function(){var n;D(e),(a>0||a<0)&&r.one("animationiteration",(function(){t.slideStatus===Be.slideStatus||(r.data("animate-running",!1),D(e),t.slideStatus===Be.slideStatus&&i())})),r.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",(function(){var n;switch(r.data("animate-running",!1),D(e),t.finish){default:case 0:case 1:break;case 2:F(e,{node:t.node,value:null===(n=t.node.animate)||void 0===n?void 0:n.out,nodeStatus:t.nodeStatus,slideStatus:t.slideStatus},(()=>{r.addClass("hide")}))}t.slideStatus===Be.slideStatus&&i()})),r.attr("data-class",null!==(n=r.attr("class"))&&void 0!==n?n:""),r.addClass(l),r.data("animate-running",!0)}))},D=function(e){var t,i=jQuery("#"+e).parents("g"),n=null===(t=i.attr("class"))||void 0===t?void 0:t.match(/animation((-[a-zA-Z0-9]+)+)?(\s+||\")/gm);n&&n.forEach((function(e){jQuery(i).removeClass(e)}));let r=i.attr("data-class");r&&(i.attr("class",r),i.removeAttr("data-class")),jQuery(i).data("animation-running",!1)},Q=e=>{var t;return null===(t=e.split(/(?=[MLCSQTAHVZmlcsqtahvz])/))||void 0===t?void 0:t.map((e=>{let t={type:e.substring(0,1)},i=(n=e.replace(/\s?\-?[0-9\.]+e-[0-9]+/g," 0").replace(/\,/g," ").replace(/\s?\-/g," -").replace(/(\.[0-9]+)(\.[0-9]+)/g,"$1 0$2").replace(/\-\./g,"-0.").replace(/[^0-9\.\-]/g," ").replace(/\s+/g," ").trim())?n.split(/\s/).map((e=>B(parseFloat(e),1e6))):[];var n;return i.length&&(t.points=i),t}))},U=e=>{let t=[],i=[],n=[],r=[];return e.forEach((e=>{var o,l,a,s,d,u,c,h;switch(["M","L","C","S","Q","T"].includes(e.type)&&e.points&&e.points.forEach(((e,n)=>{n%2==0?t.push(e):i.push(e)})),e.type){case"A":7==(null===(o=e.points)||void 0===o?void 0:o.length)&&(n.push(e.points[5]),r.push(e.points[6]));break;case"H":(null===(l=e.points)||void 0===l?void 0:l.length)&&(t.push(e.points[0]),n.push(e.points[0]));break;case"V":(null===(a=e.points)||void 0===a?void 0:a.length)&&(i.push(e.points[0]),r.push(e.points[0]));break;case"a":if(7==(null===(s=e.points)||void 0===s?void 0:s.length)){let o=t[t.length-1];t.push(o+e.points[5]),n.push(o+e.points[5]);let l=i[i.length-1];i.push(l+e.points[6]),r.push(l+e.points[6])}break;case"h":if(null===(d=e.points)||void 0===d?void 0:d.length){let i=t[t.length-1];t.push(i+e.points[0]),n.push(i+e.points[0])}break;case"v":if(null===(u=e.points)||void 0===u?void 0:u.length){let t=i[i.length-1];i.push(t+e.points[0]),r.push(t+e.points[0])}break;case"M":case"L":case"C":case"S":case"Q":case"T":null===(c=e.points)||void 0===c||c.forEach(((e,t)=>{t%2==0?n.push(e):r.push(e)}));break;case"m":case"l":case"c":case"s":case"q":case"t":null===(h=e.points)||void 0===h||h.forEach(((e,o)=>{if(o%2==0){let i=t[t.length-1];t.push(i+e),n.push(i+e)}else{let t=i[i.length-1];i.push(t+e),r.push(t+e)}}))}})),{minX:Math.min.apply(null,n),minY:Math.min.apply(null,r),maxX:Math.max.apply(null,n),maxY:Math.max.apply(null,r)}},W=(e,t)=>t.map((t=>{var i,n,r,o,l,a,s,d;let u=[];switch(t.type){case"a":7==(null===(i=t.points)||void 0===i?void 0:i.length)&&u.push([B(t.points[0]/e.width,1e6),B(t.points[1]/e.height,1e6),t.points[2],t.points[3],t.points[4],B(t.points[5]/e.width,1e6),B(t.points[6]/e.height,1e6)]);break;case"A":7==(null===(n=t.points)||void 0===n?void 0:n.length)&&u.push([B(t.points[0]/e.width,1e6),B(t.points[1]/e.height,1e6),t.points[2],t.points[3],t.points[4],B((t.points[5]-e.x)/e.width,1e6),B((t.points[6]-e.y)/e.height,1e6)]);break;case"h":(null===(r=t.points)||void 0===r?void 0:r.length)&&u.push([B(t.points[0]/e.width,1e6)]);break;case"H":(null===(o=t.points)||void 0===o?void 0:o.length)&&u.push([B((t.points[0]-e.x)/e.width,1e6)]);break;case"v":(null===(l=t.points)||void 0===l?void 0:l.length)&&u.push([B(t.points[0]/e.height,1e6)]);break;case"V":(null===(a=t.points)||void 0===a?void 0:a.length)&&u.push([B((t.points[0]-e.y)/e.height,1e6)]);break;case"z":case"Z":break;case"M":case"L":case"C":case"S":case"Q":case"T":if(null===(s=t.points)||void 0===s?void 0:s.length)for(let i=0,n=t.points.length-1;i<n;i+=2)u.push([B((t.points[i]-e.x)/e.width,1e6),B((t.points[i+1]-e.y)/e.height,1e6)]);break;case"m":case"l":case"c":case"s":case"q":case"t":if(null===(d=t.points)||void 0===d?void 0:d.length)for(let i=0,n=t.points.length-1;i<n;i+=2)u.push([B(t.points[i]/e.width,1e6),B(t.points[i+1]/e.height,1e6)])}return u.length?{type:t.type,ratios:u}:{type:t.type}})),V=(e,t)=>t.map((t=>{var i,n,r,o,l,a,s,d,u,c,h,v,g,p,y,f,m,b,w,S,x,k,O,_,N,E,I,z;switch(t.type){case"a":return`${t.type}${null!==(o=null===(r=null===(n=null===(i=t.ratios)||void 0===i?void 0:i.map((t=>{var i,n,r,o,l,a,s;return[B(e.width*(null!==(i=t[0])&&void 0!==i?i:0),1e6),B(e.height*(null!==(n=t[1])&&void 0!==n?n:0),1e6),null!==(r=t[2])&&void 0!==r?r:0,null!==(o=t[3])&&void 0!==o?o:0,null!==(l=t[4])&&void 0!==l?l:0,B(e.width*(null!==(a=t[5])&&void 0!==a?a:0),1e6),B(e.height*(null!==(s=t[6])&&void 0!==s?s:0),1e6)]})))||void 0===n?void 0:n.map((e=>e.join(" "))))||void 0===r?void 0:r.join(" "))&&void 0!==o?o:""}`;case"A":return`${t.type}${null!==(d=null===(s=null===(a=null===(l=t.ratios)||void 0===l?void 0:l.map((t=>{var i,n,r,o,l,a,s;return[B(e.width*(null!==(i=t[0])&&void 0!==i?i:0),1e6),B(e.height*(null!==(n=t[1])&&void 0!==n?n:0),1e6),null!==(r=t[2])&&void 0!==r?r:0,null!==(o=t[3])&&void 0!==o?o:0,null!==(l=t[4])&&void 0!==l?l:0,B(e.x+e.width*(null!==(a=t[5])&&void 0!==a?a:0),1e6),B(e.y+e.height*(null!==(s=t[6])&&void 0!==s?s:0),1e6)]})))||void 0===a?void 0:a.map((e=>e.join(" "))))||void 0===s?void 0:s.join(" "))&&void 0!==d?d:""}`;case"h":return`${t.type}${null!==(h=null===(c=null===(u=t.ratios)||void 0===u?void 0:u.map((t=>{var i;return B(e.width*(null!==(i=t[0])&&void 0!==i?i:0),1e6)})))||void 0===c?void 0:c.join(" "))&&void 0!==h?h:""}`;case"H":return`${t.type}${null!==(p=null===(g=null===(v=t.ratios)||void 0===v?void 0:v.map((t=>{var i;return B(e.x+e.width*(null!==(i=t[0])&&void 0!==i?i:0),1e6)})))||void 0===g?void 0:g.join(" "))&&void 0!==p?p:""}`;case"v":return`${t.type}${null!==(m=null===(f=null===(y=t.ratios)||void 0===y?void 0:y.map((t=>{var i;return B(e.height*(null!==(i=t[0])&&void 0!==i?i:0),1e6)})))||void 0===f?void 0:f.join(" "))&&void 0!==m?m:""}`;case"V":return`${t.type}${null!==(S=null===(w=null===(b=t.ratios)||void 0===b?void 0:b.map((t=>{var i;return B(e.y+e.height*(null!==(i=t[0])&&void 0!==i?i:0),1e6)})))||void 0===w?void 0:w.join(" "))&&void 0!==S?S:""}`;case"z":case"Z":return t.type;case"M":case"L":case"C":case"S":case"Q":case"T":return`${t.type}${null!==(_=null===(O=null===(k=null===(x=t.ratios)||void 0===x?void 0:x.map((t=>{var i,n;return[B(e.x+e.width*(null!==(i=t[0])&&void 0!==i?i:0),1e6),B(e.y+e.height*(null!==(n=t[1])&&void 0!==n?n:0),1e6)]})))||void 0===k?void 0:k.map((e=>e.join(" "))))||void 0===O?void 0:O.join(" "))&&void 0!==_?_:""}`;case"m":case"l":case"c":case"s":case"q":case"t":return`${t.type}${null!==(z=null===(I=null===(E=null===(N=t.ratios)||void 0===N?void 0:N.map((t=>{var i,n;return[B(e.width*(null!==(i=t[0])&&void 0!==i?i:0),1e6),B(e.height*(null!==(n=t[1])&&void 0!==n?n:0),1e6)]})))||void 0===E?void 0:E.map((e=>e.join(" "))))||void 0===I?void 0:I.join(" "))&&void 0!==z?z:""}`;default:return""}})).join(""),H=(e,t)=>{let i=[];for(let n=0,r=t.length-1;n<r;n+=2)i.push([(t[n]-e.x)/e.width,(t[n+1]-e.y)/e.height]);return i},X=(e,t)=>t.map((t=>[B(e.x+e.width*t[0],1e6),B(e.y+e.height*t[1],1e6)])).map((e=>e.join(" "))).join(" "),q=(e,t)=>{let i=Y(t);if(i){let t=window.Snap.matrix(i.a,i.b,i.c,i.d,i.e,i.f);if(t){let{dx:i,dy:n,rotate:r,scalex:o,scaley:l}=t.split();return{x:e.x+i,y:e.y+n,dx:i,dy:n,rotate:r,scalex:o,scaley:l}}return{x:Z(e.x,e.y,i),y:ee(e.x,e.y,i)}}return e},Y=e=>{let t=e.replace(/\s?\-?[0-9\.]+e-[0-9]+/g," 0").replace(/\,/g," ").replace(/\s?\-/g," -").replace(/(\.[0-9]+)(\.[0-9]+)/g,"$1 0$2").replace(/\-\./g,"-0.").replace(/[^0-9\.\-]/g," ").replace(/\s+/g," ").trim().split(" ").map((e=>B(parseFloat(e),1e6)));if(6==t.length)return{a:t[0],b:t[1],c:t[2],d:t[3],e:t[4],f:t[5]}},Z=function(e,t,i){return B(e*i.a+t*i.c+i.e,10)},ee=function(e,t,i){return B(e*i.b+t*i.d+i.f,10)},te=(e,t,i,n,r)=>{let o={x:Math.min(e,i),y:Math.min(t,n),width:Math.abs(i-e)||1,height:Math.abs(n-t)||1};return(null==r?void 0:r.ratio)&&(o.width<=o.height?o.height=o.width*(null==r?void 0:r.ratio):o.width=o.height/(null==r?void 0:r.ratio)),Object.assign(o,{ratios:(null==r?void 0:r.ratios)||[[(e-o.x)/(o.width||1),(t-o.y)/(o.height||1)],[(i-o.x)/(o.width||1),(n-o.y)/(o.height||1)]]}),(null==r?void 0:r.points)&&(o.points=null==r?void 0:r.points),o},ie=(e,t,i)=>{var n,r=(()=>{var n,r,o,l,s,d;switch(e){case a.CIRCLE:return{cx:t.x+t.width/2,cy:t.y+t.height/2,r:Math.min(t.width/2,t.height/2)};case a.ELLIPSE:return{cx:t.x+t.width/2,cy:t.y+t.height/2,rx:t.width/2,ry:t.height/2};case a.LINE:{let e={};return null===(n=t.ratios)||void 0===n||n.forEach(((i,n)=>{e[`x${n+1}`]=t.x+t.width*i[0],e[`y${n+1}`]=t.y+t.height*i[1]})),e}case a.RECT:case a.FOREIGNOBJECT:case a.IMAGE:return{x:t.x,y:t.y,width:t.width,height:t.height};case a.TEXT:case a.TSPAN:return{x:t.x,y:t.y+(i.alignmentBaseline||i.dominantBaseline?0:null!==(r=i.fontSize)&&void 0!==r?r:16)};case a.POLYGON:case a.POLYLINE:if(null===(o=t.ratios)||void 0===o?void 0:o.length)return{points:X(t,t.ratios)};break;case a.PATH:if(null===(l=t.ratioMaps)||void 0===l?void 0:l.length)return{d:V(t,t.ratioMaps)};if(null===(s=t.points)||void 0===s?void 0:s.length)return{d:`M ${(d=t.points)[0][0]} ${d[0][1]} L ${(d.map((e=>[e[0],e[1]]))||[]).map((e=>e.join(" "))).join(" ")}`}}return{}})();return t.rotate?(r.transform=`rotate(${t.rotate})`,r.transformOrigin=`${t.x+t.width/2} ${t.y+t.height/2}`):(null===(n=i.transform)||void 0===n?void 0:n.match(/^rotate/))&&(i.transform=null,i.transformOrigin=null),r},ne=(e,t,i)=>{var n;if(!t.points||!t.points.length)return void i();let r=jQuery("#"+e),o=(e=>{if(1==e.length){let{size:i}=t.node;return[[i.x+i.width/2,i.y+i.height/2],...e]}return[...e]})(t.points||[]),l=function(e){let t=[];2===e.length&&e.splice(1,0,[(e[0][0]+e[1][0])/2,(e[0][1]+e[1][1])/2]);let i,n,r,o=1,l=e.length;for(;o<l;){if(i=e[o-1],n=e[o],r=e[o+1],(Math.abs(i[0]-n[0])>=15||Math.abs(i[1]-n[1])>=15)&&Math.pow(i[0]-n[0],2)+Math.pow(i[1]-n[1],2)>=Math.pow(15,2)&&r&&(Math.abs(i[0]-r[0])<=20||Math.abs(i[1]-r[1])<=20)&&Math.pow(i[0]-r[0],2)+Math.pow(i[1]-r[1],2)<=Math.pow(20,2))t.push(n);else{let e=n[0]-i[0],r=n[1]-i[1],o=Math.max(Math.abs(e),Math.abs(r));for(var a=0;a<o;a+=15)t.push([i[0]+e*a/o,i[1]+r*a/o])}o++}return l>0&&(t.splice(0,0,e[0]),t.push(e[l-1])),t}(o),a=null!==(n=t.iteration)&&void 0!==n?n:0;if(a<0&&(i(),i=function(){}),r.data("work-running")&&a<0)return;r.data("work-running",!0);let s,d=l.length,u=Math.max(20,1e3*(t.time||3)/d),{id:c,type:h,size:v,attribute:g}=Be.findNode(e),p=function(e){var n;if(t.slideStatus!==Be.slideStatus)return r.data("work-running",!1),void(t.slideStatus===Be.slideStatus&&i());if(e<d){let t=l[e];t&&(s=Object.assign({},v,{x:t[0]-v.width/2,y:t[1]-v.height/2}),Object.assign(g,ie(h,s,g)),Ge(window.document.getElementById(c),g),setTimeout((function(){p(++e)}),u))}else if(a>0)a--,p(1);else if(a<0)p(1);else switch(r.data("work-running",!1),t.slideStatus===Be.slideStatus&&i(),t.finish){default:case 0:break;case 1:Object.assign(g,ie(h,v,g)),Ge(window.document.getElementById(c),g);break;case 2:F(t.node.id,{node:t.node,value:null===(n=t.node.animate)||void 0===n?void 0:n.out,nodeStatus:t.nodeStatus,slideStatus:t.slideStatus},(()=>{r.addClass("hide")}))}};p(1)},re=(e,t,i,n,r)=>{var o,l,a,s,d,u,c;if(n.slideStatus!=Be.slideStatus)return t.async&&"change-slide"!=t.async?void 0:void r();if(n.nodeStatus!=Be.nodeStatus&&(!t.async||"change-node"==t.async))return void r();if(!(null===(o=t.source)||void 0===o?void 0:o.path)&&!(null===(l=t.source)||void 0===l?void 0:l.url))return console.warn(`${e} -> audio no source!`),r(),void(r=()=>{});var h=jQuery("#"+e);let v=null!==(a=t.iteration)&&void 0!==a?a:0;if(v<0&&(r(),r=function(){}),!(h.data("audio-running")&&v<0)){h.data("audio-running",!0);var g=function(e){e.pause(),e.remove(),h.data("audio-running",!1)},p=new Audio;return p.autoplay=!0,p.loop=0!=v,p.preload="auto",p.controls=!0,p.setAttributeNode(document.createAttribute("playsinline")),p.addEventListener("canplay",(function(){var e=p.play();e&&e.then((function(e){var i;h.data("audio-running",!0),"time"==t.async?setTimeout((()=>{n.slideStatus===Be.slideStatus&&(g(p),r(),r=()=>{})}),1e3*(null!==(i=t.time)&&void 0!==i?i:1)):"non-stop"==t.async&&(r(),r=()=>{})})).catch((function(e){h.data("audio-running",!1),n.slideStatus===Be.slideStatus&&(r(),r=()=>{})}))})),p.addEventListener("timeupdate",(function(){switch(t.async){case"time":case"change-slide":n.slideStatus!==Be.slideStatus&&(g(this),r(),r=()=>{});break;case"finish-action":i.total>=2&&i.total-i.counter==1&&(g(this),r(),r=()=>{});break;default:case"change-node":n.nodeStatus!==Be.nodeStatus&&(g(this),r(),r=()=>{});case"non-stop":}})),p.addEventListener("canplaythrough",(function(){this.loop&&(v>0?v--:0==v&&(this.loop=!1))})),p.addEventListener("play",(function(){})),p.addEventListener("pause",(function(){})),p.addEventListener("ended",(function(){this.remove(),h.data("audio-running",!1),n.slideStatus===Be.slideStatus&&(r(),r=()=>{})})),p.onerror=function(){this.remove(),h.data("audio-running",!1),n.slideStatus===Be.slideStatus&&(r(),r=()=>{})},p.src=((null===(s=t.source)||void 0===s?void 0:s.path)?(null===(d=nn.config)||void 0===d?void 0:d.readfileuploadurl)+(null===(u=t.source)||void 0===u?void 0:u.path):null===(c=t.source)||void 0===c?void 0:c.url)||"",p}},oe=e=>{e.id?jQuery("#"+e.id).removeClass("hide"):e.ids&&e.ids.forEach((e=>{jQuery("#"+e).removeClass("hide")}))},le=e=>{e.id?(jQuery("#"+e.id).removeClass("hide"),se(Be.findNode(e.id),e.nodeStatus,e.slideStatus)):e.ids&&e.ids.forEach((t=>{jQuery("#"+t).removeClass("hide"),se(Be.findNode(t),e.nodeStatus,e.slideStatus)}))},ae=e=>{var t;if(e.id){let i=Be.findNode(e.id);F(e.id,{node:i,value:null===(t=i.animate)||void 0===t?void 0:t.out,nodeStatus:e.nodeStatus,slideStatus:e.slideStatus},(()=>{jQuery("#"+e.id).addClass("hide")}))}else e.ids&&e.ids.forEach((t=>{var i;let n=Be.findNode(t);F(t,{node:n,value:null===(i=n.animate)||void 0===i?void 0:i.out,nodeStatus:e.nodeStatus,slideStatus:e.slideStatus},(()=>{jQuery("#"+t).addClass("hide")}))}))},se=(e,t,i,n)=>{var r,o,l,a,s,d;let u={total:0,counter:0},{triggershow:c,triggerrun:h,triggerhide:v,action:g,audio:p,slide:y,media:f}=null!==(o=null===(r=e.interactive)||void 0===r?void 0:r.click)&&void 0!==o?o:{};if(console.log(`node(${e.id}) | nodeStatus(${t}) | slideStatus(${i}) | click`),c){let{id:e,ids:n,time:r,async:o}=c;"asynctrue"==o?oe({id:e,ids:n,nodeStatus:t,slideStatus:i}):"time"==o&&setTimeout((()=>{oe({id:e,ids:n,nodeStatus:t,slideStatus:i})}),1e3*(null!=r?r:0))}if(h){let{id:e,ids:n,time:r,async:o}=h;"asynctrue"==o?le({id:e,ids:n,nodeStatus:t,slideStatus:i}):"time"==o&&setTimeout((()=>{le({id:e,ids:n,nodeStatus:t,slideStatus:i})}),1e3*(null!=r?r:0))}if(v){let{id:e,ids:n,time:r,async:o}=v;"asynctrue"==o?ae({id:e,ids:n,nodeStatus:t,slideStatus:i}):"time"==o&&setTimeout((()=>{ae({id:e,ids:n,nodeStatus:t,slideStatus:i})}),1e3*(null!=r?r:0))}let m=()=>{setTimeout((()=>{if(u.counter>=u.total){if(n&&n(),c){let{id:e,ids:n,async:r}=c;r&&"asyncfalse"!=r||oe({id:e,ids:n,nodeStatus:t,slideStatus:i})}if(h){let{id:e,ids:n,async:r}=h;r&&"asyncfalse"!=r||le({id:e,ids:n,nodeStatus:t,slideStatus:i})}if(v){let{id:e,ids:n,async:r}=v;r&&"asyncfalse"!=r||ae({id:e,ids:n,nodeStatus:t,slideStatus:i})}}}))};if(null==g?void 0:g.value){u.total+=1;let n=()=>{u.counter+=1,m()};switch(null==g?void 0:g.value){case"hide":F(e.id,{node:e,value:null===(l=e.animate)||void 0===l?void 0:l.out,nodeStatus:t,slideStatus:i},(()=>{jQuery("#"+e.id).addClass("hide"),n()}));break;case"points":{let{points:r,time:o,iteration:l,finish:a}=g;r&&ne(e.id,{node:e,points:r,time:o,iteration:l,finish:a,nodeStatus:t,slideStatus:i},n);break}default:{let{value:r,time:o,iteration:l,finish:a}=g;G(e.id,{node:e,value:r,time:o,iteration:l,finish:a,nodeStatus:t,slideStatus:i},n);break}}}if(null===(a=null==p?void 0:p.source)||void 0===a?void 0:a.path){u.total+=1;let n=()=>{u.counter+=1,m()};re(e.id,p,u,{nodeStatus:t,slideStatus:i},n)}if(u.total||m(),null==y?void 0:y.id)switch(y.id){case-1:Be.runSlide(Be.slideIdx-1);break;case-2:Be.runSlide(Be.slideIdx+1);break;default:Be.runSlide(void 0,y.id,null===(s=y.code)||void 0===s?void 0:s.toString())}if(null==f?void 0:f.type){let e=T({readfileuploadurl:null===(d=nn.config)||void 0===d?void 0:d.readfileuploadurl,type:null==f?void 0:f.type,oss:null==f?void 0:f.oss,path:null==f?void 0:f.path,url:null==f?void 0:f.url}),t=jQuery(`<div class="popup-media-viewer"><iframe src="${e}" frameborder="0" allowfullscreen\n        webkitallowfullscreen allowtransparency="true" allow="autoplay; fullscreen"></iframe><div class="btn-close"><img src="assets/icon-svg/close-outline.svg"/></div></div>`).appendTo(window.document.body);t.find(".btn-close").click((function(e){e.preventDefault(),t.remove()}))}},de=(e,t,i)=>{let n=(null==t?void 0:t.size)||{x:0,y:0,width:320,height:80},r=(null==t?void 0:t.attribute)||{fill:nn.attribute.stroke,fontFamily:nn.attribute.fontFamily,fontSize:nn.attribute.fontSize,textLength:nn.attribute.textLength},o=(null==t?void 0:t.source)||{type:"text",text:{textContent:""}};return{nodeId:e,element:Ke(e,a.TEXT,"text",{size:n,attribute:r,source:o},i),size:n,attribute:r,source:o}},ue=(e,t,i)=>{let n=(null==t?void 0:t.size)||{x:0,y:0,width:10,height:10},r=(null==t?void 0:t.attribute)||{};return{nodeId:e,element:Ke(e,a.GROUP,"g",{size:n,attribute:r},i),size:n,attribute:r}},ce=(e,t,i)=>{var n,r,o,l;let a=1,s=new Image;s.onload=()=>{var e,n,r,o,l,d,u,c,h,v,g,p;a=B(s.naturalWidth/s.naturalHeight,100);let y=0,f=0,m=0,b=0;a>=1?(m=Math.min(s.naturalWidth,null!==(r=null===(n=null===(e=Be.slide.svg)||void 0===e?void 0:e.viewBox)||void 0===n?void 0:n.width)&&void 0!==r?r:0),b=m/a):(b=Math.min(s.naturalHeight,null!==(d=null===(l=null===(o=Be.slide.svg)||void 0===o?void 0:o.viewBox)||void 0===l?void 0:l.height)&&void 0!==d?d:0),m=b/a),y=((null!==(h=null===(c=null===(u=Be.slide.svg)||void 0===u?void 0:u.viewBox)||void 0===c?void 0:c.width)&&void 0!==h?h:0)-m)/2,f=((null!==(p=null===(g=null===(v=Be.slide.svg)||void 0===v?void 0:v.viewBox)||void 0===g?void 0:g.height)&&void 0!==p?p:0)-b)/2,t.size={x:y,y:f,width:m,height:b},he(t,i)},s.onerror=e=>{console.error(`ImgSrc load failed -> ${JSON.stringify(t.source)}`,e)},s.src=((null===(n=t.source)||void 0===n?void 0:n.path)?(null===(r=nn.config)||void 0===r?void 0:r.readfileuploadurl)+(null===(o=t.source)||void 0===o?void 0:o.path):null===(l=t.source)||void 0===l?void 0:l.url)||""},he=(e,t)=>{if(e.slideStatus!=Be.slideStatus)return void t();let{element:i}=L(Math.ceil(1e9*Math.random()),{size:e.size,source:{type:"image",image:null==e?void 0:e.source}});setTimeout((()=>{null==i||i.remove(),t()}),3e3)},ve=(e,t,i)=>{var n,r,o,l;let a=new Image;a.onload=()=>{ge(e,{width:a.naturalWidth,height:a.naturalHeight},t,i)},a.onerror=e=>{console.error(`ImgSrc load failed -> ${JSON.stringify(t.source)}`,e),i()},a.src=((null===(n=t.source)||void 0===n?void 0:n.path)?(null===(r=nn.config)||void 0===r?void 0:r.readfileuploadurl)+(null===(o=t.source)||void 0===o?void 0:o.path):null===(l=t.source)||void 0===l?void 0:l.url)||""},ge=(e,t,i,n)=>{if(i.slideStatus!=Be.slideStatus)return void n();let o=B(t.width/t.height,100),l=0,a=0,s=0,d=0;o>=1?(s=t.width,s=Math.max(s,40),s=Math.min(s,40),d=s/o):(d=t.height,d=Math.max(d,40),d=Math.min(d,40),s=d/o);let{size:u}=e;l=u.x+u.width-s/2,a=u.y-d/2;let c=We(r.TEST_GROUP,"g",void 0,nn.target);L(`icon-${e.id}`,{size:{x:l,y:a,width:s,height:d},source:{type:"image",image:null==i?void 0:i.source}},c),setTimeout((()=>{n()}),3e3)},pe=(e,t,i)=>{var n,r,o,l,a,s,d;if(t.slideStatus!=Be.slideStatus)return void i();if(!(null===(n=t.source)||void 0===n?void 0:n.path)&&!(null===(r=t.source)||void 0===r?void 0:r.url))return console.warn(`${e.id} -> audio no source!`),void i();var u=jQuery("#"+e.id);let c=null!==(o=t.iteration)&&void 0!==o?o:0;if(c<0&&(i(),i=function(){}),!(u.data("audio-running")&&c<0)){u.data("audio-running",!0);var h=new Audio;return h.autoplay=!0,h.loop=0!=c,h.preload="auto",h.controls=!0,h.setAttributeNode(document.createAttribute("playsinline")),h.addEventListener("canplay",(function(){var e=h.play();e&&e.then((function(e){u.data("audio-running",!0)})).catch((function(e){u.data("audio-running",!1),t.slideStatus===Be.slideStatus&&i()}))})),h.addEventListener("timeupdate",(function(){t.slideStatus!==Be.slideStatus&&function(e){e.pause(),e.remove(),u.data("audio-running",!1)}(this)})),h.addEventListener("canplaythrough",(function(){this.loop&&(c>0?c--:0==c&&(this.loop=!1))})),h.addEventListener("play",(function(){})),h.addEventListener("pause",(function(){})),h.addEventListener("ended",(function(){this.remove(),u.data("audio-running",!1),t.slideStatus===Be.slideStatus&&i()})),h.onerror=function(){this.remove(),u.data("audio-running",!1),t.slideStatus===Be.slideStatus&&i()},h.src=((null===(l=t.source)||void 0===l?void 0:l.path)?(null===(a=nn.config)||void 0===a?void 0:a.readfileuploadurl)+(null===(s=t.source)||void 0===s?void 0:s.path):null===(d=t.source)||void 0===d?void 0:d.url)||"",h}};var ye=/^#[a-fA-F0-9]+$/i,fe=/^rgb\((\d+),(\d+),(\d+)\)$/i,me=/^rgba\((\d+),(\d+),(\d+),([0-9\.]+)\)$/i;const be=e=>{let t=null,i=null;if(e)if("transparent"==e)t="#000000",i=0;else if(e.match(ye))t=e;else{let n=(e=e.replace(/\s+/g,"")).match(me);if(n)t="#"+(256|n[1]).toString(16).slice(1)+(256|n[2]).toString(16).slice(1)+(256|n[3]).toString(16).slice(1),i=B(parseFloat(n[4]),100);else{let i=e.match(fe);i&&(t="#"+(256|i[1]).toString(16).slice(1)+(256|i[2]).toString(16).slice(1)+(256|i[3]).toString(16).slice(1))}}return{hex:t,alpha:i}},we=e=>Se(null==e?void 0:e.url,null==e?void 0:e.path,null==e?void 0:e.src,null==e?void 0:e.name);var Se=(e,t,i,n)=>{var r,o;let l,a,s,d;return e&&(l=e.replace(/\\/g,"/")),t&&(a=t.replace(/\\/g,"/")),i&&(s=i.replace(/\\/g,"/")),a&&!l&&(l=(null===(r=nn.config)||void 0===r?void 0:r.readfileuploadurl)+a),!s||a||l||(a=s.replace(/^[a-zA-Z0-9\-\_\/\\\:\.]+(upload|FileUpload|files|readfileupload|filereader|readfile)\//g,""),l=(null===(o=nn.config)||void 0===o?void 0:o.readfileuploadurl)+a),d=n||(null!=l?l:"").split("/").pop()||(null!=a?a:"").split("/").pop()||"",{url:l,path:a,name:d}};const xe=e=>{let t={x:0,y:0,width:e.screen.w,height:e.screen.h},i=[];return e.data.forEach(((e,n)=>{var r,o;let l={id:"number"==typeof e.id?e.id:nn.data.newSlideId,code:null===(r=e.id)||void 0===r?void 0:r.toString(),name:"string"==typeof e.id?e.id:`Trang ${n+1}`,svg:{viewBox:t,nodes:[]},test:(s=e.test2,s?(s.audiotrue&&(s.audiotrue=we({path:s.audiotrue.path})),s.audiofalse&&(s.audiofalse=we({path:s.audiofalse.path})),s.effecttrue&&(s.effecttrue=we({path:s.effecttrue.path})),s.effectfalse&&(s.effectfalse=we({path:s.effectfalse.path})),s.icontrue&&(s.icontrue=we({path:s.icontrue.path})),s.iconfalse&&(s.iconfalse=we({path:s.iconfalse.path})),s):{})};var s,d;e.background&&l.svg&&(!(d=e.background)||null===d.match(/#([a-zA-Z0-9]+)/)&&null===d.match(/rgb\([0-9]+,[0-9]+,[0-9]+\)/)&&null===d.match(/rgba\([0-9]+,[0-9]+,[0-9]+,[0-9\.]+\)/)?function(e){return e&&null!==e.match(/data:[^;]+;base64,/)}(e.background)?l.svg.background={base64:e.background}:function(e){return e&&null!==e.match(/http(s)?:\/\//)}(e.background)?l.svg.background=Se(e.background):l.svg.background=Se(void 0,e.background):l.svg.background={color:e.background}),jQuery(null!==(o=e.svg)&&void 0!==o?o:"").find(".indexs").find("polygon,path,circle,ellipse,line,rect,foreignObject").each(((t,i)=>{var n,r;let o=jQuery(i).parents(".indexs"),s=(u=o.attr("data-index"))?parseInt(u):0,d=(e=>s&&e?parseInt(e):0)(o.attr("data-time"));var u;let h=null!==(n=i.getAttribute("id"))&&void 0!==n?n:(1e9*Math.random()).toFixed(),v={id:parseInt(h),code:`${i.nodeName}-${h}`,name:i.nodeName,idx:s,time:d,type:(()=>{switch(i.nodeName){case"polygon":return a.POLYGON;case"path":return a.PATH;case"circle":return a.CIRCLE;case"ellipse":return a.ELLIPSE;case"line":return a.LINE;case"rect":return a.RECT;case"foreignObject":return a.FOREIGNOBJECT}return 0})(),size:(()=>{var e,t,n;let r={},o=0,l=0,a=0,s=0,d=null,u=null,c=parseFloat((null===(e=i.getAttribute("transform"))||void 0===e?void 0:e.replace("rotate(","").replace(")",""))||"0")||null;switch(i.nodeName){case"polygon":{let e=[],r=[],c=999999999,h=999999999,v=0,g=0;d=JSON.parse(i.getAttribute("ratios")||"[]"),u=null!==(n=null===(t=i.getAttribute("points"))||void 0===t?void 0:t.split(",").map((function(e){return e.split(" ").map((function(e){return parseFloat(e)}))})))&&void 0!==n?n:[],u.forEach((function(t){e.push(t[0]),r.push(t[1])})),c=Math.min.apply(null,e),h=Math.min.apply(null,r),v=Math.max.apply(null,e),g=Math.max.apply(null,r),o=c,l=h,a=v-o,s=g-l;break}case"path":{let e=i.getAttribute("d");if(e){let t=Q(e),{minX:i,minY:n,maxX:d,maxY:u}=U(t);o=i,l=n,a=d-o||1,s=u-l||1,Object.assign(r,{ratioMaps:W({x:o,y:l,width:a,height:s},t)})}break}case"circle":{let e=parseFloat(i.getAttribute("cx")||"0"),t=parseFloat(i.getAttribute("cy")||"0"),n=parseFloat(i.getAttribute("r")||"0");o=e-n,l=t-n,a=2*n,s=2*n;break}case"ellipse":{let e=parseFloat(i.getAttribute("cx")||"0"),t=parseFloat(i.getAttribute("cy")||"0"),n=parseFloat(i.getAttribute("rx")||"0"),r=parseFloat(i.getAttribute("ry")||"0");o=e-n,l=t-r,a=2*n,s=2*r;break}case"line":{let e=parseFloat(i.getAttribute("x1")||"0"),t=parseFloat(i.getAttribute("y1")||"0"),n=parseFloat(i.getAttribute("x2")||"0"),r=parseFloat(i.getAttribute("y2")||"0"),u=999999999,c=999999999,h=0,v=0;u=Math.min(e,n),c=Math.min(t,r),h=Math.max(e,n),v=Math.max(t,r),o=u,l=c,a=h-o,s=v-l,d=[[(e-o)/(a||1),(t-l)/(s||1)],[(n-o)/(a||1),(r-l)/(s||1)]];break}case"rect":case"foreignObject":o=parseFloat(i.getAttribute("x")||"0"),l=parseFloat(i.getAttribute("y")||"0"),a=parseFloat(i.getAttribute("width")||"0"),s=parseFloat(i.getAttribute("height")||"0")}return Object.assign(r,{x:o,y:l,width:a,height:s,ratios:d,points:u,rotate:c})})(),attribute:(()=>{var e,t,n,r,l,a,s,d,u,c,h,v,g,p,y,f;let m={};switch(i.nodeName){case"polygon":case"circle":case"ellipse":case"line":case"rect":{let o=null!==(e=i.getAttribute("fill"))&&void 0!==e?e:null,u=null!==(t=i.getAttribute("stroke"))&&void 0!==t?t:null,c=null!==(r=parseFloat(null!==(n=i.getAttribute("stroke-opacity"))&&void 0!==n?n:"1"))&&void 0!==r?r:null,h=null!==(l=parseFloat(i.getAttribute("stroke-width")||"0"))&&void 0!==l?l:null,v=null!==(a=i.getAttribute("stroke-linecap"))&&void 0!==a?a:null,g=null!==(s=i.getAttribute("stroke-linejoin"))&&void 0!==s?s:null,p=null!==(d=parseFloat(i.getAttribute("stroke-dasharray")||"0"))&&void 0!==d?d:null;Object.assign(m,{fill:o,stroke:u,strokeOpacity:c,strokeWidth:h,strokeLinecap:v,strokeLinejoin:g,strokeDasharray:p});break}case"path":{let e=o.get(0);if(e){let t=null!==(u=e.getAttribute("fill"))&&void 0!==u?u:null,i=null!==(c=e.getAttribute("stroke"))&&void 0!==c?c:null,n=null!==(v=parseFloat(null!==(h=e.getAttribute("stroke-opacity"))&&void 0!==h?h:"1"))&&void 0!==v?v:null,r=null!==(g=parseFloat(e.getAttribute("stroke-width")||"0"))&&void 0!==g?g:null,o=null!==(p=e.getAttribute("stroke-linecap"))&&void 0!==p?p:null,l=null!==(y=e.getAttribute("stroke-linejoin"))&&void 0!==y?y:null,a=null!==(f=parseFloat(e.getAttribute("stroke-dasharray")||"0"))&&void 0!==f?f:null;Object.assign(m,{fill:t,stroke:i,strokeOpacity:n,strokeWidth:r,strokeLinecap:o,strokeLinejoin:l,strokeDasharray:a})}break}}return m})(),style:(()=>{var e,t;let n={};switch(i.nodeName){case"polygon":case"path":case"circle":case"ellipse":case"line":case"rect":break;case"foreignObject":{let r=jQuery(i).find(".svg-container");if(r.length){let e=parseFloat(r.css("border-width")||"0")||null,t=r.css("border-style")||null,i=r.css("border-color")||null,o=null,l=r.css("background-color")||null,a=null;(()=>{let{hex:e,alpha:t}=be(i);i=e,o=t})(),(()=>{let{hex:e,alpha:t}=be(l);l=e,a=t})(),Object.assign(n,{borderWidth:e,borderStyle:t,borderColor:i,borderOpacity:o,backgroundColor:l,backgroundOpacity:a})}let o=jQuery(i).find(".svg-editor-content");if(o.length){let i=JSON.parse((o.attr("data-style")||"{}").replace(/\&quot\;/gm,'"')),{hex:r,alpha:l}=be(i.TextColor);Object.assign(n,{fontFamily:null!==(e=i.FontFamily)&&void 0!==e?e:null,fontSize:null!==(t=i.FontSize)&&void 0!==t?t:null,color:r,opacity:l})}break}}return n})(),source:(()=>{var t,n,r,l,a,s,d,u,c,v,g,p,y,f,m,b,w;let S={};switch(i.nodeName){case"polygon":case"path":case"circle":case"ellipse":case"line":case"rect":break;case"foreignObject":if(o.hasClass("editors")){let e="div,h1,h2,h3,h4,h5,h6,p,span,strong,b,i",r=t=>{null==t||t.forEach((t=>{let i=t.querySelectorAll(`:scope > ${e}`);i.length&&r(i),t.querySelectorAll(":scope > *").length||""!=t.textContent||t.remove()}))},o=e=>{var t;let i=null==e?void 0:e.querySelectorAll(":scope > div,h1,h2,h3,h4,h5,h6,p,strong,span");if(null==i?void 0:i.length){let n=i[i.length-1];if(""==(null===(t=n.textContent)||void 0===t?void 0:t.trim())){let t=n.querySelectorAll(":scope > *");if(t.length){let i=t[t.length-1];["br","BR"].includes(null==i?void 0:i.nodeName)&&(i.remove(),o(e))}else n.remove(),o(e)}}};r(null===(t=jQuery(i).find(".svg-editor-content").get(0))||void 0===t?void 0:t.querySelectorAll(`:scope > ${e}`)),o(jQuery(i).find(".svg-editor-content").get(0));let l=jQuery(i).find(".svg-editor-content");if(l.length){let e=l.html(),t=null!==(n=(null!=e?e:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==n?n:[];Object.assign(S,{type:"html",html:{htmlContent:e,variableKeywords:t}})}}else if(o.hasClass("inputs")||o.hasClass("textareas"))Object.assign(S,{type:"input",input:{input:!!jQuery(i).find("input").length,textarea:!!jQuery(i).find("textarea").length}});else if(o.hasClass("tests")){let t=jQuery(i).find(".svg-test");if(o.hasClass("tests-truefalse")){let i=t.find(".svg-editor-content").html(),n=null!==(r=(null!=i?i:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==r?r:[];Object.assign(S,{type:"test",test:{type:"truefalse",truefalse:{iscorrect:null===(l=e.test2.truefalse)||void 0===l?void 0:l.includes(h)}},html:{htmlContent:i,variableKeywords:n}})}else if(o.hasClass("tests-singlechoice")){let i=t.find(".svg-editor-content").html(),n=null!==(a=(null!=i?i:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==a?a:[];Object.assign(S,{type:"test",test:{type:"singlechoice",singlechoice:{iscorrect:null===(s=e.test2.singlechoice)||void 0===s?void 0:s.includes(h)}},html:{htmlContent:i,variableKeywords:n}})}else if(o.hasClass("tests-multichoice")){let i=t.find(".svg-editor-content").html(),n=null!==(d=(null!=i?i:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==d?d:[];Object.assign(S,{type:"test",test:{type:"multichoice",multichoice:{iscorrect:null===(u=e.test2.multichoice)||void 0===u?void 0:u.includes(h)}},html:{htmlContent:i,variableKeywords:n}})}else if(o.hasClass("tests-fill")){let i=t.find(".svg-editor-content").html(),n=null!==(c=(null!=i?i:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==c?c:[],r=null!==(v=(null!=i?i:"").match(/\[\[[a-zA-Z0-9]+\]\]/gm))&&void 0!==v?v:[];r=r.filter(((e,t,i)=>i.indexOf(e)==t)),Object.assign(S,{type:"test",test:{type:"fill",fill:r.map((t=>{var i,n,r;return{key:t,value:null===(r=null===(n=null===(i=e.test2.fill)||void 0===i?void 0:i.find((e=>e.id==h)))||void 0===n?void 0:n.vals)||void 0===r?void 0:r.map((e=>e.text)).filter((e=>!["",null,void 0,NaN].includes(e)))}}))},html:{htmlContent:i,variableKeywords:n,fillKeywords:r}})}else if(o.hasClass("tests-matching")){if(t.hasClass("svg-test-empty"))Object.assign(S,{type:"test",test:{type:"matching-empty",matching:{key:t.attr("data-name")||null}}});else if(t.hasClass("svg-test-content")){let e=t.find(".svg-editor-content").html(),i=null!==(g=(null!=e?e:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==g?g:[];Object.assign(S,{type:"test",test:{type:"matching-content",matching:{key:t.attr("data-name")||null}},html:{htmlContent:e,variableKeywords:i}})}}else if(o.hasClass("tests-speech"))Object.assign(S,{type:"speech",speech:{value:null===(f=null===(y=null===(p=e.test2.speech)||void 0===p?void 0:p.find((e=>e.id==h)))||void 0===y?void 0:y.vals)||void 0===f?void 0:f.map((e=>e.text)).filter((e=>!["",null,void 0,NaN].includes(e)))}});else if(o.hasClass("tests-submit")){let e=jQuery(i).find(".svg-container img");Object.assign(S,{type:"test",test:{type:"submit"},image:Se(e.attr("url"),e.attr("path"),e.attr("src"))})}}else if(o.hasClass("images")){let e=jQuery(i).find(".svg-editor-content img");if(e.length)Object.assign(S,{type:"image",image:Se(e.attr("url"),e.attr("path"),e.attr("src"))});else{let e=jQuery(i).find("iframe");Object.assign(S,{type:"iframe",iframe:Se(e.attr("url"),e.attr("path"),e.attr("src"))})}}else if(o.hasClass("sounds")){let e=jQuery(i).find(".svg-editor-content img");e.length&&Object.assign(S,{type:"image",image:Se(e.attr("url"),e.attr("path"),e.attr("src"))})}else if(o.hasClass("htmls")){let e=jQuery(i).find("iframe");e.length&&Object.assign(S,{type:"iframe",iframe:Se(e.attr("url"),e.attr("path"),e.attr("src"))})}else if(o.hasClass("svgs")){let e=jQuery(i).find("svg");e.length&&Object.assign(S,{type:"svg",svg:Object.assign(Se(e.attr("url"),e.attr("path"),e.attr("src")),{svgContent:null!==(b=null===(m=e.get(0))||void 0===m?void 0:m.outerHTML)&&void 0!==b?b:null})})}else if(o.hasClass("medias")){let e=jQuery(i).find(".media-item");if(e.length)switch(e.attr("type")){case"audio":Object.assign(S,{type:"audio",audio:Se(e.attr("url"),e.attr("path"),e.attr("src"))});break;case"video":Object.assign(S,{type:"video",video:Se(e.attr("url"),e.attr("path"),e.attr("src"))});break;case"file":Object.assign(S,{type:"file",file:Se(e.attr("url"),e.attr("path"),e.attr("src"))});break;default:Object.assign(S,{type:"link",link:{url:null!==(w=e.attr("url"))&&void 0!==w?w:null}})}let t=jQuery(i).find("img");t.length&&(Object.assign(S,{image:Se(t.attr("url"),t.attr("path"),t.attr("src"))}),S.type||Object.assign(S,{type:"image"}))}}return S})(),animate:(()=>{var t;let i={},n=null===(t=e.animates)||void 0===t?void 0:t.find((e=>e.elementId==h));return n&&Object.assign(i,{value:n.value}),i})(),interactive:(()=>{let t={},i=e.actions.show.filter((e=>e.elementId==h&&e.active));i.length&&(t.show={},i.forEach((e=>{var i,n,r,o,l,a,s,d,u,c,h,v,g,p,y,f,m,b,w,S,x,k,O;let{source:_}=e;switch(null==_?void 0:_.type){case"work":t.show.action={},Object.assign(t.show.action,{value:null!==(i=_.value)&&void 0!==i?i:null,iteration:null!==(n=_.iteration)&&void 0!==n?n:null,finish:null!==(r=_.end)&&void 0!==r?r:null,time:null!==(o=_.time)&&void 0!==o?o:null,points:null!==(l=_.points)&&void 0!==l?l:null});break;case"audio":t.show.audio={},Object.assign(t.show.audio,{source:Se(null,null,_.url),iteration:null!==(a=_.iteration)&&void 0!==a?a:null,finish:null!==(s=_.end)&&void 0!==s?s:null,time:null!==(d=_.time)&&void 0!==d?d:null,async:-1==_.iteration?"change-slide":"change-node"});break;case"node":case"node2":_.options.includes("show")&&(t.show.triggershow={},Object.assign(t.show.triggershow,{id:null!==(c=parseInt(null!==(u=_.id)&&void 0!==u?u:"0"))&&void 0!==c?c:null,ids:null===(h=_.ids)||void 0===h?void 0:h.map((e=>parseInt(e))),async:null!==(v=_.async)&&void 0!==v?v:null,time:null!==(g=_.time)&&void 0!==g?g:null})),_.options.includes("run")&&(t.show.triggerrun={},Object.assign(t.show.triggerrun,{id:null!==(y=parseInt(null!==(p=_.id)&&void 0!==p?p:"0"))&&void 0!==y?y:null,ids:null===(f=_.ids)||void 0===f?void 0:f.map((e=>parseInt(e))),async:null!==(m=_.async)&&void 0!==m?m:null,time:null!==(b=_.time)&&void 0!==b?b:null})),_.options.includes("hide")&&(t.show.triggerhide={},Object.assign(t.show.triggerhide,{id:null!==(S=parseInt(null!==(w=_.id)&&void 0!==w?w:"0"))&&void 0!==S?S:null,ids:null===(x=_.ids)||void 0===x?void 0:x.map((e=>parseInt(e))),async:null!==(k=_.async)&&void 0!==k?k:null,time:null!==(O=_.time)&&void 0!==O?O:null}))}})));let n=e.actions.click.filter((e=>e.elementId==h&&e.active));return n&&(t.click={},n.forEach((e=>{var i,n,r,o,l,a,s,d,u,h,v,g,p,y,f,m,b,w,S,x,k,O,_,N;let{source:E}=e;switch(null==E?void 0:E.type){case"work":t.click.action={},Object.assign(t.click.action,{value:null!==(i=E.value)&&void 0!==i?i:null,iteration:null!==(n=E.iteration)&&void 0!==n?n:null,finish:null!==(r=E.end)&&void 0!==r?r:null,time:null!==(o=E.time)&&void 0!==o?o:null,points:null!==(l=E.points)&&void 0!==l?l:null});break;case"audio":t.click.audio={},Object.assign(t.click.audio,{source:Se(null,null,E.url),iteration:null!==(a=E.iteration)&&void 0!==a?a:null,finish:null!==(s=E.end)&&void 0!==s?s:null,time:null!==(d=E.time)&&void 0!==d?d:null,async:-1==E.iteration?"change-slide":"change-node"});break;case"video":{t.click.video={},Object.assign(t.click.video,{source:Se(E.url,E.path)});let{url:e,path:i,name:n}=Se(E.url,E.path);t.click.media={},Object.assign(t.click.media,{url:e,path:i,name:n,type:c.VIDEO});break}case"image":{t.click.image={},Object.assign(t.click.image,{source:Se(E.url,E.path)});let{url:e,path:i,name:n}=Se(E.url,E.path);t.click.media={},Object.assign(t.click.media,{url:e,path:i,name:n,type:c.IMAGE});break}case"link":{t.click.link={},Object.assign(t.click.link,{url:E.url,target:E.target});let{url:e,path:i,name:n}=Se(E.url,E.path);t.click.media={},Object.assign(t.click.media,{url:e,path:i,name:n,type:c.LINK});break}case"text":t.click.text={},Object.assign(t.click.text,{content:E.content});break;case"node":case"node2":E.options.includes("show")&&(t.click.triggershow={},Object.assign(t.click.triggershow,{id:null!==(h=parseInt(null!==(u=E.id)&&void 0!==u?u:"0"))&&void 0!==h?h:null,ids:null===(v=E.ids)||void 0===v?void 0:v.map((e=>parseInt(e))),async:null!==(g=E.async)&&void 0!==g?g:null,time:null!==(p=E.time)&&void 0!==p?p:null})),E.options.includes("run")&&(t.click.triggerrun={},Object.assign(t.click.triggerrun,{id:null!==(f=parseInt(null!==(y=E.id)&&void 0!==y?y:"0"))&&void 0!==f?f:null,ids:null===(m=E.ids)||void 0===m?void 0:m.map((e=>parseInt(e))),async:null!==(b=E.async)&&void 0!==b?b:null,time:null!==(w=E.time)&&void 0!==w?w:null})),E.options.includes("hide")&&(t.click.triggerhide={},Object.assign(t.click.triggerhide,{id:null!==(x=parseInt(null!==(S=E.id)&&void 0!==S?S:"0"))&&void 0!==x?x:null,ids:null===(k=E.ids)||void 0===k?void 0:k.map((e=>parseInt(e))),async:null!==(O=E.async)&&void 0!==O?O:null,time:null!==(_=E.time)&&void 0!==_?_:null}));break;case"slide":t.click.slide={},Object.assign(t.click.slide,{id:parseInt(null!==(N=E.id)&&void 0!==N?N:"0")||E.num||null,code:E.id})}}))),t})(),variable:(()=>{var t,n,r,o,l,a,s;let d={};i.getAttribute("data-variable")&&(d.input={},Object.assign(d.input,{variable:null!==(t=i.getAttribute("data-variable"))&&void 0!==t?t:null}));let u=null===(r=null===(n=e.nodes)||void 0===n?void 0:n.find((e=>e.id==h)))||void 0===r?void 0:r.variable;return u&&(d.click={},Object.assign(d.click,{variable:null!==(o=u.variable)&&void 0!==o?o:null,operator:null!==(l=u.operator)&&void 0!==l?l:null,valuetype:null!==(a=u.valuetype)&&void 0!==a?a:null,value:null!==(s=u.value)&&void 0!==s?s:null})),d})()};null===(r=l.svg)||void 0===r||r.nodes.push(v)})),i.push(l)})),{screen:{width:e.screen.w,height:e.screen.h},data:{slides:i},variable:e.variable,fonts:[]}},ke=(e,t)=>{var i,n,r;null===(r=null===(n=null===(i=t.test)||void 0===i?void 0:i.answer)||void 0===n?void 0:n.matching)||void 0===r||r.filter((t=>t.id==e.id)).forEach((e=>e.value="")),jQuery(`#node-${e.id}`).remove()},Oe=(e,t,i,n,r,o)=>{var l,a,s,d,u,c,h,v,g,p,y,f;r.iscorrect?((null===(a=null===(l=t.test)||void 0===l?void 0:l.audiotrue)||void 0===a?void 0:a.path)&&pe(e,{source:we(null===(s=t.test)||void 0===s?void 0:s.audiotrue),iteration:0,nodeStatus:i,slideStatus:n},o),(null===(u=null===(d=t.test)||void 0===d?void 0:d.effecttrue)||void 0===u?void 0:u.path)&&ce(0,{source:we(null===(c=t.test)||void 0===c?void 0:c.effecttrue),iteration:0,nodeStatus:i,slideStatus:n},o)):((null===(v=null===(h=t.test)||void 0===h?void 0:h.audiofalse)||void 0===v?void 0:v.path)&&pe(e,{source:we(null===(g=t.test)||void 0===g?void 0:g.audiofalse),iteration:0,nodeStatus:i,slideStatus:n},o),(null===(y=null===(p=t.test)||void 0===p?void 0:p.effectfalse)||void 0===y?void 0:y.path)&&ce(0,{source:we(null===(f=t.test)||void 0===f?void 0:f.effectfalse),iteration:0,nodeStatus:i,slideStatus:n},o)),_e(t,i,n,o)},_e=(e,t,i,n)=>{var r,o,l,a,s,d,u,c,h,v,g,p,y,f,m,b,w,S,x,k,O,_,N,E,I,z,J,j;switch(null===(r=e.test)||void 0===r?void 0:r.type){case"truefalse":{let{value:r,iscorrect:g}=null!==(a=null===(l=null===(o=null==e?void 0:e.test)||void 0===o?void 0:o.answer)||void 0===l?void 0:l.truefalse)&&void 0!==a?a:{};if(r){let o=Be.findNode(r);g?(null===(d=null===(s=e.test)||void 0===s?void 0:s.icontrue)||void 0===d?void 0:d.path)&&ve(o,{source:we(null===(u=e.test)||void 0===u?void 0:u.icontrue),iteration:0,nodeStatus:t,slideStatus:i},n):(null===(h=null===(c=e.test)||void 0===c?void 0:c.iconfalse)||void 0===h?void 0:h.path)&&ve(o,{source:we(null===(v=e.test)||void 0===v?void 0:v.iconfalse),iteration:0,nodeStatus:t,slideStatus:i},n)}break}case"singlechoice":{let{value:r,iscorrect:o}=null!==(y=null===(p=null===(g=null==e?void 0:e.test)||void 0===g?void 0:g.answer)||void 0===p?void 0:p.singlechoice)&&void 0!==y?y:{};if(r){let l=Be.findNode(r);o?(null===(m=null===(f=e.test)||void 0===f?void 0:f.icontrue)||void 0===m?void 0:m.path)&&ve(l,{source:we(null===(b=e.test)||void 0===b?void 0:b.icontrue),iteration:0,nodeStatus:t,slideStatus:i},n):(null===(S=null===(w=e.test)||void 0===w?void 0:w.iconfalse)||void 0===S?void 0:S.path)&&ve(l,{source:we(null===(x=e.test)||void 0===x?void 0:x.iconfalse),iteration:0,nodeStatus:t,slideStatus:i},n)}break}case"multichoice":null===(_=null===(O=null===(k=null==e?void 0:e.test)||void 0===k?void 0:k.answer)||void 0===O?void 0:O.multichoice)||void 0===_||_.forEach((r=>{var o,l,a,s,d,u;let{value:c,iscorrect:h}=r;if(c){let r=Be.findNode(c);h?(null===(l=null===(o=e.test)||void 0===o?void 0:o.icontrue)||void 0===l?void 0:l.path)&&ve(r,{source:we(null===(a=e.test)||void 0===a?void 0:a.icontrue),iteration:0,nodeStatus:t,slideStatus:i},n):(null===(d=null===(s=e.test)||void 0===s?void 0:s.iconfalse)||void 0===d?void 0:d.path)&&ve(r,{source:we(null===(u=e.test)||void 0===u?void 0:u.iconfalse),iteration:0,nodeStatus:t,slideStatus:i},n)}}));break;case"fill":null===(I=null===(E=null===(N=null==e?void 0:e.test)||void 0===N?void 0:N.answer)||void 0===E?void 0:E.fill)||void 0===I||I.forEach((r=>{var o,l,a,s,d,u;let{id:c,key:h,value:v,iscorrect:g}=r;if(v){let r=Be.findNode(c);g?(null===(l=null===(o=e.test)||void 0===o?void 0:o.icontrue)||void 0===l?void 0:l.path)&&ve(r,{source:we(null===(a=e.test)||void 0===a?void 0:a.icontrue),iteration:0,nodeStatus:t,slideStatus:i},n):(null===(d=null===(s=e.test)||void 0===s?void 0:s.iconfalse)||void 0===d?void 0:d.path)&&ve(r,{source:we(null===(u=e.test)||void 0===u?void 0:u.iconfalse),iteration:0,nodeStatus:t,slideStatus:i},n)}}));break;case"matching":null===(j=null===(J=null===(z=null==e?void 0:e.test)||void 0===z?void 0:z.answer)||void 0===J?void 0:J.matching)||void 0===j||j.forEach((r=>{var o,l,a,s,d,u;let{id:c,key:h,value:v}=r;if(v){let r=Be.findNode(c);h==v?(null===(l=null===(o=e.test)||void 0===o?void 0:o.icontrue)||void 0===l?void 0:l.path)&&ve(r,{source:we(null===(a=e.test)||void 0===a?void 0:a.icontrue),iteration:0,nodeStatus:t,slideStatus:i},n):(null===(d=null===(s=e.test)||void 0===s?void 0:s.iconfalse)||void 0===d?void 0:d.path)&&ve(r,{source:we(null===(u=e.test)||void 0===u?void 0:u.iconfalse),iteration:0,nodeStatus:t,slideStatus:i},n)}}))}},Ne=(e,t,i,n)=>{var o,l,s,d,u,c,h,v,g,p;(null===(o=t.animate)||void 0===o?void 0:o.value)&&((e,t,i)=>{var n;let{value:r}=null!==(n=e.animate)&&void 0!==n?n:{};F(e.id,{node:e,value:r,nodeStatus:t,slideStatus:i},(()=>{}))})(t,i.nodeStatus,i.slideStatus),(null===(l=t.interactive)||void 0===l?void 0:l.show)?(console.log(`node(${t.id}) | nodeStatus(${i.nodeStatus}) | slideStatus(${i.slideStatus}) | show`),((e,t,i,n)=>{var r,o,l;let a={total:0,counter:0},{triggershow:s,triggerrun:d,triggerhide:u,action:c,audio:h}=null!==(o=null===(r=e.interactive)||void 0===r?void 0:r.show)&&void 0!==o?o:{};if(console.log(`node(${e.id}) | nodeStatus(${t}) | slideStatus(${i}) | show`),s){let{id:e,ids:n,time:r,async:o}=s;"asynctrue"==o?setTimeout((()=>{oe({id:e,ids:n,nodeStatus:t,slideStatus:i})})):"time"==o&&setTimeout((()=>{oe({id:e,ids:n,nodeStatus:t,slideStatus:i})}),1e3*(null!=r?r:0))}if(d){let{id:e,ids:n,time:r,async:o}=d;"asynctrue"==o?setTimeout((()=>{le({id:e,ids:n,nodeStatus:t,slideStatus:i})})):"time"==o&&setTimeout((()=>{le({id:e,ids:n,nodeStatus:t,slideStatus:i})}),1e3*(null!=r?r:0))}if(u){let{id:e,ids:n,time:r,async:o}=u;"asynctrue"==o?setTimeout((()=>{ae({id:e,ids:n,nodeStatus:t,slideStatus:i})})):"time"==o&&setTimeout((()=>{ae({id:e,ids:n,nodeStatus:t,slideStatus:i})}),1e3*(null!=r?r:0))}let v=()=>{setTimeout((()=>{if(a.counter>=a.total){if(n&&n(),s){let{id:e,ids:n,async:r}=s;r&&"asyncfalse"!=r||oe({id:e,ids:n,nodeStatus:t,slideStatus:i})}if(d){let{id:e,ids:n,async:r}=d;r&&"asyncfalse"!=r||le({id:e,ids:n,nodeStatus:t,slideStatus:i})}if(u){let{id:e,ids:n,async:r}=u;r&&"asyncfalse"!=r||ae({id:e,ids:n,nodeStatus:t,slideStatus:i})}}}))};if(null==c?void 0:c.value){a.total+=1;let n=()=>{a.counter+=1,v()};switch(null==c?void 0:c.value){case"hide":jQuery("#"+e.id).addClass("hide"),n();break;case"points":{let{points:r,time:o,iteration:l,finish:a}=c;ne(e.id,{node:e,points:r,time:o,iteration:l,finish:a,nodeStatus:t,slideStatus:i},n);break}default:{let{value:r,time:o,iteration:l,finish:a}=c;G(e.id,{node:e,value:r,time:o,iteration:l,finish:a,nodeStatus:t,slideStatus:i},n);break}}}if(null===(l=null==h?void 0:h.source)||void 0===l?void 0:l.path){a.total+=1;let n=()=>{a.counter+=1,v()},r=re(e.id,h,a,{nodeStatus:t,slideStatus:i},n);-1==(null==h?void 0:h.iteration)&&jQuery("#"+e.id).click((e=>{e.preventDefault(),r&&(r.volume>=1?r.volume=0:r.volume=r.volume+.25),console.log(null==r?void 0:r.volume)}))}a.total||v()})(t,i.nodeStatus,i.slideStatus,n)):n&&n(),(null===(s=t.interactive)||void 0===s?void 0:s.click)&&(p=null===(d=t.interactive)||void 0===d?void 0:d.click,Object.keys(null!=p?p:{}).map((e=>p[e]?1:0)).includes(1)&&jQuery("#"+t.id).addClass("interactive-click"),jQuery("#"+t.id).click((e=>{e.preventDefault(),i.nodeStatus=Be.refreshNodeStatus(),console.log(`node(${t.id}) | nodeStatus(${i.nodeStatus}) | slideStatus(${i.slideStatus}) | click`),se(t,i.nodeStatus,i.slideStatus)}))),(null===(u=t.variable)||void 0===u?void 0:u.input)&&jQuery("#"+t.id).on("change","input,textarea",(i=>{i.preventDefault(),((e,t,i)=>{var n,r,o;nn.variable.setValue(null!==(o=null===(r=null===(n=t.variable)||void 0===n?void 0:n.input)||void 0===r?void 0:r.variable)&&void 0!==o?o:"",e),(e=>{var t;let i=(e,t)=>{null==e||e.forEach((e=>{switch(e.type){case a.GROUP:ue(e.id,{},t?window.document.getElementById(t):null),i(e.nodes,e.id);break;case a.POLYGON:break;case a.TEXT:de(e.id,{size:e.size,attribute:e.attribute,source:e.source},t?window.document.getElementById(t):null)}}))};i(null===(t=e.svg)||void 0===t?void 0:t.nodes)})(i)})(i.target.value,t,e)})),(null===(c=t.variable)||void 0===c?void 0:c.click)&&((null===(v=null===(h=t.variable)||void 0===h?void 0:h.click)||void 0===v?void 0:v.variable)&&jQuery("#"+t.id).addClass("variable-click"),jQuery("#"+t.id).click((i=>{i.preventDefault(),((e,t)=>{var i;nn.variable.setValueOperator(null===(i=e.variable)||void 0===i?void 0:i.click),(e=>{var t;let i=(e,t)=>{null==e||e.forEach((e=>{switch(e.type){case a.GROUP:ue(e.id,{},t?window.document.getElementById(t):null),i(e.nodes,e.id);break;case a.POLYGON:break;case a.TEXT:de(e.id,{size:e.size,attribute:e.attribute,source:e.source},t?window.document.getElementById(t):null)}}))};i(null===(t=e.svg)||void 0===t?void 0:t.nodes)})(t)})(t,e)}))),"test"==(null===(g=t.source)||void 0===g?void 0:g.type)&&((e,t)=>{var i,n,o;let l=()=>{};switch(null===(n=null===(i=e.source)||void 0===i?void 0:i.test)||void 0===n?void 0:n.type){case"truefalse":{jQuery("#"+e.id).click((i=>{i.preventDefault();let n=Be.nodeStatus,o=Be.slideStatus;((e,t,i,n,o)=>{var l,a,s,d;let u=null===(s=null===(a=null===(l=e.source)||void 0===l?void 0:l.test)||void 0===a?void 0:a.truefalse)||void 0===s?void 0:s.iscorrect;t.test?t.test.answer?t.test.answer.truefalse={value:e.id,iscorrect:u}:t.test.answer={truefalse:{value:e.id,iscorrect:u}}:t.test={answer:{truefalse:{value:e.id,iscorrect:u}}},(null===(d=t.svg)||void 0===d?void 0:d.nodes.find((e=>{var t,i;return"submit"==(null===(i=null===(t=e.source)||void 0===t?void 0:t.test)||void 0===i?void 0:i.type)})))||Oe(e,t,i,n,{iscorrect:u},o);let c=We(r.TEST_GROUP,"g",void 0,nn.target);it(c,t,e)})(e,t,n,o,l)}));let i=We(r.TEST_GROUP,"g",void 0,nn.target);it(i,t,e);break}case"singlechoice":{jQuery("#"+e.id).click((i=>{i.preventDefault();let n=Be.nodeStatus,o=Be.slideStatus;((e,t,i,n,o)=>{var l,a,s,d;let u=null===(s=null===(a=null===(l=e.source)||void 0===l?void 0:l.test)||void 0===a?void 0:a.singlechoice)||void 0===s?void 0:s.iscorrect;t.test?t.test.answer?t.test.answer.singlechoice={value:e.id,iscorrect:u}:t.test.answer={singlechoice:{value:e.id,iscorrect:u}}:t.test={answer:{singlechoice:{value:e.id,iscorrect:u}}},(null===(d=t.svg)||void 0===d?void 0:d.nodes.find((e=>{var t,i;return"submit"==(null===(i=null===(t=e.source)||void 0===t?void 0:t.test)||void 0===i?void 0:i.type)})))||Oe(e,t,i,n,{iscorrect:u},o);let c=We(r.TEST_GROUP,"g",void 0,nn.target);it(c,t,e)})(e,t,n,o,l)}));let i=We(r.TEST_GROUP,"g",void 0,nn.target);it(i,t,e);break}case"multichoice":{jQuery("#"+e.id).click((i=>{i.preventDefault();let n=Be.nodeStatus,o=Be.slideStatus;((e,t,i,n,o)=>{var l,a,s,d;let u=null===(s=null===(a=null===(l=e.source)||void 0===l?void 0:l.test)||void 0===a?void 0:a.multichoice)||void 0===s?void 0:s.iscorrect;t.test?t.test.answer?t.test.answer.multichoice?t.test.answer.multichoice.find((t=>t.value==e.id))?t.test.answer.multichoice=t.test.answer.multichoice.filter((t=>t.value!=e.id)):t.test.answer.multichoice.push({value:e.id,iscorrect:u}):t.test.answer.multichoice=[{value:e.id,iscorrect:u}]:t.test.answer={multichoice:[{value:e.id,iscorrect:u}]}:t.test={answer:{multichoice:[{value:e.id,iscorrect:u}]}},(null===(d=t.svg)||void 0===d?void 0:d.nodes.find((e=>{var t,i;return"submit"==(null===(i=null===(t=e.source)||void 0===t?void 0:t.test)||void 0===i?void 0:i.type)})))||Oe(e,t,i,n,{iscorrect:u},o);let c=We(r.TEST_GROUP,"g",void 0,nn.target);it(c,t,e)})(e,t,n,o,l)}));let i=We(r.TEST_GROUP,"g",void 0,nn.target);it(i,t,e);break}case"fill":{jQuery("#"+e.id).on("keyup",'input[type="text"]',(e=>{var t;let i=jQuery("<div/>").css({"font-size":jQuery(e.target).css("font-size"),visibility:"hidden",float:"left"}).text(e.target.value).appendTo(window.document.body);jQuery(e.target).css({width:(null!==(t=i.width())&&void 0!==t?t:0)+30})})).on("keypress",'input[type="text"]',(e=>{13===(e.keyCode||e.charCode||e.which)&&(e.preventDefault(),e.stopPropagation(),jQuery(e.target).blur())})).on("change",'input[type="text"]',(i=>{var n,o,a;let s=null===(n=i.target)||void 0===n?void 0:n.getAttribute("data-key"),d=null===(a=null===(o=i.target)||void 0===o?void 0:o.value)||void 0===a?void 0:a.trim();jQuery("#"+e.id).find(`input[type="text"][data-key="${s}"]`).val(d);let u=Be.nodeStatus,c=Be.slideStatus;((e,t,i,n,o,l)=>{var a,s,d,u,c,h;let{value:v}=null!==(u=null===(d=null===(s=null===(a=e.source)||void 0===a?void 0:a.test)||void 0===s?void 0:s.fill)||void 0===d?void 0:d.find((e=>e.key==`[[${o.key}]]`)))&&void 0!==u?u:{},g=v&&v.map((e=>null==e?void 0:e.toLocaleLowerCase())).includes(null===(c=o.value)||void 0===c?void 0:c.toLocaleLowerCase());o.iscorrect=g,t.test?t.test.answer?t.test.answer.fill?t.test.answer.fill.find((e=>e.key==o.key))?t.test.answer.fill.filter((e=>e.key==o.key)).forEach((e=>{e.value=o.value,e.iscorrect=o.iscorrect})):t.test.answer.fill.push(o):t.test.answer.fill=[o]:t.test.answer={fill:[o]}:t.test={answer:{fill:[o]}};let p=We(r.TEST_GROUP,"g",void 0,nn.target);it(p,t,e),(null===(h=t.svg)||void 0===h?void 0:h.nodes.find((e=>{var t,i;return"submit"==(null===(i=null===(t=e.source)||void 0===t?void 0:t.test)||void 0===i?void 0:i.type)})))||Oe(e,t,i,n,{iscorrect:g},l)})(e,t,u,c,{id:e.id,key:s,value:d},l)})),(null===(o=t.test)||void 0===o?void 0:o.showselection)||jQuery("#"+e.id).addClass("hide-selection");let i=We(r.TEST_GROUP,"g",void 0,nn.target);it(i,t,e);break}case"matching-empty":{jQuery("#"+e.id).on("touchmove",".ondrag-item",(function(e){e.preventDefault()})).kendoDraggable({filter:".ondrag-item",hint:function(t){return`<div class="ondrag-hint" style="transform: translateX(100%) translateY(100%);width:64px;height:${e.size.height/e.size.width*64}px;border-radius:8px;border:1px dashed #DADADA;padding:8px;box-sizing:content-box;background-color:rgba(255,255,255,0.8);">${t.prop("outerHTML")}</div>`.replace(/\s+/g," ")},dragstart:function(i){var n;jQuery('svg foreignObject .ondrop-here[data-type2="matching-content"]:empty').addClass("actived"),jQuery('svg foreignObject .ondrop-here[data-type2="matching-empty"]').addClass("actived"),(null===(n=t.test)||void 0===n?void 0:n.showselection)||jQuery('svg foreignObject .ondrop-here[data-type="matching"]').addClass("hide-selection"),ke(e,t)},drag:function(e){},dragend:function(e){jQuery("svg foreignObject .ondrop-here").removeClass("actived"),jQuery("svg foreignObject .ondrop-here").removeClass("focused")},dragcancel:function(){jQuery("svg foreignObject .ondrop-here").removeClass("actived"),jQuery("svg foreignObject .ondrop-here").removeClass("focused")}}),jQuery(`#${e.id} .ondrop-here`).kendoDropTarget({dragenter:function(e){e.dropTarget.hasClass("actived")&&e.dropTarget.addClass("focused")},dragleave:function(e){e.dropTarget.hasClass("actived")&&e.dropTarget.removeClass("focused")},drop:function(i){if(!i.dropTarget.hasClass("actived"))return;i.dropTarget.removeClass("focused");let n=i.dropTarget,o=i.draggable.currentTarget;n.is(":empty")||n.find(".ondrag-item").appendTo($('svg foreignObject .ondrop-here[data-type2="matching-content"]:empty').first()),o.appendTo(n);let a=We(r.TEST_GROUP,"g",void 0,nn.target);it(a,t,e);let s=Be.nodeStatus,d=Be.slideStatus;((e,t,i,n,r,o)=>{var l,a,s,d;let{key:u}=null!==(s=null===(a=null===(l=e.source)||void 0===l?void 0:l.test)||void 0===a?void 0:a.matching)&&void 0!==s?s:{key:"KIEN"},c=r.key==u;ke(e,t);let h={id:e.id,key:null!=u?u:"",value:r.key};t.test?t.test.answer?t.test.answer.matching?t.test.answer.matching.find((e=>e.id==h.id))?t.test.answer.matching.filter((e=>e.id==h.id)).forEach((e=>{e.key=h.key,e.value=h.value})):t.test.answer.matching.push(h):t.test.answer.matching=[h]:t.test.answer={matching:[h]}:t.test={answer:{matching:[h]}},(null===(d=t.svg)||void 0===d?void 0:d.nodes.find((e=>{var t,i;return"submit"==(null===(i=null===(t=e.source)||void 0===t?void 0:t.test)||void 0===i?void 0:i.type)})))||Oe(e,t,i,n,{iscorrect:c},o)})(e,t,s,d,{key:o.data("key")},l)}});let i=We(r.TEST_GROUP,"g",void 0,nn.target);it(i,t,e);break}case"matching-content":{jQuery("#"+e.id).on("touchmove",".ondrag-item",(function(e){e.preventDefault()})).kendoDraggable({filter:".ondrag-item",hint:function(t){return`<div class="ondrag-hint" style="transform: translateX(100%) translateY(100%);width:64px;height:${e.size.height/e.size.width*64}px;border-radius:8px;border:1px dashed #DADADA;padding:8px;box-sizing:content-box;background-color:rgba(255,255,255,0.8);">${t.prop("outerHTML")}</div>`.replace(/\s+/g," ")},dragstart:function(e){var i;jQuery('svg foreignObject .ondrop-here[data-type2="matching-content"]:empty').addClass("actived"),jQuery('svg foreignObject .ondrop-here[data-type2="matching-empty"]').addClass("actived"),(null===(i=t.test)||void 0===i?void 0:i.showselection)||jQuery('svg foreignObject .ondrop-here[data-type="matching"]').addClass("hide-selection")},drag:function(e){},dragend:function(e){jQuery("svg foreignObject .ondrop-here").removeClass("actived"),jQuery("svg foreignObject .ondrop-here").removeClass("focused")},dragcancel:function(){jQuery("svg foreignObject .ondrop-here").removeClass("actived"),jQuery("svg foreignObject .ondrop-here").removeClass("focused")}}),jQuery(`#${e.id} .ondrop-here`).kendoDropTarget({dragenter:function(e){e.dropTarget.hasClass("actived")&&e.dropTarget.addClass("focused")},dragleave:function(e){e.dropTarget.hasClass("actived")&&e.dropTarget.removeClass("focused")},drop:function(i){if(!i.dropTarget.hasClass("actived"))return;i.dropTarget.removeClass("focused");let n=We(r.TEST_GROUP,"g",void 0,nn.target);it(n,t,e);let o=i.dropTarget;i.draggable.currentTarget.appendTo(o);let a=Be.nodeStatus,s=Be.slideStatus;_e(t,a,s,l)}});let i=We(r.TEST_GROUP,"g",void 0,nn.target);it(i,t,e);break}case"speech":break;case"submit":jQuery("#"+e.id).click((i=>{i.preventDefault();let n=Be.nodeStatus,r=Be.slideStatus;((e,t,i,n,r)=>{var o,l,a,s,d,u,c,h,v,g,p,y,f,m,b,w,S,x,k,O,_,N,E,I,z,J,j,T,$,C,A,B,R,M,L,P,F,K;let G;(null===(l=null===(o=null==t?void 0:t.test)||void 0===o?void 0:o.answer)||void 0===l?void 0:l.truefalse)?G=null===(d=null===(s=null===(a=null==t?void 0:t.test)||void 0===a?void 0:a.answer)||void 0===s?void 0:s.truefalse)||void 0===d?void 0:d.iscorrect:(null===(c=null===(u=null==t?void 0:t.test)||void 0===u?void 0:u.answer)||void 0===c?void 0:c.singlechoice)?G=null===(g=null===(v=null===(h=null==t?void 0:t.test)||void 0===h?void 0:h.answer)||void 0===v?void 0:v.singlechoice)||void 0===g?void 0:g.iscorrect:(null===(y=null===(p=null==t?void 0:t.test)||void 0===p?void 0:p.answer)||void 0===y?void 0:y.multichoice)?G=1==[null===(b=null===(m=null===(f=null==t?void 0:t.test)||void 0===f?void 0:f.answer)||void 0===m?void 0:m.multichoice)||void 0===b?void 0:b.length,null===(k=null===(x=null===(S=null===(w=null==t?void 0:t.test)||void 0===w?void 0:w.answer)||void 0===S?void 0:S.multichoice)||void 0===x?void 0:x.map((e=>e.iscorrect?1:0)))||void 0===k?void 0:k.reduce(((e,t)=>e+t)),null===(N=null===(_=null===(O=null==t?void 0:t.svg)||void 0===O?void 0:O.nodes)||void 0===_?void 0:_.filter((e=>{var t,i,n,r,o;return"multichoice"==(null===(i=null===(t=e.source)||void 0===t?void 0:t.test)||void 0===i?void 0:i.type)&&(null===(o=null===(r=null===(n=e.source)||void 0===n?void 0:n.test)||void 0===r?void 0:r.multichoice)||void 0===o?void 0:o.iscorrect)})))||void 0===N?void 0:N.length].filter(((e,t,i)=>i.indexOf(e)==t)).length:(null===(I=null===(E=null==t?void 0:t.test)||void 0===E?void 0:E.answer)||void 0===I?void 0:I.fill)?G=(null===(T=null===(j=null===(J=null===(z=null==t?void 0:t.test)||void 0===z?void 0:z.answer)||void 0===J?void 0:J.fill)||void 0===j?void 0:j.map((e=>e.iscorrect?1:0)))||void 0===T?void 0:T.reduce(((e,t)=>e+t)))==(null===(A=null===(C=null===($=t.svg)||void 0===$?void 0:$.nodes)||void 0===C?void 0:C.filter((e=>{var t,i;return"fill"==(null===(i=null===(t=e.source)||void 0===t?void 0:t.test)||void 0===i?void 0:i.type)})))||void 0===A?void 0:A.length):(null===(R=null===(B=null==t?void 0:t.test)||void 0===B?void 0:B.answer)||void 0===R?void 0:R.matching)&&(G=(null===(P=null===(L=null===(M=t.svg)||void 0===M?void 0:M.nodes)||void 0===L?void 0:L.filter((e=>{var t,i;return"matching-empty"==(null===(i=null===(t=e.source)||void 0===t?void 0:t.test)||void 0===i?void 0:i.type)})))||void 0===P?void 0:P.length)==((null===(K=null===(F=null==t?void 0:t.test)||void 0===F?void 0:F.answer)||void 0===K?void 0:K.matching)||[]).map((e=>e.key==e.value?1:0)).reduce(((e,t)=>e+t))),Oe(e,t,i,n,{iscorrect:G},r)})(e,t,n,r,l)}))}})(t,e)},Ee=(e,t,i)=>{let n=(null==t?void 0:t.size)||{x:0,y:0,width:10,height:10},r=(null==t?void 0:t.attribute)||{fill:nn.attribute.fill,stroke:nn.attribute.stroke,strokeWidth:nn.attribute.strokeWidth};return{nodeId:e,element:Ke(e,a.ELLIPSE,"ellipse",{size:n,attribute:r},i),size:n,attribute:r}},Ie=(e,t,i)=>{let n=(null==t?void 0:t.size)||{x:0,y:0,width:10,height:10},r=(null==t?void 0:t.attribute)||{stroke:nn.attribute.stroke,strokeWidth:nn.attribute.strokeWidth,strokeLinecap:nn.attribute.strokeLinecap};return{nodeId:e,element:Ke(e,a.LINE,"line",{size:n,attribute:r},i),size:n,attribute:r}},ze=(e,t,i)=>{let n=(null==t?void 0:t.size)||{x:0,y:0,width:10,height:10},r=(null==t?void 0:t.attribute)||{fill:nn.attribute.fill,stroke:nn.attribute.stroke,strokeWidth:nn.attribute.strokeWidth};return{nodeId:e,element:Ke(e,a.POLYGON,"polygon",{size:n,attribute:r},i),size:n,attribute:r}},Je=(e,t,i)=>{let n=(null==t?void 0:t.size)||{x:0,y:0,width:320,height:80},r=(null==t?void 0:t.attribute)||{},o=(null==t?void 0:t.source)||{type:"html",html:{htmlContent:""}},l=(null==t?void 0:t.style)||{};return{nodeId:e,element:Ke(e,a.FOREIGNOBJECT,"foreignObject",{size:n,attribute:r,style:l,source:o},i),size:n,attribute:r,style:l,source:o}},je=(e,t,i)=>{let n=(null==t?void 0:t.size)||{x:0,y:0,width:10,height:10},r=(null==t?void 0:t.attribute)||{stroke:nn.attribute.stroke,strokeWidth:nn.attribute.strokeWidth};return{nodeId:e,element:Ke(e,a.PATH,"path",{size:n,attribute:r},i),size:n,attribute:r}},Te=(e,t,i)=>{let n=(null==t?void 0:t.size)||{x:0,y:0,width:10,height:10},r=(null==t?void 0:t.attribute)||{fill:nn.attribute.fill,stroke:nn.attribute.stroke,strokeWidth:nn.attribute.strokeWidth};return{nodeId:e,element:Ke(e,a.POLYLINE,"polyline",{size:n,attribute:r},i),size:n,attribute:r}},$e=(e,t,i)=>{let n=(null==t?void 0:t.size)||{x:0,y:0,width:320,height:80},r=(null==t?void 0:t.attribute)||{fill:nn.attribute.stroke,fontFamily:nn.attribute.fontFamily,fontSize:nn.attribute.fontSize,textLength:nn.attribute.textLength},o=(null==t?void 0:t.source)||{type:"text",text:{textContent:""}};return{nodeId:e,element:Ke(e,a.TSPAN,"tspan",{size:n,attribute:r,source:o},i),size:n,attribute:r,source:o}},Ce=(e,t,i)=>{if(i.slideStatus!=Be.slideStatus)return;if(!t.length)return;let n=t.shift(),r=e.filter((e=>{var t;return(null!==(t=e.idx)&&void 0!==t?t:0)==n}));if(!r.length)return;let o=Math.max.apply(null,r.map((e=>{var t;return null!==(t=e.time)&&void 0!==t?t:0}))),l=!1,a=o<.5?0:setTimeout((()=>{l||(l=!0,Ce(e,t,i))}),1e3*o);Ae(e,t,r,0,i,{idx:n,total:r.length,counter:0,isRecursive:l,timeoutRecursive:a,maxTimeCoundown:o,uid:Math.floor(1e9*Math.random())})},Ae=(e,t,i,n,r,o)=>{if(r.slideStatus!=Be.slideStatus)return;let l=i[n];if(l){switch(l.type){case a.GROUP:break;case a.CIRCLE:P(l.id,{size:l.size,attribute:l.attribute},l.pid?window.document.getElementById(l.pid):null);break;case a.ELLIPSE:Ee(l.id,{size:l.size,attribute:l.attribute},l.pid?window.document.getElementById(l.pid):null);break;case a.LINE:Ie(l.id,{size:l.size,attribute:l.attribute},l.pid?window.document.getElementById(l.pid):null);break;case a.RECT:M(l.id,{size:l.size,attribute:l.attribute},l.pid?window.document.getElementById(l.pid):null);break;case a.POLYGON:ze(l.id,{size:l.size,attribute:l.attribute},l.pid?window.document.getElementById(l.pid):null);break;case a.POLYLINE:Te(l.id,{size:l.size,attribute:l.attribute},l.pid?window.document.getElementById(l.pid):null);break;case a.FOREIGNOBJECT:Je(l.id,{size:l.size,attribute:l.attribute,style:l.style,source:l.source},l.pid?window.document.getElementById(l.pid):null);break;case a.IMAGE:L(l.id,{size:l.size,attribute:l.attribute,source:l.source},l.pid?window.document.getElementById(l.pid):null);break;case a.TEXT:de(l.id,{size:l.size,attribute:l.attribute,source:l.source},l.pid?window.document.getElementById(l.pid):null);break;case a.TSPAN:$e(l.id,{size:l.size,attribute:l.attribute,source:l.source},l.pid?window.document.getElementById(l.pid):null);break;case a.PATH:je(l.id,{size:l.size,attribute:l.attribute},l.pid?window.document.getElementById(l.pid):null)}Ne(r.slide,l,r,(()=>{o.counter+=1,o.maxTimeCoundown<.5&&o.counter>=o.total&&(o.total=o.counter=0,o.isRecursive||(clearTimeout(o.timeoutRecursive),o.isRecursive=!0,setTimeout((()=>{Ce(e,t,r)}),250)))})),Ae(e,t,i,++n,r,o)}},Be=new class{constructor(){this._nodeStatus=0,this._slideStatus=0,this._slideIdx=0,this._fnChangeSlides=[]}set data(e){this._dataSource=e.data||{},nn.variable.set=e.variable||{}}get nodeStatus(){return this._nodeStatus}refreshNodeStatus(){return this._nodeStatus=Math.floor(999999999*Math.random()),this._nodeStatus}get slideStatus(){return this._slideStatus}refreshSlideStatus(){return this._slideStatus=Math.floor(999999999*Math.random()),this._slideStatus}get slideIdx(){return this._slideIdx}get slideTotal(){var e,t,i;return null!==(i=null===(t=null===(e=this._dataSource)||void 0===e?void 0:e.slides)||void 0===t?void 0:t.length)&&void 0!==i?i:0}get slides(){var e;return(null===(e=this._dataSource)||void 0===e?void 0:e.slides)||[]}get slide(){var e;return((null===(e=this._dataSource)||void 0===e?void 0:e.slides)||[])[this._slideIdx]||{}}findNode(e){var t,i,n,r,o,l,a;let s=null===(i=null===(t=this._dataSource)||void 0===t?void 0:t.slides)||void 0===i?void 0:i.find(((e,t)=>t==this._slideIdx)),d=null==s?void 0:s.svg,u=(t,i)=>{let n=null==t?void 0:t.find((t=>t.id==e));if(n)return n;let r=0,o=t.length||0;for(;r<o&&!n&&(n=u(t[r].nodes||[],t[r].id),!n);)r++;return n},c=u((null==d?void 0:d.nodes)||[]);return c?(c.style=null!==(n=c.style)&&void 0!==n?n:{},c.source=null!==(r=c.source)&&void 0!==r?r:{},c.animate=null!==(o=c.animate)&&void 0!==o?o:{},c.interactive=null!==(l=c.interactive)&&void 0!==l?l:{},c.variable=null!==(a=c.variable)&&void 0!==a?a:{},c):{id:0,size:{x:0,y:0,width:0,height:0},attribute:{},isfake:!0}}runSlide(e,t,i){var n,o,l,a,s,d,u,c,h,v;let g;if(this.refreshNodeStatus(),this.refreshSlideStatus(),i?(g=null===(o=null===(n=this._dataSource)||void 0===n?void 0:n.slides)||void 0===o?void 0:o.find((e=>e.code==i||e.id==i)),g&&(this._slideIdx=(null===(a=null===(l=this._dataSource)||void 0===l?void 0:l.slides)||void 0===a?void 0:a.indexOf(g))||0)):t?(g=null===(d=null===(s=this._dataSource)||void 0===s?void 0:s.slides)||void 0===d?void 0:d.find((e=>e.id==t)),g&&(this._slideIdx=(null===(c=null===(u=this._dataSource)||void 0===u?void 0:u.slides)||void 0===c?void 0:c.indexOf(g))||0)):(this._slideIdx=Math.min(Math.max(e||0,0),this.slideTotal-1),g=this.slide),g){Re(nn.container,nn.svg,g,!0),null===(h=jQuery(nn.svg).find("#"+r.BACKGROUND_GROUP))||void 0===h||h.empty();let e=We(r.BACKGROUND_GROUP,"g",void 0,nn.svg);tt(e,g),(e=>{var t,i,n,r,o;e.test&&(e.test.answer=void 0);let l=Be.nodeStatus,a=Be.slideStatus;null===(t=e.svg)||void 0===t||t.nodes.forEach((e=>{e.pid=Math.ceil(1e9*Math.random()),ue(e.pid)}));let s=null===(n=null===(i=e.svg)||void 0===i?void 0:i.nodes)||void 0===n?void 0:n.map((e=>{var t;return null!==(t=e.idx)&&void 0!==t?t:0})).filter(((e,t,i)=>i.indexOf(e)==t)).sort(((e,t)=>(null!=e?e:0)-(null!=t?t:0)));Ce(null!==(o=null===(r=e.svg)||void 0===r?void 0:r.nodes)&&void 0!==o?o:[],null!=s?s:[],{slide:e,nodeStatus:l,slideStatus:a})})(g)}this.changeSlide(this.slides,null===(v=this.slide)||void 0===v?void 0:v.id,this.slideIdx,this.slides.length,g)}set onChangeSlide(e){this._fnChangeSlides.push(e)}changeSlide(e,t,i,n,r){this._fnChangeSlides.forEach((o=>o(e,t,i,n,r)))}},Re=(e,t,i,n)=>{var r,o,l,a,s;let d=window.document.querySelector(t);d||(d=document.createElementNS("http://www.w3.org/2000/svg","svg"),null===(r=window.document.querySelector(e))||void 0===r||r.appendChild(d)),n&&(d.textContent=null);let{x:u,y:c,width:h,height:v}=null!==(l=null===(o=null==i?void 0:i.svg)||void 0===o?void 0:o.viewBox)&&void 0!==l?l:nn.screen.frameSize;d.setAttributeNS(null,"viewBox",u+" "+c+" "+h+" "+v),d.setAttribute("id",t.replace("#",""));var g,p,y=null!==(a=jQuery(e).width())&&void 0!==a?a:1080,f=null!==(s=jQuery(e).height())&&void 0!==s?s:1080,m=h/v;m>=y/f?p=(g=y)/m:g=(p=f)*m,d.setAttributeNS(null,"width",g.toString()),d.setAttributeNS(null,"height",p.toString())};class Me{constructor(e,t){var i;let n=window.document.querySelector(t);n||(n=window.document.createElementNS("http://www.w3.org/2000/svg","svg"),null===(i=window.document.querySelector(e))||void 0===i||i.appendChild(n));let{svgViewBox:r,svgSize:o}=nn.screen.init();n.setAttributeNS(null,"viewBox",`${r.x} ${r.y} ${r.width} ${r.height}`),n.setAttribute("id",t.replace("#","")),n.style.display="block",n.style.width=`${o.width}px`,n.style.height=`${o.height}px`,n.style.backgroundColor="#fafafa",n.style.cursor="default"}}const Le=e=>{jQuery(nn.target).find("#"+r.BACKGROUND_GROUP).empty();let t=We(r.BACKGROUND_GROUP,"g",void 0,nn.target);tt(t,e),(()=>{let t=window.document.getElementById(null==e?void 0:e.id);jQuery(t).find("#"+r.BACKGROUND_GROUP).empty();let i=We(r.BACKGROUND_GROUP,"g",void 0,t);tt(i,e)})()},Pe=()=>{let e=nn.screen.svgViewBox,t=nn.screen.svgSize;nn.target&&(nn.target.setAttributeNS(null,"viewBox",`${e.x} ${e.y} ${e.width} ${e.height}`),nn.target.style.left=`${t.x}px`,nn.target.style.top=`${t.y}px`,nn.target.style.width=`${t.width}px`,nn.target.style.height=`${t.height}px`)},Fe=()=>{jQuery(nn.target).find(">*:not(defs)").remove()},Ke=(e,t,i,n,r)=>{let o;if(!i)switch(t){case a.GROUP:i="g";break;case a.CIRCLE:i="circle";break;case a.ELLIPSE:i="ellipse";break;case a.LINE:i="line";break;case a.RECT:i="rect";break;case a.POLYGON:i="polygon";break;case a.POLYLINE:i="polyline";break;case a.PATH:i="path";break;case a.FOREIGNOBJECT:i="foreignObject";break;case a.IMAGE:i="image";break;case a.TEXT:i="text";break;case a.TSPAN:i="tspan"}if(t&&(null==n?void 0:n.size)&&(null==n?void 0:n.attribute)&&Object.assign(n.attribute,ie(t,n.size,n.attribute)),e)if(o=jQuery(r||nn.target).find("#"+e).get(0),o){if(o.nodeName!=i){let n=window.document.createElementNS("http://www.w3.org/2000/svg",i);n.setAttribute("id",e),t==a.FOREIGNOBJECT&&n.setAttribute("xmlns:html","http://www.w3.org/1999/xhtml"),jQuery(o).replaceWith(n),o=n}}else o=window.document.createElementNS("http://www.w3.org/2000/svg",i),o.setAttribute("id",e),t==a.FOREIGNOBJECT&&o.setAttribute("xmlns:html","http://www.w3.org/1999/xhtml"),jQuery(o).appendTo(r||nn.target);else o=window.document.createElementNS("http://www.w3.org/2000/svg",i),jQuery(o).appendTo(r||nn.target);return(null==n?void 0:n.attribute)&&Ge(o,null==n?void 0:n.attribute),(null==n?void 0:n.style)&&De(o,null==n?void 0:n.style),(null==n?void 0:n.source)&&Qe(o,t,null==n?void 0:n.source,e),o},Ge=(e,t)=>{var i,n,r,o;return jQuery(e).attr((i=Object.assign({},t||{}),null===(n=Object.keys(i))||void 0===n||n.forEach((e=>{var t,n,r,o,l,a,s,d,u,c,h,v,g,p,y,f,m,b,w;switch(e){case"fill":break;case"fillRule":Object.assign(i,{"fill-rule":null!==(t=i.fillRule)&&void 0!==t?t:null,fillRule:null});break;case"stroke":Object.assign(i,{"stroke-width":null!==(n=i.strokeWidth)&&void 0!==n?n:null,strokeWidth:null});break;case"strokeLinecap":Object.assign(i,{"stroke-linecap":null!==(r=i.strokeLinecap)&&void 0!==r?r:null,strokeLinecap:null});break;case"strokeLinejoin":Object.assign(i,{"stroke-linejoin":null!==(o=i.strokeLinejoin)&&void 0!==o?o:null,strokeLinejoin:null});break;case"strokeMiterlimit":Object.assign(i,{"stroke-miterlimit":null!==(l=i.strokeMiterlimit)&&void 0!==l?l:null,strokeMiterlimit:null});break;case"strokeDasharray":Object.assign(i,{"stroke-dasharray":null!==(a=i.strokeDasharray)&&void 0!==a?a:null,strokeDasharray:null});break;case"strokeDasharrays":Object.assign(i,{"stroke-dasharray":null!==(d=null===(s=i.strokeDasharrays)||void 0===s?void 0:s.join(" "))&&void 0!==d?d:null,strokeDasharrays:null});break;case"fontFamily":Object.assign(i,{"font-family":null!==(u=i.fontFamily)&&void 0!==u?u:null,fontFamily:null});break;case"fontWeight":Object.assign(i,{"font-weight":null!==(c=i.fontWeight)&&void 0!==c?c:null,fontWeight:null});break;case"fontStyle":Object.assign(i,{"font-style":null!==(h=i.fontStyle)&&void 0!==h?h:null,fontStyle:null});break;case"fontSize":Object.assign(i,{"font-size":null!==(v=i.fontSize)&&void 0!==v?v:null,fontSize:null});break;case"textLength":Object.assign(i,{textLength:i.textLength?`${i.textLength}px`:null});break;case"letterSpacing":Object.assign(i,{"letter-spacing":null!==(g=i.letterSpacing)&&void 0!==g?g:null,letterSpacing:null});break;case"wordSpacing":Object.assign(i,{"word-spacing":null!==(p=i.wordSpacing)&&void 0!==p?p:null,wordSpacing:null});break;case"alignmentBaseline":Object.assign(i,{"alignment-baseline":null!==(y=i.alignmentBaseline)&&void 0!==y?y:null,alignmentBaseline:null});break;case"dominantBaseline":Object.assign(i,{"dominant-baseline":null!==(f=i.dominantBaseline)&&void 0!==f?f:null,dominantBaseline:null});break;case"textAnchor":Object.assign(i,{"text-anchor":null!==(m=i.textAnchor)&&void 0!==m?m:null,textAnchor:null});break;case"textDecoration":Object.assign(i,{"text-decoration":null!==(b=i.textDecoration)&&void 0!==b?b:null,textDecoration:null});break;case"transformOrigin":Object.assign(i,{"transform-origin":null!==(w=i.transformOrigin)&&void 0!==w?w:null,transformOrigin:null})}})),Object.assign({},null!=i?i:{},{fill:(null==i?void 0:i.fill)?j(i.fill,null!==(r=null==i?void 0:i.fillOpacity)&&void 0!==r?r:1):"rgba(0,0,0,0)",fillOpacity:null,stroke:(null==i?void 0:i.stroke)?j(i.stroke,null!==(o=null==i?void 0:i.strokeOpacity)&&void 0!==o?o:1):"rgba(0,0,0,0)",strokeOpacity:null}))),e},De=(e,t)=>{var i,n;return jQuery(e).css((i=Object.assign({},t||{}),null===(n=Object.keys(i))||void 0===n||n.forEach((e=>{var t,n;switch(e){case"padding":Object.assign(i,{padding:i.padding?`${i.padding}px`:null});break;case"borderWidth":i.borderWidth&&i.borderColor?Object.assign(i,{"border-width":`${i.borderWidth}px`,"border-style":i.borderStyle||"solid","border-color":j(i.borderColor,null!==(t=i.borderOpacity)&&void 0!==t?t:1)}):Object.assign(i,{"border-width":"","border-style":"","border-color":""}),Object.assign(i,{borderWidth:null,borderStyle:null,borderColor:null,borderOpacity:null});break;case"borderRadius":Object.assign(i,{"border-radius":i.borderRadius?`${i.borderRadius}px`:null,borderRadius:null});break;case"backgroundColor":i.backgroundColor?Object.assign(i,{"background-color":j(i.backgroundColor,null!==(n=i.backgroundOpacity)&&void 0!==n?n:1)}):Object.assign(i,{"background-color":""}),Object.assign(i,{backgroundColor:null,backgroundOpacity:null})}})),i)),e},Qe=(e,t,i,n)=>{var r,o,l,s,d,u,c,h,v,g,p,y,f,m,b,w,S,x,k,O,_,N,E,I,z,J,j,$,C,A,B,R,M,L,P,F,K,G,D,Q,U,W,V,H,X,q,Y,Z,ee,te,ie,ne,re,oe,le,ae;switch(t){case a.TEXT:{let t=n==nn.dataSelect.contenteditable_id,a=(null===(r=null==i?void 0:i.text)||void 0===r?void 0:r.textContent)||"Hãy nhập nội dung của bạn!";if(!t&&(null===(o=null==i?void 0:i.text)||void 0===o?void 0:o.variableKeywords)&&(null===(l=null==i?void 0:i.text)||void 0===l?void 0:l.variableKeywords.length)){let e=nn.variable.getKeys();i.text.variableKeywords.forEach((t=>{var i=t.replace(/[^a-zA-Z0-9_]/gm,"");if(e.indexOf(i)>=0){var n=nn.variable.getValue(i);a=a.replace(t,n)}}))}t?jQuery(e).attr("editable",`${t}`).html(`<div contenteditable="${t}" xmlns="http://www.w3.org/1999/xhtml" style="width:100%;min-height:100%;display:block;">${a}</div>`):jQuery(e).attr("editable",`${t}`).text(a);break}case a.TSPAN:jQuery(e).text(null!==(d=null===(s=null==i?void 0:i.text)||void 0===s?void 0:s.textContent)&&void 0!==d?d:"");break;case a.IMAGE:jQuery(e).attr("href",(null===(u=null==i?void 0:i.image)||void 0===u?void 0:u.base64)||((null===(c=null==i?void 0:i.image)||void 0===c?void 0:c.path)?(null===(h=nn.config)||void 0===h?void 0:h.readfileuploadurl)+(null===(v=null==i?void 0:i.image)||void 0===v?void 0:v.path):null===(g=null==i?void 0:i.image)||void 0===g?void 0:g.url)||"");break;case a.FOREIGNOBJECT:switch(null==i?void 0:i.type){case"text":{let t=n==nn.dataSelect.contenteditable_id,r=(null===(p=i.text)||void 0===p?void 0:p.textContent)||"Hãy nhập nội dung của bạn!";if(!t&&(null===(y=i.text)||void 0===y?void 0:y.variableKeywords)&&(null===(f=i.text)||void 0===f?void 0:f.variableKeywords.length)){let e=nn.variable.getKeys();i.text.variableKeywords.forEach((t=>{var i=t.replace(/[^a-zA-Z0-9_]/gm,"");if(e.indexOf(i)>=0){var n=nn.variable.getValue(i);r=r.replace(t,n)}}))}t?jQuery(e).attr("editable",`${t}`).html(`<div contenteditable="${t}" xmlns="http://www.w3.org/1999/xhtml" style="width:100%;min-height:100%;display:block;">${r}</div>`):jQuery(e).attr("editable",`${t}`).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;min-height:100%;display:block;">${r}</div>`);break}case"html":{let t=n==nn.dataSelect.contenteditable_id,r=(null===(m=null==i?void 0:i.html)||void 0===m?void 0:m.htmlContent)||'<span style="font-family: Roboto; font-size: 24px;">Hãy nhập nội dung của bạn!</span>';if(!t&&(null===(b=i.html)||void 0===b?void 0:b.variableKeywords)&&(null===(w=i.html)||void 0===w?void 0:w.variableKeywords.length)){let e=nn.variable.getKeys();i.html.variableKeywords.forEach((t=>{var i=t.replace(/[^a-zA-Z0-9_]/gm,"");if(e.indexOf(i)>=0){var n=nn.variable.getValue(i);r=r.replace(t,n)}}))}jQuery(e).attr("editable",`${t}`).html(`<div contenteditable="${t}" xmlns="http://www.w3.org/1999/xhtml" style="width:100%;min-height:100%;display:block;">${r}</div>`).find("img[path],video[path],iframe[path]").each(((e,t)=>{var i,n;t.setAttribute("src",(null!==(n=null===(i=nn.config)||void 0===i?void 0:i.readfileuploadurl)&&void 0!==n?n:"")+t.getAttribute("path")),t.removeAttribute("path")}));break}case"input":(null===(S=i.input)||void 0===S?void 0:S.input)?jQuery(e).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;"><input type="text" placeholder="${null!==(k=null===(x=i.input)||void 0===x?void 0:x.placeholder)&&void 0!==k?k:""}" maxlength="100" /></div>`):(null===(O=i.input)||void 0===O?void 0:O.textarea)&&jQuery(e).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;"><textarea placeholder="${null!==(N=null===(_=i.input)||void 0===_?void 0:_.placeholder)&&void 0!==N?N:""}" maxlength="1000"></textarea></div>`);break;case"image":jQuery(e).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;"><img src="${(null===(E=i.image)||void 0===E?void 0:E.base64)||((null===(I=i.image)||void 0===I?void 0:I.path)?(null===(z=nn.config)||void 0===z?void 0:z.readfileuploadurl)+(null===(J=i.image)||void 0===J?void 0:J.path):null===(j=i.image)||void 0===j?void 0:j.url)||""}" style="width:100%;height:100%;display:block;"/></div>`);break;case"iframe":jQuery(e).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;"><iframe src="${((null===($=i.iframe)||void 0===$?void 0:$.path)?(null===(C=nn.config)||void 0===C?void 0:C.readfileuploadurl)+(null===(A=i.iframe)||void 0===A?void 0:A.path):null===(B=i.iframe)||void 0===B?void 0:B.url)||""}" frameborder="0" allowfullscreen\n                    webkitallowfullscreen allowtransparency="true" allow="autoplay; fullscreen" style="width:100%;height:100%;display:block;"></iframe></div>`);break;case"embed":{let t=T({readfileuploadurl:null===(R=nn.config)||void 0===R?void 0:R.readfileuploadurl,type:null===(M=i.embed)||void 0===M?void 0:M.type,oss:null===(L=i.embed)||void 0===L?void 0:L.oss,path:null===(P=i.embed)||void 0===P?void 0:P.path,url:null===(F=i.embed)||void 0===F?void 0:F.url});jQuery(e).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;"><iframe src="${t}" frameborder="0" allowfullscreen\n                    webkitallowfullscreen allowtransparency="true" allow="autoplay; fullscreen" style="width:100%;height:100%;display:block;"></iframe></div>`);break}case"svg":jQuery(e).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;">${null!==(G=null===(K=i.svg)||void 0===K?void 0:K.svgContent)&&void 0!==G?G:""}</div>`);break;case"test":{let t=n==nn.dataSelect.contenteditable_id,r=(null===(D=null==i?void 0:i.html)||void 0===D?void 0:D.htmlContent)||"";if(!t&&(null===(Q=i.html)||void 0===Q?void 0:Q.variableKeywords)&&(null===(U=i.html)||void 0===U?void 0:U.variableKeywords.length)){let e=nn.variable.getKeys();i.html.variableKeywords.forEach((t=>{var i=t.replace(/[^a-zA-Z0-9_]/gm,"");if(e.indexOf(i)>=0){var n=nn.variable.getValue(i);r=r.replace(t,n)}}))}switch(null===(W=null==i?void 0:i.test)||void 0===W?void 0:W.type){case"truefalse":t?jQuery(e).attr("editable",`${t}`).html(`<div contenteditable="${t}" xmlns="http://www.w3.org/1999/xhtml" style="width:100%;min-height:100%;display:block;">${r}</div>`):jQuery(e).attr("editable",`${t}`).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test" data-type="${null==i?void 0:i.test.type}" data-correct="${(null===(V=null==i?void 0:i.test.truefalse)||void 0===V?void 0:V.iscorrect)?1:0}"><div style="display:flex;align-items:center;width:100%;height:100%;"><div style="width:100%">${r}</div></div></div>`);break;case"singlechoice":t?jQuery(e).attr("editable",`${t}`).html(`<div contenteditable="${t}" xmlns="http://www.w3.org/1999/xhtml" style="width:100%;min-height:100%;display:block;">${r}</div>`):jQuery(e).attr("editable",`${t}`).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test" data-type="${null==i?void 0:i.test.type}" data-correct="${(null===(H=null==i?void 0:i.test.singlechoice)||void 0===H?void 0:H.iscorrect)?1:0}"><div style="display:flex;align-items:center;width:100%;height:100%;"><div style="width:100%">${r}</div></div></div>`);break;case"multichoice":t?jQuery(e).attr("editable",`${t}`).html(`<div contenteditable="${t}" xmlns="http://www.w3.org/1999/xhtml" style="width:100%;min-height:100%;display:block;">${r}</div>`):jQuery(e).attr("editable",`${t}`).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test" data-type="${null==i?void 0:i.test.type}" data-correct="${(null===(X=null==i?void 0:i.test.multichoice)||void 0===X?void 0:X.iscorrect)?1:0}"><div style="display:flex;align-items:center;width:100%;height:100%;"><div style="width:100%">${r}</div></div></div>`);break;case"matching-empty":jQuery(e).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" class="ondrop-here" data-node="test" data-type="matching" data-type2="matching-empty" data-key="${null===(q=null==i?void 0:i.test.matching)||void 0===q?void 0:q.key}"></div>`);break;case"matching-content":t?jQuery(e).attr("editable",`${t}`).html(`<div contenteditable="${t}" xmlns="http://www.w3.org/1999/xhtml" style="width:100%;min-height:100%;display:block;">${r}</div>`):jQuery(e).attr("editable",`${t}`).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" class="ondrop-here" data-node="test" data-type="matching" data-type2="matching-content" data-key="${null===(Y=null==i?void 0:i.test.matching)||void 0===Y?void 0:Y.key}"><div class="ondrag-item" data-key="${null!==(te=null===(ee=null===(Z=null==i?void 0:i.test)||void 0===Z?void 0:Z.matching)||void 0===ee?void 0:ee.key)&&void 0!==te?te:"MIDDLEKIEN"}"><div style="display:flex;align-items:center;width:100%;height:100%;"><div style="width:100%">${r}</div></div></div></div>`);break;case"fill":t||((null===(ie=i.html)||void 0===ie?void 0:ie.fillKeywords)||[]).forEach((e=>{var t=`<input type="text" maxlength="128" style="display:inline-block;width:100px;min-width:100px;max-width:100%;padding:0px 10px;margin:0px;box-sizing:border-box;outline:none;box-shadow:none;border-width:0px 0px 1px;border-top-style:initial;border-right-style:initial;border-left-style:initial;border-top-color:initial;border-right-color:initial;border-left-color:initial;border-image:initial;border-bottom-style:dashed;border-bottom-color:rgb(123,146,254);background:transparent;animation:0.3s ease-in-out 0s 1 normal none running width;text-align:inherit;" data-key="${e.replace(/[^a-zA-Z0-9]+/gm,"")}"/>`;r=r.replace(new RegExp(e.replace(/\[/g,"\\[").replace(/\]/g,"\\]"),"g"),t)})),t?jQuery(e).attr("editable",`${t}`).html(`<div contenteditable="${t}" xmlns="http://www.w3.org/1999/xhtml" style="width:100%;min-height:100%;display:block;">${r}</div>`):jQuery(e).attr("editable",`${t}`).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test"><div style="display:flex;align-items:center;width:100%;height:100%;"><div style="width:100%">${r}</div></div></div>`);break;case"speech":jQuery(e).html('<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test"><div style="display:flex;align-items:center;width:100%;height:100%;"><img src="images/svg/component/microphone4.svg" width="60" height="60"/></div></div>');break;case"submit":jQuery(e).html(`<div xmlns="http://www.w3.org/1999/xhtml" style="width:100%;height:100%;display:block;" data-node="test"><img src="${null!==(ae=(null===(ne=i.image)||void 0===ne?void 0:ne.path)?(null===(re=nn.config)||void 0===re?void 0:re.readfileuploadurl)+(null===(oe=i.image)||void 0===oe?void 0:oe.path):null===(le=i.image)||void 0===le?void 0:le.url)&&void 0!==ae?ae:""}" style="width:100%;height:100%;display:block;"/></div>`)}jQuery(e).find("img[path],video[path],iframe[path]").each(((e,t)=>{var i,n;t.setAttribute("src",(null!==(n=null===(i=nn.config)||void 0===i?void 0:i.readfileuploadurl)&&void 0!==n?n:"")+t.getAttribute("path")),t.removeAttribute("path")}))}}}},Ue=(e,t)=>(t?jQuery(e).css({filter:"url(#nodeSelected)"}):jQuery(nn.target).find("[style]").css("filter",""),e),We=(e,t,i,n)=>{let r=jQuery(n||nn.target).find("#"+e).get(0);return r||(r=window.document.createElementNS("http://www.w3.org/2000/svg",t),r.setAttribute("id",e),jQuery(r).appendTo(n||nn.target)),jQuery(r).attr((null==i?void 0:i.attribute)||{}),jQuery(r).css((null==i?void 0:i.style)||{}),r},Ve=(e,t)=>{let i=R(2),n={fill:g.fill,stroke:g.stroke,"stroke-width":R(g.strokeWidth)};return[{element:We("icdt-temp-create-rect-center","rect",{attribute:Object.assign({x:t.x-i,y:t.y-i,width:t.width+2*i,height:t.height+2*i},n)},e),posType:"rect-center"}]},He=(e,t)=>{var i,n;let r=[],{size:o}=t,l=R(1),s=R(2),d=R(3);R(5),R(7);let u=R(10),c={stroke:p.stroke,"stroke-width":R(p.strokeWidth),"stroke-linecap":p.strokeLinecap,"stroke-dasharray":p.strokeDasharrays.map((e=>R(e))).join(" ")},h={fill:f.fill,stroke:f.stroke,"stroke-width":R(f.strokeWidth)},v={fill:y.fill,stroke:y.stroke,"stroke-width":R(y.strokeWidth),width:R(y.width),height:R(y.height)},g={fill:y.fill,stroke:y.stroke,"stroke-width":R(y.strokeWidth),width:R(y.width),height:R(y.height)},m=We("icdt-temp-resize-rect-center","rect",{attribute:Object.assign({x:o.x,y:o.y,width:o.width,height:o.height},h),style:{cursor:"move"}},e);if(We("icdt-temp-resize-line-left","line",{attribute:Object.assign({x1:o.x-l,y1:o.y-l,x2:o.x-l,y2:o.y+o.height+l},c)},e),We("icdt-temp-resize-line-top","line",{attribute:Object.assign({x1:o.x-l,y1:o.y-l,x2:o.x+o.width+l,y2:o.y-l},c)},e),We("icdt-temp-resize-line-right","line",{attribute:Object.assign({x1:o.x+o.width+l,y1:o.y-l,x2:o.x+o.width+l,y2:o.y+o.height+l},c)},e),We("icdt-temp-resize-line-bottom","line",{attribute:Object.assign({x1:o.x-l,y1:o.y+o.height+l,x2:o.x+o.width+l,y2:o.y+o.height+l},c)},e),t.type==a.LINE){let{size:n}=t,o=[];return null===(i=n.ratios)||void 0===i||i.forEach((function(e){o.push([n.x+n.width*e[0],n.y+n.height*e[1]])})),o.forEach(((t,i)=>{r.push({posType:`point-${i}`,element:We(`icdt-temp-resize-point-${i+1}`,"circle",{attribute:Object.assign(ie(a.CIRCLE,{x:t[0]-s-l,y:t[1]-s-l,width:g.width,height:g.height},{}),g)},e)})})),r.concat([{element:m,posType:"rect-center"}])}if(t.type==a.POLYGON){let{size:i}=t,o=[];null===(n=i.ratios)||void 0===n||n.forEach((function(e){o.push([i.x+i.width*e[0],i.y+i.height*e[1]])})),o.forEach(((t,i)=>{r.push({posType:`point-${i}`,element:We(`icdt-temp-resize-point-${i+1}`,"circle",{attribute:Object.assign(ie(a.CIRCLE,{x:t[0]-s-l,y:t[1]-s-l,width:g.width,height:g.height},{}),g)},e)})}))}let b=We("icdt-temp-resize-rect-top-left","rect",{attribute:Object.assign({x:o.x-u,y:o.y-u},v),style:{cursor:"nw-resize"}},e),w=We("icdt-temp-resize-rect-top-right","rect",{attribute:Object.assign({x:o.x+o.width+d,y:o.y-u},v),style:{cursor:"ne-resize"}},e),S=We("icdt-temp-resize-rect-bottom-left","rect",{attribute:Object.assign({x:o.x-u,y:o.y+o.height+d},v),style:{cursor:"sw-resize"}},e),x=We("icdt-temp-resize-rect-bottom-right","rect",{attribute:Object.assign({x:o.x+o.width+d,y:o.y+o.height+d},v),style:{cursor:"se-resize"}},e),k=We("icdt-temp-resize-rect-left","rect",{attribute:Object.assign({x:o.x-u,y:o.y+o.height/2-s-l},v),style:{cursor:"w-resize"}},e),O=We("icdt-temp-resize-rect-top","rect",{attribute:Object.assign({x:o.x+o.width/2-s-l,y:o.y-u},v),style:{cursor:"n-resize"}},e),_=We("icdt-temp-resize-rect-right","rect",{attribute:Object.assign({x:o.x+o.width+d,y:o.y+o.height/2-s-l},v),style:{cursor:"e-resize"}},e),N=We("icdt-temp-resize-rect-bottom","rect",{attribute:Object.assign({x:o.x+o.width/2-s-l,y:o.y+o.height+d},v),style:{cursor:"s-resize"}},e);return r.concat([{element:m,posType:"rect-center"},{element:b,posType:"rect-top-left"},{element:w,posType:"rect-top-right"},{element:S,posType:"rect-bottom-left"},{element:x,posType:"rect-bottom-right"},{element:k,posType:"rect-left"},{element:O,posType:"rect-top"},{element:_,posType:"rect-right"},{element:N,posType:"rect-bottom"}])},Xe=(e,t,i)=>{let n=R(1),r=R(2),o=R(5),l={stroke:p.stroke,"stroke-width":R(p.strokeWidth),"stroke-linecap":p.strokeLinecap},a={fill:f.fill,stroke:f.stroke,"stroke-width":R(f.strokeWidth)},s={fill:y.fill,stroke:y.stroke,"stroke-width":R(y.strokeWidth),width:R(y.width),height:R(y.height)},d={fill:b.fill,rx:R(b.rx)},u={fill:w.fill,"alignment-baseline":w.alignmentBaseline,"text-anchor":w.textAnchor,"font-size":R(w.fontSize)},c={fill:m.fill,stroke:m.stroke,"stroke-width":R(m.strokeWidth)};We("icdt-temp-resize-line-left","line",{attribute:Object.assign({x1:i.x-n,y1:i.y-n,x2:i.x-n,y2:i.y+i.height+n},l)},e),We("icdt-temp-resize-line-top","line",{attribute:Object.assign({x1:i.x-n,y1:i.y-n,x2:i.x+i.width+n,y2:i.y-n},l)},e),We("icdt-temp-resize-line-right","line",{attribute:Object.assign({x1:i.x+i.width+n,y1:i.y-n,x2:i.x+i.width+n,y2:i.y+i.height+n},l)},e),We("icdt-temp-resize-line-bottom","line",{attribute:Object.assign({x1:i.x-n,y1:i.y+i.height+n,x2:i.x+i.width+n,y2:i.y+i.height+n},l)},e);let h=We("icdt-temp-resize-rect-center","rect",{attribute:Object.assign({x:i.x,y:i.y,width:i.width,height:i.height},a)},e),v=`${i.width} x ${i.height}`,g=8*v.length;return We("icdt-temp-select-rect-text","rect",{attribute:Object.assign({x:i.x+i.width/2-R(g/2),y:i.y+i.height+R(10),width:R(g),height:R(20)},d)},e),We("icdt-temp-select-text","text",{attribute:Object.assign({x:i.x+i.width/2,y:i.y+i.height+R(20)},u)},e).textContent=v,t.length>1&&t.forEach((t=>{let{size:i}=t;We("icdt-temp-select-rect-node-"+t.id,"rect",{attribute:Object.assign({x:i.x,y:i.y,width:i.width,height:i.height},c)},e)})),[{element:h,posType:"rect-center"},{element:We("icdt-temp-resize-rect-top-left","rect",{attribute:Object.assign({x:i.x-o,y:i.y-o},s),style:{cursor:"nw-resize"}},e),posType:"rect-top-left"},{element:We("icdt-temp-resize-rect-top-right","rect",{attribute:Object.assign({x:i.x+i.width-r,y:i.y-o},s),style:{cursor:"ne-resize"}},e),posType:"rect-top-right"},{element:We("icdt-temp-resize-rect-bottom-left","rect",{attribute:Object.assign({x:i.x-o,y:i.y+i.height-r},s),style:{cursor:"sw-resize"}},e),posType:"rect-bottom-left"},{element:We("icdt-temp-resize-rect-bottom-right","rect",{attribute:Object.assign({x:i.x+i.width-r,y:i.y+i.height-r},s),style:{cursor:"se-resize"}},e),posType:"rect-bottom-right"},{element:We("icdt-temp-resize-rect-left","rect",{attribute:Object.assign({x:i.x-o,y:i.y+i.height/2-r-n},s),style:{cursor:"w-resize"}},e),posType:"rect-left"},{element:We("icdt-temp-resize-rect-top","rect",{attribute:Object.assign({x:i.x+i.width/2-r-n,y:i.y-o},s),style:{cursor:"n-resize"}},e),posType:"rect-top"},{element:We("icdt-temp-resize-rect-right","rect",{attribute:Object.assign({x:i.x+i.width-r,y:i.y+i.height/2-r-n},s),style:{cursor:"e-resize"}},e),posType:"rect-right"},{element:We("icdt-temp-resize-rect-bottom","rect",{attribute:Object.assign({x:i.x+i.width/2-r-n,y:i.y+i.height-r},s),style:{cursor:"s-resize"}},e),posType:"rect-bottom"}]},qe=(e,t,i)=>{let n=R(1),r={stroke:p.stroke,"stroke-width":R(p.strokeWidth),"stroke-linecap":p.strokeLinecap},o={fill:f.fill,stroke:f.stroke,"stroke-width":R(f.strokeWidth)},l={fill:m.fill,stroke:m.stroke,"stroke-width":R(m.strokeWidth)};We("icdt-temp-select-line-left","line",{attribute:Object.assign({x1:i.x-n,y1:i.y,x2:i.x-n,y2:i.y+i.height},r)},e),We("icdt-temp-select-line-top","line",{attribute:Object.assign({x1:i.x,y1:i.y-n,x2:i.x+i.width,y2:i.y-n},r)},e),We("icdt-temp-select-line-right","line",{attribute:Object.assign({x1:i.x+i.width+n,y1:i.y,x2:i.x+i.width+n,y2:i.y+i.height},r)},e),We("icdt-temp-select-line-bottom","line",{attribute:Object.assign({x1:i.x,y1:i.y+i.height+n,x2:i.x+i.width,y2:i.y+i.height+n},r)},e);let a=We("icdt-temp-select-rect-center","rect",{attribute:Object.assign({x:i.x,y:i.y,width:i.width,height:i.height},o)},e);return t.forEach((t=>{let{size:i}=t;We("icdt-temp-select-rect-node-"+t.id,"rect",{attribute:Object.assign({x:i.x,y:i.y,width:i.width,height:i.height},l)},e)})),[{element:a,posType:"rect-center"}]},Ye=(e,t)=>{let i=R(1),n={stroke:p.stroke,"stroke-width":R(p.strokeWidth),"stroke-linecap":p.strokeLinecap},r={fill:f.fill,stroke:f.stroke,"stroke-width":R(f.strokeWidth)};return We("icdt-temp-scan-line-left","line",{attribute:Object.assign({x1:t.x-i,y1:t.y,x2:t.x-i,y2:t.y+t.height},n)},e),We("icdt-temp-scan-line-top","line",{attribute:Object.assign({x1:t.x,y1:t.y-i,x2:t.x+t.width,y2:t.y-i},n)},e),We("icdt-temp-scan-line-right","line",{attribute:Object.assign({x1:t.x+t.width+i,y1:t.y,x2:t.x+t.width+i,y2:t.y+t.height},n)},e),We("icdt-temp-scan-line-bottom","line",{attribute:Object.assign({x1:t.x,y1:t.y+t.height+i,x2:t.x+t.width,y2:t.y+t.height+i},n)},e),[{element:We("icdt-temp-scan-rect-center","rect",{attribute:Object.assign({x:t.x,y:t.y,width:t.width,height:t.height},r)},e),posType:"rect-center"}]},Ze=(e,t)=>{R(-1),S.stroke,R(S.strokeWidth),S.strokeLinecap,R(S.strokeDasharray);let i={fill:x.fill};return We("icdt-temp-interactive-rect-center","rect",{attribute:Object.assign({x:t.x,y:t.y,width:t.width,height:t.height,class:"cursor-draw"},i)},e),[]},et=(e,t)=>{let i={fill:k.fill,stroke:k.stroke,"stroke-width":R(k.strokeWidth),"stroke-dasharray":R(k.strokeDasharray)};jQuery(e).empty(),t.forEach((n=>{var r,o;let{size:l}=n;if(!n.idx)return;We("icdt-temp-index-rect-node-"+n.id,"rect",{attribute:Object.assign({x:l.x-5,y:l.y-5,width:l.width+10,height:l.height+10},i)},e);let{element:a}=Je(Math.ceil(1e9*Math.random()),{size:{x:l.x-76,y:l.y-6,width:70,height:80},attribute:{},style:{},source:{type:"html",html:{htmlContent:`<div class="position-slide" style="position:relative;width:100%;height:100%;">\n                  <div style="position:absolute;top:0;right:0;line-height:22px;">\n                    <div title="Thứ tự xuất hiện">\n                        <div style="float:right;">\n                          <span style="display:block;width:18px;float:left;text-align:center;">\n                            <i class="fa fa-play" style="margin:6px 0;color:#7da7d9;font-size:12px;"></i>\n                          </span>\n                          <span style="display:block;width:50px;float:left;">\n                            <input type="number" name="idx" value="${null!==(r=n.idx)&&void 0!==r?r:0}" min="0" max="999" step="1" style="box-sizing:border-box;width:100%;padding:0;border:1px solid #ddd;outline:0;text-align:center;background:#eee;background: radial-gradient(#fff, #eee);font-size:12px;">\n                          </span>\n                        </div>\n                        <div style="clear:both;"></div>\n                    </div>\n                    <div title="Thời gian đợi(s), nếu giá trị = 0 sẽ chuyển sang đợi hoàn tất hoạt động và âm thanh" style="margin-top:2px;">\n                        <div style="float:right;">\n                          <span style="display:block;width:18px;float:left;text-align:center;">\n                            <i class="fa fa-clock-o" style="margin:5px 0;color:#7da7d9;font-size:14px;"></i>\n                          </span>\n                          <span style="display:block;width:50px;float:left;">\n                            <input type="number" name="time" value="${null!==(o=n.time)&&void 0!==o?o:0}" min="0" max="999" step="0.5" style="box-sizing:border-box;width:100%;padding:0;border:1px solid #ddd;outline:0;text-align:center;background:#eee;background: radial-gradient(#fff, #eee);font-size:12px;">\n                          </span>\n                        </div>\n                        <div style="clear:both;"></div>\n                    </div>\n                    <div title="Hủy thiết lập" style="margin-top:2px;">\n                        <div style="float:right;">\n                          <button name="remove" style="box-sizing:border-box;width:24px;height:24px;padding:0;border:1px solid #ddd;line-height: 0;outline:none;background:#eee;background: radial-gradient(#fff, #eee);">\n                            <img src="assets/icon-png/xoa2.png" height="18">\n                          </button>\n                        </div>\n                        <div style="clear:both;"></div>\n                    </div>\n                  </div>\n              </div>`}}},e);a.classList.add("node-input"),jQuery(a).on("change",'input[name="idx"]',(e=>{var t;n.idx=parseInt(null!==(t=e.target.value)&&void 0!==t?t:"0")})).on("change",'input[name="time"]',(e=>{var t;n.time=parseFloat(null!==(t=e.target.value)&&void 0!==t?t:"0")})).on("click",'button[name="remove"]',(i=>{n.idx=0,n.time=null,et(e,t)}))}))},tt=(e,t)=>{var i,n,r,o,l,a;let{color:s,opacity:d,path:u,url:c,base64:h}=null!==(n=null===(i=null==t?void 0:t.svg)||void 0===i?void 0:i.background)&&void 0!==n?n:{},{x:v,y:g,width:p,height:y}=null!==(o=null===(r=null==t?void 0:t.svg)||void 0===r?void 0:r.viewBox)&&void 0!==o?o:{x:0,y:0,width:0,height:0};de(void 0,{size:{x:0,y:R(-10),width:100,height:20},attribute:{fill:"#999",textAnchor:"start",alignmentBaseline:"central",fontSize:R(12),class:"hide-on-viewer"},source:{type:"text",text:{textContent:null!==(a=null!==(l=null==t?void 0:t.name)&&void 0!==l?l:null==t?void 0:t.code)&&void 0!==a?a:void 0}}},e),M(void 0,{size:{x:v,y:g,width:p,height:y},attribute:{fill:"#fff",stroke:"#999",strokeWidth:R(1),strokeDasharray:R(10),class:"hide-on-viewer"}},e),s&&M(void 0,{size:{x:v,y:g,width:p,height:y},attribute:{fill:s,fillOpacity:d}},e),u&&L(void 0,{size:{x:v,y:g,width:p,height:y},source:{type:"image",image:{path:u,url:c,base64:h}}},e)},it=(e,t,i)=>{var n,r,o,l,a,s,d,u,c,h,v,g,p,y,f,m,b,w,S,x,k,O,_,N,E,I,z,J,j,T,$,C,A,B,R,L,F,K,G;switch(jQuery(e).empty(),null===(n=t.test)||void 0===n?void 0:n.type){case"truefalse":if(null===(r=t.test)||void 0===r?void 0:r.showselection){let i=null===(a=null===(l=null===(o=null==t?void 0:t.test)||void 0===o?void 0:o.answer)||void 0===l?void 0:l.truefalse)||void 0===a?void 0:a.value;null===(s=t.svg)||void 0===s||s.nodes.filter((e=>{var t,n;return"truefalse"==(null===(n=null===(t=e.source)||void 0===t?void 0:t.test)||void 0===n?void 0:n.type)&&e.id!=i})).forEach((t=>{var i;let{x:n,y:r,width:o,height:l}=null!==(i=null==t?void 0:t.size)&&void 0!==i?i:{x:0,y:0,width:0,height:0};P(Math.ceil(1e9*Math.random()),{size:{x:n-.5,y:r-.5,width:o+1,height:l+1},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:1,strokeDasharray:4}},e)})),(null===(u=null===(d=null==t?void 0:t.test)||void 0===d?void 0:d.answer)||void 0===u?void 0:u.truefalse)&&i&&(()=>{var t;let n=Be.findNode(i),{x:r,y:o,width:l,height:a}=null!==(t=null==n?void 0:n.size)&&void 0!==t?t:{x:0,y:0,width:0,height:0};P(Math.ceil(1e9*Math.random()),{size:{x:r-2,y:o-2,width:l+4,height:a+4},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:4}},e)})()}break;case"singlechoice":if(null===(c=t.test)||void 0===c?void 0:c.showselection){let i=null===(g=null===(v=null===(h=null==t?void 0:t.test)||void 0===h?void 0:h.answer)||void 0===v?void 0:v.singlechoice)||void 0===g?void 0:g.value;null===(p=t.svg)||void 0===p||p.nodes.filter((e=>{var t,n;return"singlechoice"==(null===(n=null===(t=e.source)||void 0===t?void 0:t.test)||void 0===n?void 0:n.type)&&e.id!=i})).forEach((t=>{var i;let{x:n,y:r,width:o,height:l}=null!==(i=null==t?void 0:t.size)&&void 0!==i?i:{x:0,y:0,width:0,height:0};P(Math.ceil(1e9*Math.random()),{size:{x:n-.5,y:r-.5,width:o+1,height:l+1},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:1,strokeDasharray:4}},e)})),(null===(f=null===(y=null==t?void 0:t.test)||void 0===y?void 0:y.answer)||void 0===f?void 0:f.singlechoice)&&i&&(()=>{var t;let n=Be.findNode(i),{x:r,y:o,width:l,height:a}=null!==(t=null==n?void 0:n.size)&&void 0!==t?t:{x:0,y:0,width:0,height:0};P(Math.ceil(1e9*Math.random()),{size:{x:r-2,y:o-2,width:l+4,height:a+4},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:4}},e)})()}break;case"multichoice":if(null===(m=t.test)||void 0===m?void 0:m.showselection){let i=null!==(x=null===(S=null===(w=null===(b=null==t?void 0:t.test)||void 0===b?void 0:b.answer)||void 0===w?void 0:w.multichoice)||void 0===S?void 0:S.map((e=>e.value)))&&void 0!==x?x:[];null===(k=t.svg)||void 0===k||k.nodes.filter((e=>{var t,n;return"multichoice"==(null===(n=null===(t=e.source)||void 0===t?void 0:t.test)||void 0===n?void 0:n.type)&&!i.includes(e.id)})).forEach((t=>{var i;let{x:n,y:r,width:o,height:l}=null!==(i=null==t?void 0:t.size)&&void 0!==i?i:{x:0,y:0,width:0,height:0};M(Math.ceil(1e9*Math.random()),{size:{x:n-.5,y:r-.5,width:o+1,height:l+1},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:1,strokeDasharray:4}},e)})),(null===(_=null===(O=null==t?void 0:t.test)||void 0===O?void 0:O.answer)||void 0===_?void 0:_.multichoice)&&i.length&&(null===(E=null===(N=null==t?void 0:t.test)||void 0===N?void 0:N.answer)||void 0===E||E.multichoice.forEach((t=>{var i;let n=Be.findNode(t.value),{x:r,y:o,width:l,height:a}=null!==(i=null==n?void 0:n.size)&&void 0!==i?i:{x:0,y:0,width:0,height:0};M(Math.ceil(1e9*Math.random()),{size:{x:r-2,y:o-2,width:l+4,height:a+4},attribute:{fill:"none",stroke:"#5F6CE1",strokeWidth:4}},e)})))}break;case"fill":(null===(z=null===(I=null==t?void 0:t.test)||void 0===I?void 0:I.answer)||void 0===z?void 0:z.fill)&&(null===(j=null===(J=null==t?void 0:t.test)||void 0===J?void 0:J.answer)||void 0===j||j.fill.forEach((e=>{jQuery("#"+i.id).find(`input[type="text"][data-key="${e.key}"]`).val(e.value)})));break;case"matching":(null===($=null===(T=null==t?void 0:t.test)||void 0===T?void 0:T.answer)||void 0===$?void 0:$.matching)&&("matching-empty"==(null===(A=null===(C=i.source)||void 0===C?void 0:C.test)||void 0===A?void 0:A.type)?null===(R=null===(B=null==t?void 0:t.test)||void 0===B?void 0:B.answer)||void 0===R||R.matching.filter((e=>{var t,n,r;return e.key==(null===(r=null===(n=null===(t=i.source)||void 0===t?void 0:t.test)||void 0===n?void 0:n.matching)||void 0===r?void 0:r.key)})).forEach((e=>{})):"matching-content"==(null===(F=null===(L=i.source)||void 0===L?void 0:L.test)||void 0===F?void 0:F.type)&&(null===(G=null===(K=null==t?void 0:t.test)||void 0===K?void 0:K.answer)||void 0===G||G.matching.filter((e=>{var t,n,r;return e.value==(null===(r=null===(n=null===(t=i.source)||void 0===t?void 0:t.test)||void 0===n?void 0:n.matching)||void 0===r?void 0:r.key)})).forEach((e=>{}))))}};class nt{constructor(e){this._points=[],this._options=e}start(e){this._points.length=0,this._points.push([e.x,e.y]),this._options.start(e)}move(e,t){this._points.push([e.x,e.y]),this._options.move(e,this._points,t)}end(){this._options.end(this.offsetLast,this._points)}get offsetFirst(){return this._points.length>=1?{x:(e=this._points[0])[0],y:e[1]}:{x:0,y:0};var e}get offsetLast(){return this._points.length>=1?{x:(e=this._points[this._points.length-1])[0],y:e[1]}:{x:0,y:0};var e}}const rt=(e,t,i,n)=>(e.x-=n.x,e.y-=n.y,e.x/=t,e.y/=t,e.x-=i.x,e.y-=i.y,e.x=B(e.x),e.y=B(e.y),e),ot=(e,t,i,n,r)=>{var l,a,s;let d=null,u=0,c=0;e.mouseEvent?(d=e.mouseEvent.target,u=e.mouseEvent.offsetX,c=e.mouseEvent.offsetY):e.touchEvent&&(d=e.touchEvent.target,e.touchEvent.touches.length&&(u=e.touchEvent.touches[0].clientX,c=e.touchEvent.touches[0].clientY));let h=null!=i?i:nn.screen.scale,v=null!=n?n:nn.screen.dislocation,g=null!=r?r:nn.screen.offset,p=()=>{};var y=new nt({start:null!==(l=null==t?void 0:t.start)&&void 0!==l?l:p,move:null!==(a=null==t?void 0:t.move)&&void 0!==a?a:p,end:null!==(s=null==t?void 0:t.end)&&void 0!==s?s:p});e.mouseEvent?y.start(rt({x:u,y:c},h,v,{x:0,y:0})):e.touchEvent&&y.start(rt({x:u,y:c},h,v,g));let f=e=>{y.move(rt({x:e.clientX,y:e.clientY},h,v,g),{ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,altKey:e.altKey})},m=e=>{y.end(),[o.SHAPE,o.FOREIGNOBJECT,o.IMAGE,o.TEXT].includes(nn.pointer.pointer_type)&&(e.shiftKey||(nn.pointer.pointer_type=o.POINTER))},b=e=>{e.touches.length&&f({clientX:e.touches[0].clientX,clientY:e.touches[0].clientY,ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,altKey:e.altKey})},w=e=>{m({ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,altKey:e.altKey}),window.removeEventListener("touchmove",b,!1),window.removeEventListener("touchend",w,!1)},S=e=>{0==e.button&&f({clientX:e.clientX,clientY:e.clientY,ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,altKey:e.altKey})},x=e=>{0==e.button&&(m({shiftKey:e.shiftKey,ctrlKey:e.ctrlKey,altKey:e.altKey}),window.removeEventListener("mousemove",S,!1),window.removeEventListener("mouseup",x,!1))};e.mouseEvent?(window.addEventListener("mousemove",S,!1),window.addEventListener("mouseup",x,!1)):e.touchEvent&&(window.addEventListener("touchmove",b,!1),window.addEventListener("touchend",w,!1),null==d||d.addEventListener("touchmove",(function(e){e.preventDefault()})))},lt=(e,t,i,n,r)=>{let{x:o,y:l,width:a,height:s}=i;0==a&&(a=1),0==s&&(s=1);let d=n.map((e=>Object.assign({},e.size))),u=[],c=!1,h={start:e=>{n.forEach((e=>{let{id:t,size:i,attribute:n}=e;u.push({id:t,type:"size",from:JSON.parse(JSON.stringify({id:t,size:i,attribute:n}))})}))},move:(e,u,h)=>{((e,u,c,h,v)=>{let g=c-e,p=h-u;(()=>{let y,f=(a||1)/(s||1);switch(t){case"rect-center":y=(null==v?void 0:v.shiftKey)?Math.abs(c-e)>=Math.abs(h-u)?{x:o+c-e,y:l,width:a,height:s}:{x:o,y:l+h-u,width:a,height:s}:{x:o+c-e,y:l+h-u,width:a,height:s};break;case"rect-top-left":y=(null==v?void 0:v.shiftKey)&&(null==v?void 0:v.altKey)?f>=1?{x:o+(c-e),y:l+(c-e)/f,width:a-2*(c-e),height:s-2*(c-e)/f}:{x:o+(h-u)*f,y:l+(h-u),width:a-2*(h-u)*f,height:s-2*(h-u)}:(null==v?void 0:v.shiftKey)?f>=1?{x:o+(c-e),y:l+(c-e)/f,width:a-(c-e),height:s-(c-e)/f}:{x:o+(h-u)*f,y:l+(h-u),width:a-(h-u)*f,height:s-(h-u)}:(null==v?void 0:v.altKey)?{x:o+(c-e),y:l+(h-u),width:a-2*(c-e),height:s-2*(h-u)}:{x:o+(c-e),y:l+(h-u),width:a-(c-e),height:s-(h-u)};break;case"rect-top-right":y=(null==v?void 0:v.shiftKey)&&(null==v?void 0:v.altKey)?f>=1?{x:o-(c-e),y:l-(c-e)/f,width:a+2*(c-e),height:s+2*(c-e)/f}:{x:o+(h-u)*f,y:l+(h-u),width:a-2*(h-u)*f,height:s-2*(h-u)}:(null==v?void 0:v.shiftKey)?f>=1?{x:o,y:l-(c-e)/f,width:a+(c-e),height:s+(c-e)/f}:{x:o,y:l+(h-u),width:a-(h-u)*f,height:s-(h-u)}:(null==v?void 0:v.altKey)?{x:o-(c-e),y:l+(h-u),width:a+2*(c-e),height:s-2*(h-u)}:{x:o,y:l+(h-u),width:a+(c-e),height:s-(h-u)};break;case"rect-bottom-left":y=(null==v?void 0:v.shiftKey)&&(null==v?void 0:v.altKey)?f>=1?{x:o+(c-e),y:l+(c-e)/f,width:a-2*(c-e),height:s-2*(c-e)/f}:{x:o-(h-u)*f,y:l-(h-u),width:a+2*(h-u)*f,height:s+2*(h-u)}:(null==v?void 0:v.shiftKey)?f>=1?{x:o+(c-e),y:l,width:a-(c-e),height:s-(c-e)/f}:{x:o-(h-u)*f,y:l,width:a+(h-u)*f,height:s+(h-u)}:(null==v?void 0:v.altKey)?{x:o+(c-e),y:l-(h-u),width:a-2*(c-e),height:s+2*(h-u)}:{x:o+(c-e),y:l,width:a-(c-e),height:s+(h-u)};break;case"rect-bottom-right":y=(null==v?void 0:v.shiftKey)&&(null==v?void 0:v.altKey)?f>=1?{x:o-(c-e),y:l-(c-e)/f,width:a+2*(c-e),height:s+2*(c-e)/f}:{x:o-(h-u)*f,y:l-(h-u),width:a+2*(h-u)*f,height:s+2*(h-u)}:(null==v?void 0:v.shiftKey)?f>=1?{x:o,y:l,width:a+(c-e),height:s+(c-e)/f}:{x:o,y:l,width:a+(h-u)*f,height:s+(h-u)}:(null==v?void 0:v.altKey)?{x:o-(c-e),y:l-(h-u),width:a+2*(c-e),height:s+2*(h-u)}:{x:o,y:l,width:a+(c-e),height:s+(h-u)};break;case"rect-top":y=(null==v?void 0:v.shiftKey)?{x:o+p/2*f,y:l+p,width:a-p*f,height:s-p}:(null==v?void 0:v.altKey)?{x:o,y:l+p,width:a,height:s-2*p}:{x:o,y:l+p,width:a,height:s-p};break;case"rect-bottom":y=(null==v?void 0:v.shiftKey)?{x:o-p/2*f,y:l,width:a+p*f,height:s+p}:(null==v?void 0:v.altKey)?{x:o,y:l-p,width:a,height:s+2*p}:{x:o,y:l,width:a,height:s+p};break;case"rect-left":y=(null==v?void 0:v.shiftKey)?{x:o+g,y:l+g/2/f,width:a-g,height:s-g/f}:(null==v?void 0:v.altKey)?{x:o+g,y:l,width:a-2*g,height:s}:{x:o+g,y:l,width:a-g,height:s};break;case"rect-right":y=(null==v?void 0:v.shiftKey)?{x:o,y:l-g/2/f,width:a+g,height:s+g/f}:(null==v?void 0:v.altKey)?{x:o-g,y:l,width:a+2*g,height:s}:{x:o,y:l,width:a+g,height:s};break;default:y={x:o+c-e,y:l+h-u,width:a,height:s}}y.width<=0&&(y.width=1),y.height<=0&&(y.height=1),y.x=B(y.x,1),y.y=B(y.y,1),y.width=B(y.width,1),y.height=B(y.height,1),Object.assign(i,y),Xe(r,n,y),(()=>{let e=o-y.x,t=l-y.y,i=(y.width-a)/a,r=(y.height-s)/s;n.forEach(((n,a)=>{let s=d[a],u=o-s.x,c=l-s.y,h={x:B(s.x-(e+u*i),100),y:B(s.y-(t+c*r),100),width:B(s.width+s.width*i,100),height:B(s.height+s.height*r,100)},{id:v,type:g,size:p,attribute:y}=n;Object.assign(p,h),Object.assign(y,ie(g,p,y)),Ge(window.document.getElementById(v),y)}))})()})()})(u[0][0],u[0][1],e.x,e.y,h),c=!0},end:(e,t)=>{c&&(n.forEach((e=>{let{id:t,size:i,attribute:n}=e,r=u.find((e=>e.id==t));r&&(r.to=JSON.parse(JSON.stringify({id:t,size:i,attribute:n})))})),nn.history.push(u))}};ot(e,h)},at=(e,t,i,n)=>{let r,{id:o,type:l,size:a,attribute:s}=i,{x:d,y:u,width:c,height:h,ratios:v}=a,g=(c||1)/(h||1),p=null,y=!1;ot(e,{start:e=>{p=JSON.parse(JSON.stringify({id:o,size:a,attribute:s}))},move:(e,p,f)=>{((e,p,y,f,m)=>{var b;let w=y-e,S=f-p;switch(t){case"rect-center":r=(null==m?void 0:m.shiftKey)?Math.abs(w)>=Math.abs(S)?{x:d+w,y:u,width:c,height:h}:{x:d,y:u+S,width:c,height:h}:{x:d+w,y:u+S,width:c,height:h};break;case"rect-top-left":r=(null==m?void 0:m.shiftKey)&&(null==m?void 0:m.altKey)?g>=1?{x:d+w,y:u+w/g,width:c-2*w,height:h-2*w/g}:{x:d+S*g,y:u+S,width:c-2*S*g,height:h-2*S}:(null==m?void 0:m.shiftKey)?g>=1?{x:d+w,y:u+w/g,width:c-w,height:h-w/g}:{x:d+S*g,y:u+S,width:c-S*g,height:h-S}:(null==m?void 0:m.altKey)?{x:d+w,y:u+S,width:c-2*w,height:h-2*S}:{x:d+w,y:u+S,width:c-w,height:h-S};break;case"rect-top-right":r=(null==m?void 0:m.shiftKey)&&(null==m?void 0:m.altKey)?g>=1?{x:d-w,y:u-w/g,width:c+2*w,height:h+2*w/g}:{x:d+S*g,y:u+S,width:c-2*S*g,height:h-2*S}:(null==m?void 0:m.shiftKey)?g>=1?{x:d,y:u-w/g,width:c+w,height:h+w/g}:{x:d,y:u+S,width:c-S*g,height:h-S}:(null==m?void 0:m.altKey)?{x:d-w,y:u+S,width:c+2*w,height:h-2*S}:{x:d,y:u+S,width:c+w,height:h-S};break;case"rect-bottom-left":r=(null==m?void 0:m.shiftKey)&&(null==m?void 0:m.altKey)?g>=1?{x:d+w,y:u+w/g,width:c-2*w,height:h-2*w/g}:{x:d-S*g,y:u-S,width:c+2*S*g,height:h+2*S}:(null==m?void 0:m.shiftKey)?g>=1?{x:d+w,y:u,width:c-w,height:h-w/g}:{x:d-S*g,y:u,width:c+S*g,height:h+S}:(null==m?void 0:m.altKey)?{x:d+w,y:u-S,width:c-2*w,height:h+2*S}:{x:d+w,y:u,width:c-w,height:h+S};break;case"rect-bottom-right":r=(null==m?void 0:m.shiftKey)&&(null==m?void 0:m.altKey)?g>=1?{x:d-w,y:u-w/g,width:c+2*w,height:h+2*w/g}:{x:d-S*g,y:u-S,width:c+2*S*g,height:h+2*S}:(null==m?void 0:m.shiftKey)?g>=1?{x:d,y:u,width:c+w,height:h+w/g}:{x:d,y:u,width:c+S*g,height:h+S}:(null==m?void 0:m.altKey)?{x:d-w,y:u-S,width:c+2*w,height:h+2*S}:{x:d,y:u,width:c+w,height:h+S};break;case"rect-top":r=(null==m?void 0:m.shiftKey)?{x:d+S/2*g,y:u+S,width:c-S*g,height:h-S}:(null==m?void 0:m.altKey)?{x:d,y:u+S,width:c,height:h-2*S}:{x:d,y:u+S,width:c,height:h-S};break;case"rect-bottom":r=(null==m?void 0:m.shiftKey)?{x:d-S/2*g,y:u,width:c+S*g,height:h+S}:(null==m?void 0:m.altKey)?{x:d,y:u-S,width:c,height:h+2*S}:{x:d,y:u,width:c,height:h+S};break;case"rect-left":r=(null==m?void 0:m.shiftKey)?{x:d+w,y:u+w/2/g,width:c-w,height:h-w/g}:(null==m?void 0:m.altKey)?{x:d+w,y:u,width:c-2*w,height:h}:{x:d+w,y:u,width:c-w,height:h};break;case"rect-right":r=(null==m?void 0:m.shiftKey)?{x:d,y:u-w/2/g,width:c+w,height:h+w/g}:(null==m?void 0:m.altKey)?{x:d-w,y:u,width:c+2*w,height:h}:{x:d,y:u,width:c+w,height:h};break;default:{let e=t.match(/^point-(\d+)/);r=e?{x:d,y:u,width:c,height:h}:{x:d+w,y:u+S,width:c,height:h};break}}r.width<=0&&(r.width=1),r.height<=0&&(r.height=1);let x=t.match(/^point-(\d+)/);if(x){let e=parseInt(x[1]);if("number"==typeof e){r.ratios=null==v?void 0:v.map(((t,i)=>i==e?[B(t[0]+(0==r.width?0:w/r.width),100),B(t[1]+(0==r.height?0:S/r.height),100)]:t));let t=st(r.x,r.y,r.width,r.height,null!==(b=r.ratios)&&void 0!==b?b:[]),i=ut(t),n=dt(i.x,i.y,i.width,i.height,t);r={x:i.x,y:i.y,width:i.width,height:i.height,ratios:n}}}r.x=B(r.x,1),r.y=B(r.y,1),r.width=B(r.width,1),r.height=B(r.height,1),Object.assign(a,r),Object.assign(s,ie(l,a,s)),Ge(window.document.getElementById(o),s),He(n,i)})(p[0][0],p[0][1],e.x,e.y,f),y=!0},end:(e,t)=>{y&&p&&nn.history.push([{type:"size",from:p,to:JSON.parse(JSON.stringify({id:o,size:a,attribute:s}))}])}})},st=(e,t,i,n,r)=>r.map((r=>[e+i*r[0],t+n*r[1]])),dt=(e,t,i,n,r)=>r.map((r=>[0==i?0:B((r[0]-e)/i,100),0==n?0:B((r[1]-t)/n,100)])),ut=e=>{let t=[],i=[];e.map((e=>{t.push(e[0]),i.push(e[1])}));let n=Math.min.apply(null,t),r=Math.min.apply(null,i);return{x:n,y:r,width:Math.max.apply(null,t)-n||1,height:Math.max.apply(null,i)-r||1}},ct=e=>{e.length>1?(e=>{let t=999999,i=999999,n=-999999,o=-999999;e.forEach((e=>{t=Math.min(t,e.size.x),i=Math.min(i,e.size.y),n=Math.max(n,e.size.x+e.size.width),o=Math.max(o,e.size.y+e.size.height)}));let l=We(r.RESIZE_GROUP,"g"),a=te(t,i,n,o);a.x=B(a.x,100),a.y=B(a.y,100),a.width=B(a.width,100),a.height=B(a.height,100),Xe(l,e,a).forEach((t=>{((e,t,i,n,r)=>{let o=!1;null==e||e.addEventListener("touchstart",(e=>{o=!0,lt({touchEvent:e},t,i,n,r)})),null==e||e.addEventListener("mousedown",(e=>{0==e.button&&(o?o=!1:lt({mouseEvent:e},t,i,n,r))}))})(t.element,t.posType,a,e,l)}))})(e):1==e.length&&(e=>{let t=We(r.RESIZE_GROUP,"g");if(e.length>0){let i=e[0];He(t,i).forEach((e=>{((e,t,i,n)=>{let r=!1;null==e||e.addEventListener("touchstart",(e=>{r=!0,at({touchEvent:e},t,i,n)})),null==e||e.addEventListener("mousedown",(e=>{0==e.button&&(r?r=!1:at({mouseEvent:e},t,i,n))}))})(e.element,e.posType,i,t)}))}})(e)},ht=(e,t,i)=>{var n,r,o;let{id:l,type:a,source:s}=e;t=null==t?void 0:t.replace(/<[^>]+>/g,"");let d=JSON.parse(JSON.stringify({id:l,type:a,source:s}));s?s.text?(s.text.textContent=t,s.text.variableKeywords=null!==(o=(null!=t?t:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==o?o:[]):s.text={textContent:t,variableKeywords:null!==(r=(null!=t?t:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==r?r:[]}:s={text:{textContent:t,variableKeywords:null!==(n=(null!=t?t:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==n?n:[]}},i||Qe(window.document.getElementById(l),a,s),nn.history.push([{type:"source",from:d,to:JSON.parse(JSON.stringify({id:l,type:a,source:s}))}])},vt=(e,t,i)=>{var n;let{id:r,type:o,source:l}=e,a=JSON.parse(JSON.stringify({id:r,type:o,source:l})),s=e=>{var t;return null!==(t=(null!=e?e:"").match(/\{[a-zA-Z0-9_]+\}/gm))&&void 0!==t?t:[]},d=e=>{var t;return(null!==(t=(null!=e?e:"").match(/\[\[[a-zA-Z0-9]+\]\]/gm))&&void 0!==t?t:[]).filter(((e,t,i)=>i.indexOf(e)==t))};l?l.html?(l.html.htmlContent=t,l.html.variableKeywords=s(t),l.html.fillKeywords=d(t)):l.html={htmlContent:t,variableKeywords:s(t),fillKeywords:d(t)}:l={html:{htmlContent:t,variableKeywords:s(t),fillKeywords:d(t)}},"fill"==(null===(n=l.test)||void 0===n?void 0:n.type)&&(l.test.fill=d(t).map((e=>{var t,i,n,r;return{key:e,value:null!==(r=null===(n=null===(i=null===(t=null==l?void 0:l.test)||void 0===t?void 0:t.fill)||void 0===i?void 0:i.find((t=>t.key==e)))||void 0===n?void 0:n.value)&&void 0!==r?r:[]}}))),i||Qe(window.document.getElementById(r),o,l),nn.history.push([{type:"source",from:a,to:JSON.parse(JSON.stringify({id:r,type:o,source:l}))}])},gt=(e,t)=>{let{id:i,type:n,source:r}=e,o=JSON.parse(JSON.stringify({id:i,type:n,source:r}));r?r.link?(r.link.url=t.url,r.link.title=t.title,r.link.description=t.description):r.link=t:r={link:t},Qe(window.document.getElementById(i),n,r),nn.history.push([{type:"source",from:o,to:JSON.parse(JSON.stringify({id:i,type:n,source:r}))}])},pt=(e,t)=>{let{id:i,type:n,source:r}=e,o=JSON.parse(JSON.stringify({id:i,type:n,source:r}));r?r.image?(r.image.url=null==t?void 0:t.url,r.image.path=null==t?void 0:t.path,r.image.name=null==t?void 0:t.name,r.image.base64=void 0):r.image=t:r={image:t},Qe(window.document.getElementById(i),n,r),nn.history.push([{type:"source",from:o,to:JSON.parse(JSON.stringify({id:i,type:n,source:r}))}])},yt=(e,t)=>{let{id:i,type:n,source:r}=e,o=JSON.parse(JSON.stringify({id:i,type:n,source:r}));r?r.audio?(r.audio.url=t.url,r.audio.path=t.path,r.audio.name=t.name):r.audio=t:r={audio:t},Qe(window.document.getElementById(i),n,r),nn.history.push([{type:"source",from:o,to:JSON.parse(JSON.stringify({id:i,type:n,source:r}))}])},ft=(e,t)=>{let{id:i,type:n,source:r}=e,o=JSON.parse(JSON.stringify({id:i,type:n,source:r}));r?r.video?(r.video.url=t.url,r.video.path=t.path,r.video.name=t.name):r.video=t:r={video:t},Qe(window.document.getElementById(i),n,r),nn.history.push([{type:"source",from:o,to:JSON.parse(JSON.stringify({id:i,type:n,source:r}))}])},mt=(e,t)=>{let{id:i,type:n,source:r}=e,o=JSON.parse(JSON.stringify({id:i,type:n,source:r}));r?r.file?(r.file.url=t.url,r.file.path=t.path,r.file.name=t.name):r.file=t:r={file:t},Qe(window.document.getElementById(i),n,r),nn.history.push([{type:"source",from:o,to:JSON.parse(JSON.stringify({id:i,type:n,source:r}))}])},bt=(e,t)=>{let{id:i,type:n,source:r}=e,o=JSON.parse(JSON.stringify({id:i,type:n,source:r}));r?r.iframe?(r.iframe.url=null==t?void 0:t.url,r.iframe.path=null==t?void 0:t.path,r.iframe.name=null==t?void 0:t.name):r.iframe=t:r={iframe:t},Qe(window.document.getElementById(i),n,r),nn.history.push([{type:"source",from:o,to:JSON.parse(JSON.stringify({id:i,type:n,source:r}))}])},wt=(e,t)=>{let{id:i,type:n,source:r}=e,o=JSON.parse(JSON.stringify({id:i,type:n,source:r}));r?r.track?(r.track.url=t.url,r.track.path=t.path):r.track=t:r={track:t},Qe(window.document.getElementById(i),n,r),nn.history.push([{type:"source",from:o,to:JSON.parse(JSON.stringify({id:i,type:n,source:r}))}])},St=(e,t)=>{let{id:i,type:n,source:r}=e,o=JSON.parse(JSON.stringify({id:i,type:n,source:r}));r?r.input?r.input.placeholder=t:r.input={placeholder:t}:r={input:{placeholder:t}},Qe(window.document.getElementById(i),n,r),nn.history.push([{type:"source",from:o,to:JSON.parse(JSON.stringify({id:i,type:n,source:r}))}])},xt=(e,t)=>{let{id:i,type:n,source:r}=e,o=JSON.parse(JSON.stringify({id:i,type:n,source:r}));r?r.embed?(r.embed.type=null==t?void 0:t.type,r.embed.oss=null==t?void 0:t.oss,r.embed.name=null==t?void 0:t.name,r.embed.path=null==t?void 0:t.path,r.embed.url=null==t?void 0:t.url):r.embed=t:r={embed:t},Qe(window.document.getElementById(i),n,r),nn.history.push([{type:"source",from:o,to:JSON.parse(JSON.stringify({id:i,type:n,source:r}))}])},kt=e=>{var t,i,n,o,l,s,d,u,c,h,v;let g=(null===(t=e.mouseEvent)||void 0===t?void 0:t.target)||(null===(i=e.touchEvent)||void 0===i?void 0:i.target),p=(null==g?void 0:g.getAttribute("id"))||"",y=null==g?void 0:g.nodeName;nn.dataSelect.nodeName.includes(y)||(g=jQuery(g).parents("foreignObject").get(0),g&&(p=g.getAttribute("id")||"",y=g.nodeName));let f=(null===(n=null==g?void 0:g.parentNode)||void 0===n?void 0:n.getAttribute("id"))||"";if([r.RESIZE_GROUP,r.SELECT_GROUP].includes(f))null===(o=e.mouseEvent)||void 0===o||o.stopPropagation(),null===(l=e.mouseEvent)||void 0===l||l.preventDefault(),"dblclick"==(null===(s=e.mouseEvent)||void 0===s?void 0:s.type)&&1==nn.dataSelect.ids.length&&(e=>{var t,i,n,r,o,l;if(1!=e.length)return;let s=e[0];if(!(s.type==a.FOREIGNOBJECT&&["html","text"].includes(null!==(i=null===(t=s.source)||void 0===t?void 0:t.type)&&void 0!==i?i:"")||s.type==a.FOREIGNOBJECT&&"test"==(null===(n=s.source)||void 0===n?void 0:n.type)&&["truefalse","singlechoice","multichoice","matching-content","fill"].includes(null!==(l=null===(o=null===(r=s.source)||void 0===r?void 0:r.test)||void 0===o?void 0:o.type)&&void 0!==l?l:"")||s.type==a.TEXT))return;nn.dataSelect.openEditable();let d=$(`#${s.id}`).find("[contenteditable]");d.on("input",(()=>{var e,t,i;"html"==(null===(e=s.source)||void 0===e?void 0:e.type)||"test"==(null===(t=s.source)||void 0===t?void 0:t.type)?vt(s,d.html(),!0):"text"==(null===(i=s.source)||void 0===i?void 0:i.type)&&ht(s,d.text(),!0)})).on("focusout",(()=>{nn.dataSelect.closeEditable()})).focus();let u=d.get(0);if(u){let e=document.createRange(),t=window.getSelection();t&&(e.selectNodeContents(u),t.removeAllRanges(),t.addRange(e))}})(nn.dataSelect.nodes);else if((null===(d=e.mouseEvent)||void 0===d?void 0:d.altKey)||(null===(u=e.touchEvent)||void 0===u?void 0:u.altKey)||!p||p.match(/[^0-9]/)||!nn.dataSelect.nodeName.includes(y))nn.dataSelect.ids.length&&(nn.dataSelect.ids=[]),(0==(null===(c=e.mouseEvent)||void 0===c?void 0:c.button)||e.touchEvent)&&(e=>{let t=We(r.SCAN_GROUP,"g"),i=te(0,0,1,1);Ye(t,i),((e,t,i)=>{ot(e,{start:e=>{},move:(e,n)=>{var r,o,l,a;r=n[0][0],o=n[0][1],l=e.x,a=e.y,t=te(r,o,l,a),Ye(i,t)},end:(e,t)=>{null==i||i.remove(),nn.dataSelect.ids=nn.data.getNodeInArea(Math.min(t[0][0],e.x),Math.min(t[0][1],e.y),Math.max(t[0][0],e.x),Math.max(t[0][1],e.y)),ct(nn.dataSelect.nodes)}})})(e,i,t)})(e);else{let t=parseFloat(p||"0");if(t==nn.dataSelect.contenteditable_id)return;(null===(h=e.mouseEvent)||void 0===h?void 0:h.shiftKey)||(null===(v=e.touchEvent)||void 0===v?void 0:v.shiftKey)?nn.dataSelect.ids=[t].concat(nn.dataSelect.ids).filter(((e,t,i)=>i.indexOf(e)==t)):nn.dataSelect.ids=[t],ct(nn.dataSelect.nodes)}};class Ot{constructor(){let{x:e,y:t}=nn.screen.dislocation;var i=(i,n,r,o)=>{nn.screen.move({x:e,y:t},{x:r-i,y:o-n})};return{start:e=>{},move:(e,t)=>{i(t[0][0],t[0][1],e.x,e.y)},end:(e,t)=>{i(t[0][0],t[0][1],e.x,e.y)}}}}class _t{constructor(){let e=We(r.CREATE_GROUP,"g"),{nodeId:t,element:i,attribute:n,size:o}=P(Math.ceil(1e9*Math.random())),l=(t,r,l,s)=>{o=te(t,r,l,s,{ratio:1}),o.x=B(o.x),o.y=B(o.y),o.width=B(o.width),o.height=B(o.height),Object.assign(n,ie(a.CIRCLE,o,n)),Ge(i,n),Ve(e,o)};return{start:e=>{l(e.x,e.y,e.x+o.width,e.y+o.height)},move:(e,t)=>{l(t[0][0],t[0][1],e.x,e.y)},end:(r,l)=>{(o.width<=8||o.height<=8)&&(o.width=80,o.height=80,o.x=o.x-o.width/2,o.y=o.y-o.height/2,Object.assign(n,ie(a.CIRCLE,o,n)),Ge(i,n)),nn.data.node=Object.assign({id:t,type:a.CIRCLE,name:"Circle"},{size:o,attribute:n}),null==e||e.remove()}}}}class Nt{constructor(){let e=We(r.CREATE_GROUP,"g"),{nodeId:t,element:i,attribute:n,size:o}=Ee(Math.ceil(1e9*Math.random()));var l=(t,r,l,s)=>{o=te(t,r,l,s),o.x=B(o.x),o.y=B(o.y),o.width=B(o.width),o.height=B(o.height),Object.assign(n,ie(a.ELLIPSE,o,n)),Ge(i,n),Ve(e,o)};return{start:e=>{l(e.x,e.y,e.x+o.width,e.y+o.height)},move:(e,t)=>{l(t[0][0],t[0][1],e.x,e.y)},end:(r,l)=>{o.width<4&&(o.width=4),o.height<4&&(o.height=4),o.width+o.height<8&&(o.width=90,o.height=60,o.x=o.x-o.width/2,o.y=o.y-o.height/2,Object.assign(n,ie(a.ELLIPSE,o,n)),Ge(i,n)),nn.data.node=Object.assign({id:t,type:a.ELLIPSE,name:"Ellipse"},{size:o,attribute:n}),null==e||e.remove()}}}}class Et{constructor(){let e=We(r.CREATE_GROUP,"g"),{nodeId:t,element:i,attribute:n,size:o}=M(Math.ceil(1e9*Math.random()));var l=(t,r,l,s)=>{o=te(t,r,l,s),o.x=B(o.x),o.y=B(o.y),o.width=B(o.width),o.height=B(o.height),Object.assign(n,ie(a.RECT,o,n)),Ge(i,n),Ve(e,o)};return{start:e=>{l(e.x,e.y,e.x+o.width,e.y+o.height)},move:(e,t)=>{l(t[0][0],t[0][1],e.x,e.y)},end:(r,l)=>{o.width<1&&(o.width=1),o.height<1&&(o.height=1),o.width+o.height<8&&(o.width=80,o.height=80,o.x=o.x-o.width/2,o.y=o.y-o.height/2,Object.assign(n,ie(a.RECT,o,n)),Ge(i,n)),nn.data.node=Object.assign({id:t,type:a.RECT,name:"Rect"},{size:o,attribute:n}),null==e||e.remove()}}}}class It{constructor(e){let t=We(r.CREATE_GROUP,"g"),i=e||[[0,0],[1,1],[0,1]],{nodeId:n,element:o,attribute:l,size:s}=ze(Math.ceil(1e9*Math.random()));s.ratios=i;var d=(e,n,r,d)=>{s=te(e,n,r,d,{ratios:i}),s.x=B(s.x),s.y=B(s.y),s.width=B(s.width),s.height=B(s.height),Object.assign(l,ie(a.POLYGON,s,l)),Ge(o,l),Ve(t,s)};return{start:e=>{d(e.x,e.y,e.x+s.width,e.y+s.height)},move:(e,t)=>{d(t[0][0],t[0][1],e.x,e.y)},end:(e,i)=>{s.width<1&&(s.width=1),s.height<1&&(s.height=1),s.width+s.height<8&&(s.width=80,s.height=80,s.x=s.x-s.width/2,s.y=s.y-s.height/2,Object.assign(l,ie(a.POLYGON,s,l)),Ge(o,l)),nn.data.node=Object.assign({id:n,type:a.POLYGON,name:"Polygon"},{size:s,attribute:l}),null==t||t.remove()}}}}class zt{constructor(){let e=We(r.CREATE_GROUP,"g"),{nodeId:t,element:i,attribute:n,size:o}=Ie(Math.ceil(1e9*Math.random()));return{start:e=>{},move:(t,r)=>{var l,s,d,u;l=r[0][0],s=r[0][1],d=t.x,u=t.y,o=te(l,s,d,u),o.x=B(o.x),o.y=B(o.y),o.width=B(o.width),o.height=B(o.height),Object.assign(n,ie(a.LINE,o,n)),Ge(i,n),Ve(e,o)},end:(r,l)=>{l.length>=2?(o.width<8&&(o.width=0),o.height<8&&(o.height=0),o.width+o.height<8&&(o.width=80,o.height=0,o.x=o.x-o.width/2,o.y=o.y-o.height/2,Object.assign(n,ie(a.LINE,o,n)),Ge(i,n)),nn.data.node=Object.assign({id:t,type:a.LINE,name:"Line"},{size:o,attribute:n})):null==i||i.remove(),null==e||e.remove()}}}}class Jt{constructor(){let{nodeId:e,element:t,attribute:i,size:n}=je(Math.ceil(1e9*Math.random())),r="";return{start:e=>{r=`M ${e.x} ${e.y} L ${e.x} ${e.y}`},move:(e,i)=>{((e,i)=>{r+=` ${e} ${i}`,t.setAttribute("d",r)})(e.x,e.y)},end:(t,o)=>{let l=Q(r),{minX:s,minY:d,maxX:u,maxY:c}=U(l);n.x=s,n.y=d,n.width=u-s||1,n.height=c-d||1,n.ratioMaps=W(n,l),nn.data.node=Object.assign({id:e,type:a.PATH,name:"Path"},{size:n,attribute:i})}}}}class jt{constructor(){let e=We(r.CREATE_GROUP,"g"),{nodeId:t,element:i,size:n,attribute:o,style:l,source:s}=Je(Math.ceil(1e9*Math.random()));var d=(t,r,l,s)=>{n=te(t,r,l,s),n.x=B(n.x),n.y=B(n.y),n.width=B(n.width),n.height=B(n.height),Object.assign(o,ie(a.FOREIGNOBJECT,n,o)),Ge(i,o),Ve(e,n)};return{start:e=>{d(e.x,e.y,e.x+n.width,e.y+n.height)},move:(e,t)=>{d(t[0][0],t[0][1],e.x,e.y)},end:(r,d)=>{(n.width<=16||n.height<=16)&&(n.width=90,n.height=60,n.x=n.x-n.width/2,n.y=n.y-n.height/2,Object.assign(o,ie(a.FOREIGNOBJECT,n,o)),Ge(i,o)),nn.data.node=Object.assign({id:t,type:a.FOREIGNOBJECT,name:"ForeignObject"},{size:n,attribute:o,style:l,source:s}),null==e||e.remove()}}}}class Tt{constructor(){var e,t;let i=We(r.CREATE_GROUP,"g"),{nodeId:n,element:o,size:l,attribute:s,source:d}=L(Math.ceil(1e9*Math.random())),u=1;(e=>{if(!e)return;let t=new Image;t.onload=()=>{u=B(t.naturalWidth/t.naturalHeight,100)},t.onerror=t=>{console.error(`ImgSrc load failed -> ${e}`,t)},t.src=e})(null!==(t=null===(e=d.image)||void 0===e?void 0:e.url)&&void 0!==t?t:"");var c=(e,t,n,r)=>{l=te(e,t,n,r,{ratio:u}),l.x=B(l.x),l.y=B(l.y),l.width=B(l.width),l.height=B(l.height),Object.assign(s,ie(a.IMAGE,l,s)),Ge(o,s),Ve(i,l)};return{start:e=>{c(e.x,e.y,e.x+l.width,e.y+l.height)},move:(e,t)=>{c(t[0][0],t[0][1],e.x,e.y)},end:(e,t)=>{(l.width<=16||l.height<=16)&&(l.width=80,l.height=80,l.x=l.x-l.width/2,l.y=l.y-l.height/2,Object.assign(s,ie(a.IMAGE,l,s)),Ge(o,s)),nn.data.node=Object.assign({id:n,type:a.IMAGE,name:"Image"},{size:l,attribute:s,source:d}),null==i||i.remove()}}}}var $t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function Ct(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function At(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Bt,Rt={exports:{}},Mt=(Bt||(Bt=1,Rt.exports=function e(t,i,n){function r(l,a){if(!i[l]){if(!t[l]){if(!a&&At)return At(l);if(o)return o(l,!0);var s=new Error("Cannot find module '"+l+"'");throw s.code="MODULE_NOT_FOUND",s}var d=i[l]={exports:{}};t[l][0].call(d.exports,(function(e){return r(t[l][1][e]||e)}),d,d.exports,e,t,i,n)}return i[l].exports}for(var o=At,l=0;l<n.length;l++)r(n[l]);return r}({1:[function(e,t,i){(function(e){var i,n,r=e.MutationObserver||e.WebKitMutationObserver;if(r){var o=0,l=new r(u),a=e.document.createTextNode("");l.observe(a,{characterData:!0}),i=function(){a.data=o=++o%2}}else if(e.setImmediate||void 0===e.MessageChannel)i="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){u(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(u,0)};else{var s=new e.MessageChannel;s.port1.onmessage=u,i=function(){s.port2.postMessage(0)}}var d=[];function u(){var e,t;n=!0;for(var i=d.length;i;){for(t=d,d=[],e=-1;++e<i;)t[e]();i=d.length}n=!1}t.exports=function(e){1!==d.push(e)||n||i()}}).call(this,void 0!==$t?$t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t,i){var n=e(1);function r(){}var o={},l=["REJECTED"],a=["FULFILLED"],s=["PENDING"];function d(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=s,this.queue=[],this.outcome=void 0,e!==r&&v(this,e)}function u(e,t,i){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof i&&(this.onRejected=i,this.callRejected=this.otherCallRejected)}function c(e,t,i){n((function(){var n;try{n=t(i)}catch(t){return o.reject(e,t)}n===e?o.reject(e,new TypeError("Cannot resolve promise with itself")):o.resolve(e,n)}))}function h(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function v(e,t){var i=!1;function n(t){i||(i=!0,o.reject(e,t))}function r(t){i||(i=!0,o.resolve(e,t))}var l=g((function(){t(r,n)}));"error"===l.status&&n(l.value)}function g(e,t){var i={};try{i.value=e(t),i.status="success"}catch(e){i.status="error",i.value=e}return i}t.exports=d,d.prototype.catch=function(e){return this.then(null,e)},d.prototype.then=function(e,t){if("function"!=typeof e&&this.state===a||"function"!=typeof t&&this.state===l)return this;var i=new this.constructor(r);return this.state!==s?c(i,this.state===a?e:t,this.outcome):this.queue.push(new u(i,e,t)),i},u.prototype.callFulfilled=function(e){o.resolve(this.promise,e)},u.prototype.otherCallFulfilled=function(e){c(this.promise,this.onFulfilled,e)},u.prototype.callRejected=function(e){o.reject(this.promise,e)},u.prototype.otherCallRejected=function(e){c(this.promise,this.onRejected,e)},o.resolve=function(e,t){var i=g(h,t);if("error"===i.status)return o.reject(e,i.value);var n=i.value;if(n)v(e,n);else{e.state=a,e.outcome=t;for(var r=-1,l=e.queue.length;++r<l;)e.queue[r].callFulfilled(t)}return e},o.reject=function(e,t){e.state=l,e.outcome=t;for(var i=-1,n=e.queue.length;++i<n;)e.queue[i].callRejected(t);return e},d.resolve=function(e){return e instanceof this?e:o.resolve(new this(r),e)},d.reject=function(e){var t=new this(r);return o.reject(t,e)},d.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var i=e.length,n=!1;if(!i)return this.resolve([]);for(var l=new Array(i),a=0,s=-1,d=new this(r);++s<i;)u(e[s],s);return d;function u(e,r){t.resolve(e).then((function(e){l[r]=e,++a!==i||n||(n=!0,o.resolve(d,l))}),(function(e){n||(n=!0,o.reject(d,e))}))}},d.race=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var i,n=e.length,l=!1;if(!n)return this.resolve([]);for(var a=-1,s=new this(r);++a<n;)i=e[a],t.resolve(i).then((function(e){l||(l=!0,o.resolve(s,e))}),(function(e){l||(l=!0,o.reject(s,e))}));return s}},{1:1}],3:[function(e,t,i){(function(t){"function"!=typeof t.Promise&&(t.Promise=e(2))}).call(this,void 0!==$t?$t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(e,t,i){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var r=function(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(e){return}}();function o(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(r){if("TypeError"!==r.name)throw r;for(var i=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),n=0;n<e.length;n+=1)i.append(e[n]);return i.getBlob(t.type)}}"undefined"==typeof Promise&&e(3);var l=Promise;function a(e,t){t&&e.then((function(e){t(null,e)}),(function(e){t(e)}))}function s(e,t,i){"function"==typeof t&&e.then(t),"function"==typeof i&&e.catch(i)}function d(e){return"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e)),e}function u(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var c="local-forage-detect-blob-support",h=void 0,v={},g=Object.prototype.toString,p="readonly",y="readwrite";function f(e){for(var t=e.length,i=new ArrayBuffer(t),n=new Uint8Array(i),r=0;r<t;r++)n[r]=e.charCodeAt(r);return i}function m(e){return"boolean"==typeof h?l.resolve(h):function(e){return new l((function(t){var i=e.transaction(c,y),n=o([""]);i.objectStore(c).put(n,"key"),i.onabort=function(e){e.preventDefault(),e.stopPropagation(),t(!1)},i.oncomplete=function(){var e=navigator.userAgent.match(/Chrome\/(\d+)/),i=navigator.userAgent.match(/Edge\//);t(i||!e||parseInt(e[1],10)>=43)}})).catch((function(){return!1}))}(e).then((function(e){return h=e}))}function b(e){var t=v[e.name],i={};i.promise=new l((function(e,t){i.resolve=e,i.reject=t})),t.deferredOperations.push(i),t.dbReady?t.dbReady=t.dbReady.then((function(){return i.promise})):t.dbReady=i.promise}function w(e){var t=v[e.name].deferredOperations.pop();if(t)return t.resolve(),t.promise}function S(e,t){var i=v[e.name].deferredOperations.pop();if(i)return i.reject(t),i.promise}function x(e,t){return new l((function(i,n){if(v[e.name]=v[e.name]||{forages:[],db:null,dbReady:null,deferredOperations:[]},e.db){if(!t)return i(e.db);b(e),e.db.close()}var o=[e.name];t&&o.push(e.version);var l=r.open.apply(r,o);t&&(l.onupgradeneeded=function(t){var i=l.result;try{i.createObjectStore(e.storeName),t.oldVersion<=1&&i.createObjectStore(c)}catch(i){if("ConstraintError"!==i.name)throw i;console.warn('The database "'+e.name+'" has been upgraded from version '+t.oldVersion+" to version "+t.newVersion+', but the storage "'+e.storeName+'" already exists.')}}),l.onerror=function(e){e.preventDefault(),n(l.error)},l.onsuccess=function(){var t=l.result;t.onversionchange=function(e){e.target.close()},i(t),w(e)}}))}function k(e){return x(e,!1)}function O(e){return x(e,!0)}function _(e,t){if(!e.db)return!0;var i=!e.db.objectStoreNames.contains(e.storeName),n=e.version<e.db.version,r=e.version>e.db.version;if(n&&(e.version!==t&&console.warn('The database "'+e.name+"\" can't be downgraded from version "+e.db.version+" to version "+e.version+"."),e.version=e.db.version),r||i){if(i){var o=e.db.version+1;o>e.version&&(e.version=o)}return!0}return!1}function N(e){return o([f(atob(e.data))],{type:e.type})}function E(e){return e&&e.__local_forage_encoded_blob}function I(e){var t=this,i=t._initReady().then((function(){var e=v[t._dbInfo.name];if(e&&e.dbReady)return e.dbReady}));return s(i,e,e),i}function z(e,t,i,n){void 0===n&&(n=1);try{var r=e.db.transaction(e.storeName,t);i(null,r)}catch(r){if(n>0&&(!e.db||"InvalidStateError"===r.name||"NotFoundError"===r.name))return l.resolve().then((function(){if(!e.db||"NotFoundError"===r.name&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),O(e)})).then((function(){return function(e){b(e);for(var t=v[e.name],i=t.forages,n=0;n<i.length;n++){var r=i[n];r._dbInfo.db&&(r._dbInfo.db.close(),r._dbInfo.db=null)}return e.db=null,k(e).then((function(t){return e.db=t,_(e)?O(e):t})).then((function(n){e.db=t.db=n;for(var r=0;r<i.length;r++)i[r]._dbInfo.db=n})).catch((function(t){throw S(e,t),t}))}(e).then((function(){z(e,t,i,n-1)}))})).catch(i);i(r)}}var J={_driver:"asyncStorage",_initStorage:function(e){var t=this,i={db:null};if(e)for(var n in e)i[n]=e[n];var r=v[i.name];r||(r={forages:[],db:null,dbReady:null,deferredOperations:[]},v[i.name]=r),r.forages.push(t),t._initReady||(t._initReady=t.ready,t.ready=I);var o=[];function a(){return l.resolve()}for(var s=0;s<r.forages.length;s++){var d=r.forages[s];d!==t&&o.push(d._initReady().catch(a))}var u=r.forages.slice(0);return l.all(o).then((function(){return i.db=r.db,k(i)})).then((function(e){return i.db=e,_(i,t._defaultConfig.version)?O(i):e})).then((function(e){i.db=r.db=e,t._dbInfo=i;for(var n=0;n<u.length;n++){var o=u[n];o!==t&&(o._dbInfo.db=i.db,o._dbInfo.version=i.version)}}))},_support:function(){try{if(!r||!r.open)return!1;var e="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),t="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!e||t)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(e){return!1}}(),iterate:function(e,t){var i=this,n=new l((function(t,n){i.ready().then((function(){z(i._dbInfo,p,(function(r,o){if(r)return n(r);try{var l=o.objectStore(i._dbInfo.storeName).openCursor(),a=1;l.onsuccess=function(){var i=l.result;if(i){var n=i.value;E(n)&&(n=N(n));var r=e(n,i.key,a++);void 0!==r?t(r):i.continue()}else t()},l.onerror=function(){n(l.error)}}catch(e){n(e)}}))})).catch(n)}));return a(n,t),n},getItem:function(e,t){var i=this;e=d(e);var n=new l((function(t,n){i.ready().then((function(){z(i._dbInfo,p,(function(r,o){if(r)return n(r);try{var l=o.objectStore(i._dbInfo.storeName).get(e);l.onsuccess=function(){var e=l.result;void 0===e&&(e=null),E(e)&&(e=N(e)),t(e)},l.onerror=function(){n(l.error)}}catch(e){n(e)}}))})).catch(n)}));return a(n,t),n},setItem:function(e,t,i){var n=this;e=d(e);var r=new l((function(i,r){var o;n.ready().then((function(){return o=n._dbInfo,"[object Blob]"===g.call(t)?m(o.db).then((function(e){return e?t:(i=t,new l((function(e,t){var n=new FileReader;n.onerror=t,n.onloadend=function(t){var n=btoa(t.target.result||"");e({__local_forage_encoded_blob:!0,data:n,type:i.type})},n.readAsBinaryString(i)})));var i})):t})).then((function(t){z(n._dbInfo,y,(function(o,l){if(o)return r(o);try{var a=l.objectStore(n._dbInfo.storeName);null===t&&(t=void 0);var s=a.put(t,e);l.oncomplete=function(){void 0===t&&(t=null),i(t)},l.onabort=l.onerror=function(){var e=s.error?s.error:s.transaction.error;r(e)}}catch(e){r(e)}}))})).catch(r)}));return a(r,i),r},removeItem:function(e,t){var i=this;e=d(e);var n=new l((function(t,n){i.ready().then((function(){z(i._dbInfo,y,(function(r,o){if(r)return n(r);try{var l=o.objectStore(i._dbInfo.storeName).delete(e);o.oncomplete=function(){t()},o.onerror=function(){n(l.error)},o.onabort=function(){var e=l.error?l.error:l.transaction.error;n(e)}}catch(e){n(e)}}))})).catch(n)}));return a(n,t),n},clear:function(e){var t=this,i=new l((function(e,i){t.ready().then((function(){z(t._dbInfo,y,(function(n,r){if(n)return i(n);try{var o=r.objectStore(t._dbInfo.storeName).clear();r.oncomplete=function(){e()},r.onabort=r.onerror=function(){var e=o.error?o.error:o.transaction.error;i(e)}}catch(e){i(e)}}))})).catch(i)}));return a(i,e),i},length:function(e){var t=this,i=new l((function(e,i){t.ready().then((function(){z(t._dbInfo,p,(function(n,r){if(n)return i(n);try{var o=r.objectStore(t._dbInfo.storeName).count();o.onsuccess=function(){e(o.result)},o.onerror=function(){i(o.error)}}catch(e){i(e)}}))})).catch(i)}));return a(i,e),i},key:function(e,t){var i=this,n=new l((function(t,n){e<0?t(null):i.ready().then((function(){z(i._dbInfo,p,(function(r,o){if(r)return n(r);try{var l=o.objectStore(i._dbInfo.storeName),a=!1,s=l.openKeyCursor();s.onsuccess=function(){var i=s.result;i?0===e||a?t(i.key):(a=!0,i.advance(e)):t(null)},s.onerror=function(){n(s.error)}}catch(e){n(e)}}))})).catch(n)}));return a(n,t),n},keys:function(e){var t=this,i=new l((function(e,i){t.ready().then((function(){z(t._dbInfo,p,(function(n,r){if(n)return i(n);try{var o=r.objectStore(t._dbInfo.storeName).openKeyCursor(),l=[];o.onsuccess=function(){var t=o.result;t?(l.push(t.key),t.continue()):e(l)},o.onerror=function(){i(o.error)}}catch(e){i(e)}}))})).catch(i)}));return a(i,e),i},dropInstance:function(e,t){t=u.apply(this,arguments);var i,n=this.config();if((e="function"!=typeof e&&e||{}).name||(e.name=e.name||n.name,e.storeName=e.storeName||n.storeName),e.name){var o=e.name===n.name&&this._dbInfo.db?l.resolve(this._dbInfo.db):k(e).then((function(t){var i=v[e.name],n=i.forages;i.db=t;for(var r=0;r<n.length;r++)n[r]._dbInfo.db=t;return t}));i=e.storeName?o.then((function(t){if(t.objectStoreNames.contains(e.storeName)){var i=t.version+1;b(e);var n=v[e.name],o=n.forages;t.close();for(var a=0;a<o.length;a++){var s=o[a];s._dbInfo.db=null,s._dbInfo.version=i}var d=new l((function(t,n){var o=r.open(e.name,i);o.onerror=function(e){o.result.close(),n(e)},o.onupgradeneeded=function(){o.result.deleteObjectStore(e.storeName)},o.onsuccess=function(){var e=o.result;e.close(),t(e)}}));return d.then((function(e){n.db=e;for(var t=0;t<o.length;t++){var i=o[t];i._dbInfo.db=e,w(i._dbInfo)}})).catch((function(t){throw(S(e,t)||l.resolve()).catch((function(){})),t}))}})):o.then((function(t){b(e);var i=v[e.name],n=i.forages;t.close();for(var o=0;o<n.length;o++)n[o]._dbInfo.db=null;var a=new l((function(t,i){var n=r.deleteDatabase(e.name);n.onerror=function(){var e=n.result;e&&e.close(),i(n.error)},n.onblocked=function(){console.warn('dropInstance blocked for database "'+e.name+'" until all open connections are closed')},n.onsuccess=function(){var e=n.result;e&&e.close(),t(e)}}));return a.then((function(e){i.db=e;for(var t=0;t<n.length;t++)w(n[t]._dbInfo)})).catch((function(t){throw(S(e,t)||l.resolve()).catch((function(){})),t}))}))}else i=l.reject("Invalid arguments");return a(i,t),i}};var j="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",T=/^~~local_forage_type~([^~]+)~/,$="__lfsc__:",C="arbf",A="blob",B="si08",R="ui08",M="uic8",L="si16",P="si32",F="ur16",K="ui32",G="fl32",D="fl64",Q=Object.prototype.toString;function U(e){var t,i,n,r,o,l=.75*e.length,a=e.length,s=0;"="===e[e.length-1]&&(l--,"="===e[e.length-2]&&l--);var d=new ArrayBuffer(l),u=new Uint8Array(d);for(t=0;t<a;t+=4)i=j.indexOf(e[t]),n=j.indexOf(e[t+1]),r=j.indexOf(e[t+2]),o=j.indexOf(e[t+3]),u[s++]=i<<2|n>>4,u[s++]=(15&n)<<4|r>>2,u[s++]=(3&r)<<6|63&o;return d}function W(e){var t,i=new Uint8Array(e),n="";for(t=0;t<i.length;t+=3)n+=j[i[t]>>2],n+=j[(3&i[t])<<4|i[t+1]>>4],n+=j[(15&i[t+1])<<2|i[t+2]>>6],n+=j[63&i[t+2]];return i.length%3==2?n=n.substring(0,n.length-1)+"=":i.length%3==1&&(n=n.substring(0,n.length-2)+"=="),n}var V={serialize:function(e,t){var i="";if(e&&(i=Q.call(e)),e&&("[object ArrayBuffer]"===i||e.buffer&&"[object ArrayBuffer]"===Q.call(e.buffer))){var n,r=$;e instanceof ArrayBuffer?(n=e,r+=C):(n=e.buffer,"[object Int8Array]"===i?r+=B:"[object Uint8Array]"===i?r+=R:"[object Uint8ClampedArray]"===i?r+=M:"[object Int16Array]"===i?r+=L:"[object Uint16Array]"===i?r+=F:"[object Int32Array]"===i?r+=P:"[object Uint32Array]"===i?r+=K:"[object Float32Array]"===i?r+=G:"[object Float64Array]"===i?r+=D:t(new Error("Failed to get type for BinaryArray"))),t(r+W(n))}else if("[object Blob]"===i){var o=new FileReader;o.onload=function(){var i="~~local_forage_type~"+e.type+"~"+W(this.result);t($+A+i)},o.readAsArrayBuffer(e)}else try{t(JSON.stringify(e))}catch(i){console.error("Couldn't convert value into a JSON string: ",e),t(null,i)}},deserialize:function(e){if(e.substring(0,9)!==$)return JSON.parse(e);var t,i=e.substring(13),n=e.substring(9,13);if(n===A&&T.test(i)){var r=i.match(T);t=r[1],i=i.substring(r[0].length)}var l=U(i);switch(n){case C:return l;case A:return o([l],{type:t});case B:return new Int8Array(l);case R:return new Uint8Array(l);case M:return new Uint8ClampedArray(l);case L:return new Int16Array(l);case F:return new Uint16Array(l);case P:return new Int32Array(l);case K:return new Uint32Array(l);case G:return new Float32Array(l);case D:return new Float64Array(l);default:throw new Error("Unkown type: "+n)}},stringToBuffer:U,bufferToString:W};function H(e,t,i,n){e.executeSql("CREATE TABLE IF NOT EXISTS "+t.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],i,n)}function X(e,t,i,n,r,o){e.executeSql(i,n,r,(function(e,l){l.code===l.SYNTAX_ERR?e.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[t.storeName],(function(e,a){a.rows.length?o(e,l):H(e,t,(function(){e.executeSql(i,n,r,o)}),o)}),o):o(e,l)}),o)}function q(e,t,i,n){var r=this;e=d(e);var o=new l((function(o,l){r.ready().then((function(){void 0===t&&(t=null);var a=t,s=r._dbInfo;s.serializer.serialize(t,(function(t,d){d?l(d):s.db.transaction((function(i){X(i,s,"INSERT OR REPLACE INTO "+s.storeName+" (key, value) VALUES (?, ?)",[e,t],(function(){o(a)}),(function(e,t){l(t)}))}),(function(t){if(t.code===t.QUOTA_ERR){if(n>0)return void o(q.apply(r,[e,a,i,n-1]));l(t)}}))}))})).catch(l)}));return a(o,i),o}var Y={_driver:"webSQLStorage",_initStorage:function(e){var t=this,i={db:null};if(e)for(var n in e)i[n]="string"!=typeof e[n]?e[n].toString():e[n];var r=new l((function(e,n){try{i.db=openDatabase(i.name,String(i.version),i.description,i.size)}catch(e){return n(e)}i.db.transaction((function(r){H(r,i,(function(){t._dbInfo=i,e()}),(function(e,t){n(t)}))}),n)}));return i.serializer=V,r},_support:"function"==typeof openDatabase,iterate:function(e,t){var i=this,n=new l((function(t,n){i.ready().then((function(){var r=i._dbInfo;r.db.transaction((function(i){X(i,r,"SELECT * FROM "+r.storeName,[],(function(i,n){for(var o=n.rows,l=o.length,a=0;a<l;a++){var s=o.item(a),d=s.value;if(d&&(d=r.serializer.deserialize(d)),void 0!==(d=e(d,s.key,a+1)))return void t(d)}t()}),(function(e,t){n(t)}))}))})).catch(n)}));return a(n,t),n},getItem:function(e,t){var i=this;e=d(e);var n=new l((function(t,n){i.ready().then((function(){var r=i._dbInfo;r.db.transaction((function(i){X(i,r,"SELECT * FROM "+r.storeName+" WHERE key = ? LIMIT 1",[e],(function(e,i){var n=i.rows.length?i.rows.item(0).value:null;n&&(n=r.serializer.deserialize(n)),t(n)}),(function(e,t){n(t)}))}))})).catch(n)}));return a(n,t),n},setItem:function(e,t,i){return q.apply(this,[e,t,i,1])},removeItem:function(e,t){var i=this;e=d(e);var n=new l((function(t,n){i.ready().then((function(){var r=i._dbInfo;r.db.transaction((function(i){X(i,r,"DELETE FROM "+r.storeName+" WHERE key = ?",[e],(function(){t()}),(function(e,t){n(t)}))}))})).catch(n)}));return a(n,t),n},clear:function(e){var t=this,i=new l((function(e,i){t.ready().then((function(){var n=t._dbInfo;n.db.transaction((function(t){X(t,n,"DELETE FROM "+n.storeName,[],(function(){e()}),(function(e,t){i(t)}))}))})).catch(i)}));return a(i,e),i},length:function(e){var t=this,i=new l((function(e,i){t.ready().then((function(){var n=t._dbInfo;n.db.transaction((function(t){X(t,n,"SELECT COUNT(key) as c FROM "+n.storeName,[],(function(t,i){var n=i.rows.item(0).c;e(n)}),(function(e,t){i(t)}))}))})).catch(i)}));return a(i,e),i},key:function(e,t){var i=this,n=new l((function(t,n){i.ready().then((function(){var r=i._dbInfo;r.db.transaction((function(i){X(i,r,"SELECT key FROM "+r.storeName+" WHERE id = ? LIMIT 1",[e+1],(function(e,i){var n=i.rows.length?i.rows.item(0).key:null;t(n)}),(function(e,t){n(t)}))}))})).catch(n)}));return a(n,t),n},keys:function(e){var t=this,i=new l((function(e,i){t.ready().then((function(){var n=t._dbInfo;n.db.transaction((function(t){X(t,n,"SELECT key FROM "+n.storeName,[],(function(t,i){for(var n=[],r=0;r<i.rows.length;r++)n.push(i.rows.item(r).key);e(n)}),(function(e,t){i(t)}))}))})).catch(i)}));return a(i,e),i},dropInstance:function(e,t){t=u.apply(this,arguments);var i=this.config();(e="function"!=typeof e&&e||{}).name||(e.name=e.name||i.name,e.storeName=e.storeName||i.storeName);var n,r=this;return a(n=e.name?new l((function(t){var n;n=e.name===i.name?r._dbInfo.db:openDatabase(e.name,"","",0),e.storeName?t({db:n,storeNames:[e.storeName]}):t(function(e){return new l((function(t,i){e.transaction((function(n){n.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],(function(i,n){for(var r=[],o=0;o<n.rows.length;o++)r.push(n.rows.item(o).name);t({db:e,storeNames:r})}),(function(e,t){i(t)}))}),(function(e){i(e)}))}))}(n))})).then((function(e){return new l((function(t,i){e.db.transaction((function(n){function r(e){return new l((function(t,i){n.executeSql("DROP TABLE IF EXISTS "+e,[],(function(){t()}),(function(e,t){i(t)}))}))}for(var o=[],a=0,s=e.storeNames.length;a<s;a++)o.push(r(e.storeNames[a]));l.all(o).then((function(){t()})).catch((function(e){i(e)}))}),(function(e){i(e)}))}))})):l.reject("Invalid arguments"),t),n}};function Z(e,t){var i=e.name+"/";return e.storeName!==t.storeName&&(i+=e.storeName+"/"),i}function ee(){return!function(){var e="_localforage_support_test";try{return localStorage.setItem(e,!0),localStorage.removeItem(e),!1}catch(e){return!0}}()||localStorage.length>0}var te={_driver:"localStorageWrapper",_initStorage:function(e){var t={};if(e)for(var i in e)t[i]=e[i];return t.keyPrefix=Z(e,this._defaultConfig),ee()?(this._dbInfo=t,t.serializer=V,l.resolve()):l.reject()},_support:function(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(e){return!1}}(),iterate:function(e,t){var i=this,n=i.ready().then((function(){for(var t=i._dbInfo,n=t.keyPrefix,r=n.length,o=localStorage.length,l=1,a=0;a<o;a++){var s=localStorage.key(a);if(0===s.indexOf(n)){var d=localStorage.getItem(s);if(d&&(d=t.serializer.deserialize(d)),void 0!==(d=e(d,s.substring(r),l++)))return d}}}));return a(n,t),n},getItem:function(e,t){var i=this;e=d(e);var n=i.ready().then((function(){var t=i._dbInfo,n=localStorage.getItem(t.keyPrefix+e);return n&&(n=t.serializer.deserialize(n)),n}));return a(n,t),n},setItem:function(e,t,i){var n=this;e=d(e);var r=n.ready().then((function(){void 0===t&&(t=null);var i=t;return new l((function(r,o){var l=n._dbInfo;l.serializer.serialize(t,(function(t,n){if(n)o(n);else try{localStorage.setItem(l.keyPrefix+e,t),r(i)}catch(e){"QuotaExceededError"!==e.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==e.name||o(e),o(e)}}))}))}));return a(r,i),r},removeItem:function(e,t){var i=this;e=d(e);var n=i.ready().then((function(){var t=i._dbInfo;localStorage.removeItem(t.keyPrefix+e)}));return a(n,t),n},clear:function(e){var t=this,i=t.ready().then((function(){for(var e=t._dbInfo.keyPrefix,i=localStorage.length-1;i>=0;i--){var n=localStorage.key(i);0===n.indexOf(e)&&localStorage.removeItem(n)}}));return a(i,e),i},length:function(e){var t=this.keys().then((function(e){return e.length}));return a(t,e),t},key:function(e,t){var i=this,n=i.ready().then((function(){var t,n=i._dbInfo;try{t=localStorage.key(e)}catch(e){t=null}return t&&(t=t.substring(n.keyPrefix.length)),t}));return a(n,t),n},keys:function(e){var t=this,i=t.ready().then((function(){for(var e=t._dbInfo,i=localStorage.length,n=[],r=0;r<i;r++){var o=localStorage.key(r);0===o.indexOf(e.keyPrefix)&&n.push(o.substring(e.keyPrefix.length))}return n}));return a(i,e),i},dropInstance:function(e,t){if(t=u.apply(this,arguments),!(e="function"!=typeof e&&e||{}).name){var i=this.config();e.name=e.name||i.name,e.storeName=e.storeName||i.storeName}var n,r=this;return n=e.name?new l((function(t){e.storeName?t(Z(e,r._defaultConfig)):t(e.name+"/")})).then((function(e){for(var t=localStorage.length-1;t>=0;t--){var i=localStorage.key(t);0===i.indexOf(e)&&localStorage.removeItem(i)}})):l.reject("Invalid arguments"),a(n,t),n}},ie=function(e,t){return e===t||"number"==typeof e&&"number"==typeof t&&isNaN(e)&&isNaN(t)},ne=function(e,t){for(var i=e.length,n=0;n<i;){if(ie(e[n],t))return!0;n++}return!1},re=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},oe={},le={},ae={INDEXEDDB:J,WEBSQL:Y,LOCALSTORAGE:te},se=[ae.INDEXEDDB._driver,ae.WEBSQL._driver,ae.LOCALSTORAGE._driver],de=["dropInstance"],ue=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(de),ce={description:"",driver:se.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function he(e,t){e[t]=function(){var i=arguments;return e.ready().then((function(){return e[t].apply(e,i)}))}}function ve(){for(var e=1;e<arguments.length;e++){var t=arguments[e];if(t)for(var i in t)t.hasOwnProperty(i)&&(re(t[i])?arguments[0][i]=t[i].slice():arguments[0][i]=t[i])}return arguments[0]}var ge=function(){function e(t){for(var i in function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),ae)if(ae.hasOwnProperty(i)){var n=ae[i],r=n._driver;this[i]=r,oe[r]||this.defineDriver(n)}this._defaultConfig=ve({},ce),this._config=ve({},this._defaultConfig,t),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch((function(){}))}return e.prototype.config=function(e){if("object"===(void 0===e?"undefined":n(e))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var t in e){if("storeName"===t&&(e[t]=e[t].replace(/\W/g,"_")),"version"===t&&"number"!=typeof e[t])return new Error("Database version must be a number.");this._config[t]=e[t]}return!("driver"in e)||!e.driver||this.setDriver(this._config.driver)}return"string"==typeof e?this._config[e]:this._config},e.prototype.defineDriver=function(e,t,i){var n=new l((function(t,i){try{var n=e._driver,r=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!e._driver)return void i(r);for(var o=ue.concat("_initStorage"),s=0,d=o.length;s<d;s++){var u=o[s];if((!ne(de,u)||e[u])&&"function"!=typeof e[u])return void i(r)}!function(){for(var t=function(e){return function(){var t=new Error("Method "+e+" is not implemented by the current driver"),i=l.reject(t);return a(i,arguments[arguments.length-1]),i}},i=0,n=de.length;i<n;i++){var r=de[i];e[r]||(e[r]=t(r))}}();var c=function(i){oe[n]&&console.info("Redefining LocalForage driver: "+n),oe[n]=e,le[n]=i,t()};"_support"in e?e._support&&"function"==typeof e._support?e._support().then(c,i):c(!!e._support):c(!0)}catch(e){i(e)}}));return s(n,t,i),n},e.prototype.driver=function(){return this._driver||null},e.prototype.getDriver=function(e,t,i){var n=oe[e]?l.resolve(oe[e]):l.reject(new Error("Driver not found."));return s(n,t,i),n},e.prototype.getSerializer=function(e){var t=l.resolve(V);return s(t,e),t},e.prototype.ready=function(e){var t=this,i=t._driverSet.then((function(){return null===t._ready&&(t._ready=t._initDriver()),t._ready}));return s(i,e,e),i},e.prototype.setDriver=function(e,t,i){var n=this;re(e)||(e=[e]);var r=this._getSupportedDrivers(e);function o(){n._config.driver=n.driver()}function a(e){return n._extend(e),o(),n._ready=n._initStorage(n._config),n._ready}var d=null!==this._driverSet?this._driverSet.catch((function(){return l.resolve()})):l.resolve();return this._driverSet=d.then((function(){var e=r[0];return n._dbInfo=null,n._ready=null,n.getDriver(e).then((function(e){n._driver=e._driver,o(),n._wrapLibraryMethodsWithReady(),n._initDriver=function(e){return function(){var t=0;return function i(){for(;t<e.length;){var r=e[t];return t++,n._dbInfo=null,n._ready=null,n.getDriver(r).then(a).catch(i)}o();var s=new Error("No available storage method found.");return n._driverSet=l.reject(s),n._driverSet}()}}(r)}))})).catch((function(){o();var e=new Error("No available storage method found.");return n._driverSet=l.reject(e),n._driverSet})),s(this._driverSet,t,i),this._driverSet},e.prototype.supports=function(e){return!!le[e]},e.prototype._extend=function(e){ve(this,e)},e.prototype._getSupportedDrivers=function(e){for(var t=[],i=0,n=e.length;i<n;i++){var r=e[i];this.supports(r)&&t.push(r)}return t},e.prototype._wrapLibraryMethodsWithReady=function(){for(var e=0,t=ue.length;e<t;e++)he(this,ue[e])},e.prototype.createInstance=function(t){return new e(t)},e}(),pe=new ge;t.exports=pe},{3:3}]},{},[4])(4)),Rt.exports),Lt=n({__proto__:null,default:Ct(Mt)},[Mt]);Mt.config({driver:[Mt.INDEXEDDB,Mt.LOCALSTORAGE,Mt.WEBSQL],name:"_localDataDB",version:1});const Pt=()=>O(void 0,void 0,void 0,(function*(){return Lt})),Ft=e=>O(void 0,void 0,void 0,(function*(){return Mt.getItem(e)})),Kt=(e,t)=>O(void 0,void 0,void 0,(function*(){return Mt.setItem(e,t)})),Gt=e=>O(void 0,void 0,void 0,(function*(){yield Pt();var t=(yield Ft("icdt-data"))||[];"function"==typeof e.callback&&e.callback(t)})),Dt=e=>O(void 0,void 0,void 0,(function*(){yield Pt(),e.params=e.params||{};try{yield Kt("icdt-data",e.params),"function"==typeof e.callback&&e.callback(e.params)}catch(t){"function"==typeof e.callback&&e.callback(null),console.error(t)}})),Qt=e=>O(void 0,void 0,void 0,(function*(){yield Pt();try{var t=(yield Ft("icdt-config"))||{};"function"==typeof e.callback&&e.callback(t)}catch(t){"function"==typeof e.callback&&e.callback(null),console.error(t)}})),Ut=e=>O(void 0,void 0,void 0,(function*(){yield Pt(),e.params=e.params||{};try{yield Kt("icdt-config",e.params),"function"==typeof e.callback&&e.callback(e.params)}catch(t){"function"==typeof e.callback&&e.callback(null),console.error(t)}})),Wt=e=>O(void 0,void 0,void 0,(function*(){yield Pt();try{var t=(yield Ft("icdt-clipboard"))||{};"function"==typeof e.callback&&e.callback(t)}catch(t){"function"==typeof e.callback&&e.callback(null),console.error(t)}})),Vt=e=>O(void 0,void 0,void 0,(function*(){yield Pt(),e.params=e.params||{};try{yield Kt("icdt-clipboard",e.params),"function"==typeof e.callback&&e.callback(e.params)}catch(t){"function"==typeof e.callback&&e.callback(null),console.error(t)}})),Ht=(e,t,i)=>{var n;if(t&&!(null!=i?i:window).document.getElementById(t))return;if(t){let n=(null!=i?i:window).document.getElementById(t);jQuery(n).find("#"+r.BACKGROUND_GROUP).empty();let o=We(r.BACKGROUND_GROUP,"g",void 0,n);tt(o,e)}else{jQuery(nn.target).find("#"+r.BACKGROUND_GROUP).empty();let t=We(r.BACKGROUND_GROUP,"g",void 0,nn.target);tt(t,e)}let o=(e,n)=>{n=t&&n?`${t}-${n}`:null!=t?t:n,null==e||e.forEach((e=>{var r;let l=t?`${t}-${e.id}`:e.id;if(e.isdeleted)null===(r=(null!=i?i:window).document.getElementById(l))||void 0===r||r.remove();else switch(e.type){case a.GROUP:ue(l,{},n?(null!=i?i:window).document.getElementById(n):null),o(e.nodes,e.id);break;case a.CIRCLE:P(l,{size:e.size,attribute:e.attribute},n?(null!=i?i:window).document.getElementById(n):null);break;case a.ELLIPSE:Ee(l,{size:e.size,attribute:e.attribute},n?(null!=i?i:window).document.getElementById(n):null);break;case a.LINE:Ie(l,{size:e.size,attribute:e.attribute},n?(null!=i?i:window).document.getElementById(n):null);break;case a.RECT:M(l,{size:e.size,attribute:e.attribute},n?(null!=i?i:window).document.getElementById(n):null);break;case a.POLYGON:ze(l,{size:e.size,attribute:e.attribute},n?(null!=i?i:window).document.getElementById(n):null);break;case a.POLYLINE:Te(l,{size:e.size,attribute:e.attribute},n?(null!=i?i:window).document.getElementById(n):null);break;case a.FOREIGNOBJECT:Je(l,{size:e.size,attribute:e.attribute,style:e.style,source:e.source},n?(null!=i?i:window).document.getElementById(n):null);break;case a.IMAGE:L(l,{size:e.size,attribute:e.attribute,source:e.source},n?(null!=i?i:window).document.getElementById(n):null);break;case a.TEXT:de(l,{size:e.size,attribute:e.attribute,source:e.source},n?(null!=i?i:window).document.getElementById(n):null);break;case a.TSPAN:$e(l,{size:e.size,attribute:e.attribute,source:e.source},n?(null!=i?i:window).document.getElementById(n):null);break;case a.PATH:je(l,{size:e.size,attribute:e.attribute},n?(null!=i?i:window).document.getElementById(n):null)}}))};o(null===(n=null==e?void 0:e.svg)||void 0===n?void 0:n.nodes)},Xt=(e,t)=>{var i;if(t&&!window.document.getElementById(t))return;let n=(e,i)=>{i=i?`${t}-${i}`:t,null==e||e.forEach((e=>{let r=t?`${t}-${e.id}`:e.id;jQuery("#"+r).appendTo(i?window.document.getElementById(i):nn.target),e.type==a.GROUP&&n(e.nodes,e.id)}))};n(null===(i=null==e?void 0:e.svg)||void 0===i?void 0:i.nodes)},qt=(e,t)=>{let{id:i,type:n,size:r,attribute:o}=e,l=JSON.parse(JSON.stringify({id:i,size:r,attribute:o}));r.x=B(t||0),Object.assign(o,ie(n,r,o)),Ge(window.document.getElementById(i),o),nn.history.push([{type:"size",from:l,to:JSON.parse(JSON.stringify({id:i,size:r,attribute:o}))}])},Yt=(e,t)=>{let{id:i,type:n,size:r,attribute:o}=e,l=JSON.parse(JSON.stringify({id:i,size:r,attribute:o}));r.y=B(t||0),Object.assign(o,ie(n,r,o)),Ge(window.document.getElementById(i),o),nn.history.push([{type:"size",from:l,to:JSON.parse(JSON.stringify({id:i,size:r,attribute:o}))}])},Zt=(e,t,i)=>{let{id:n,type:r,size:o,attribute:l}=e;t<=0&&(t=1);let a=JSON.parse(JSON.stringify({id:n,size:o,attribute:l}));i&&(o.height=B(t*o.height/(o.width||1))),o.width=B(t),Object.assign(l,ie(r,o,l)),Ge(window.document.getElementById(n),l),nn.history.push([{type:"size",from:a,to:JSON.parse(JSON.stringify({id:n,size:o,attribute:l}))}])},ei=(e,t,i)=>{let{id:n,type:r,size:o,attribute:l}=e;t<=0&&(t=1);let a=JSON.parse(JSON.stringify({id:n,size:o,attribute:l}));i&&(o.width=B(t*o.width/(o.height||1))),o.height=B(t),Object.assign(l,ie(r,o,l)),Ge(window.document.getElementById(n),l),nn.history.push([{type:"size",from:a,to:JSON.parse(JSON.stringify({id:n,size:o,attribute:l}))}])},ti=(e,t)=>{let{id:i,type:n,size:r,attribute:o}=e,l=JSON.parse(JSON.stringify({id:i,size:r,attribute:o}));r.rotate="number"==typeof t?B(t,100):void 0,Object.assign(o,ie(n,r,o)),Ge(window.document.getElementById(i),o),nn.history.push([{type:"size",from:l,to:JSON.parse(JSON.stringify({id:i,size:r,attribute:o}))}])},ii=new class{constructor(){this._fnChanges=[],this.onchange={type:"keydown",key:v.Escape,fn:()=>{nn.dataSelect.ids.length&&(nn.dataSelect.ids=[])}},this.onchange={type:"keydown",key:v.Delete,fn:()=>{nn.dataSelect.deleteNode()}},this.onchange={type:"keydown",key:v.Space,fn:()=>{nn.pointer.pointer_type_temp=o.HAND}},this.onchange={type:"keyup",key:v.Space,fn:()=>{nn.pointer.pointer_type_temp=o.POINTER}},this.onchange={type:"keydown",key:v.ArrowLeft,fn:()=>{nn.dataSelect.ids.length||nn.data.backSlide()}},this.onchange={type:"keydown",key:v.ArrowRight,fn:()=>{nn.dataSelect.ids.length||nn.data.nextSlide()}},this.onchange={type:"keydown",key:v.PageDown,fn:()=>{nn.dataSelect.ids.length||nn.data.backSlide()}},this.onchange={type:"keydown",key:v.PageUp,fn:()=>{nn.dataSelect.ids.length||nn.data.nextSlide()}},this.onchange={type:"keydown",key:v.ArrowLeft,fn:()=>{nn.dataSelect.ids.length&&(nn.dataSelect.nodes.forEach((e=>{qt(e,B(e.size.x-R(1)))})),ct(nn.dataSelect.nodes))}},this.onchange={type:"keydown",key:v.ArrowRight,fn:()=>{nn.dataSelect.ids.length&&(nn.dataSelect.nodes.forEach((e=>{qt(e,B(e.size.x+R(1)))})),ct(nn.dataSelect.nodes))}},this.onchange={type:"keydown",key:v.ArrowUp,fn:()=>{nn.dataSelect.ids.length&&(nn.dataSelect.nodes.forEach((e=>{Yt(e,B(e.size.y-R(1)))})),ct(nn.dataSelect.nodes))}},this.onchange={type:"keydown",key:v.ArrowDown,fn:()=>{nn.dataSelect.ids.length&&(nn.dataSelect.nodes.forEach((e=>{Yt(e,B(e.size.y+R(1)))})),ct(nn.dataSelect.nodes))}},this.onchange={type:"keydown",key:v.Digit1,fn:e=>{e.shiftKey&&(nn.reloadView(),nn.screen.zoomTo="fit")}},this.onchange={type:"keydown",key:v.Digit0,fn:e=>{e.ctrlKey&&(nn.screen.zoomTo=100)}},this.onchange={type:"keydown",key:v.Equal,fn:e=>{e.ctrlKey&&nn.screen.zoomIn()}},this.onchange={type:"keydown",key:v.Minus,fn:e=>{e.ctrlKey&&nn.screen.zoomOut()}},this.onchange={type:"keydown",key:v.KeyA,fn:e=>{e.ctrlKey&&(nn.dataSelect.ids=nn.data.getNodeAll(),ct(nn.dataSelect.nodes))}},this.onchange={type:"keydown",key:v.KeyC,fn:e=>{if(e.ctrlKey){let e=nn.dataSelect.nodes;e&&Vt({params:{type:"nodes",nodes:e}})}}},this.onchange={type:"keydown",key:v.KeyV,fn:e=>{e.ctrlKey&&Wt({callback:t=>{var i,n;"nodes"==(null==t?void 0:t.type)&&(null===(i=null==t?void 0:t.nodes)||void 0===i?void 0:i.length)&&(null===(n=null==t?void 0:t.nodes)||void 0===n||n.forEach((t=>{e.shiftKey||nn.data.findNode(t.id).id&&(t.size.x+=16,t.size.y+=16),t.id=Math.ceil(1e9*Math.random()),nn.data.node=t})),Ht(nn.data.slide))}})}},this.onchange={type:"keydown",key:v.KeyZ,fn:e=>{e.ctrlKey&&e.shiftKey?nn.history.redo():e.ctrlKey&&nn.history.undo()}},this.onchange={type:"keydown",key:v.BracketLeft,fn:e=>{e.ctrlKey&&e.shiftKey?nn.data.sendToBack(nn.dataSelect.ids):e.ctrlKey?nn.data.sendToBackStep(nn.dataSelect.ids,-2):nn.data.sendToBackArea(nn.dataSelect.ids)}},this.onchange={type:"keydown",key:v.BracketRight,fn:e=>{e.ctrlKey&&e.shiftKey?nn.data.bringToFront(nn.dataSelect.ids):e.ctrlKey?nn.data.bringToFrontStep(nn.dataSelect.ids,1):nn.data.bringToFrontArea(nn.dataSelect.ids)}}}set onchange(e){let t=this._fnChanges.find((t=>t.eventType==e.type&&t.eventKey==e.key));t?t.fns.push(e.fn):this._fnChanges.push({eventType:e.type,eventKey:e.key,fns:[e.fn]})}change(e,t,i){var n;nn.dataSelect.contenteditable_id||null===(n=this._fnChanges.find((i=>i.eventType==e&&i.eventKey==t)))||void 0===n||n.fns.forEach((e=>e(i)))}},ni=e=>{ii.change(e.type,e.keyCode||e.which||e.charCode||0,e)},ri=Math.PI,oi=2*ri,li=1e-6,ai=oi-li;function si(e){this._+=e[0];for(let t=1,i=e.length;t<i;++t)this._+=arguments[t]+e[t]}class di{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==e?si:function(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return si;const i=10**t;return function(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=Math.round(arguments[t]*i)/i+e[t]}}(e)}moveTo(e,t){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,t){this._append`L${this._x1=+e},${this._y1=+t}`}quadraticCurveTo(e,t,i,n){this._append`Q${+e},${+t},${this._x1=+i},${this._y1=+n}`}bezierCurveTo(e,t,i,n,r,o){this._append`C${+e},${+t},${+i},${+n},${this._x1=+r},${this._y1=+o}`}arcTo(e,t,i,n,r){if(e=+e,t=+t,i=+i,n=+n,(r=+r)<0)throw new Error(`negative radius: ${r}`);let o=this._x1,l=this._y1,a=i-e,s=n-t,d=o-e,u=l-t,c=d*d+u*u;if(null===this._x1)this._append`M${this._x1=e},${this._y1=t}`;else if(c>li)if(Math.abs(u*a-s*d)>li&&r){let h=i-o,v=n-l,g=a*a+s*s,p=h*h+v*v,y=Math.sqrt(g),f=Math.sqrt(c),m=r*Math.tan((ri-Math.acos((g+c-p)/(2*y*f)))/2),b=m/f,w=m/y;Math.abs(b-1)>li&&this._append`L${e+b*d},${t+b*u}`,this._append`A${r},${r},0,0,${+(u*h>d*v)},${this._x1=e+w*a},${this._y1=t+w*s}`}else this._append`L${this._x1=e},${this._y1=t}`}arc(e,t,i,n,r,o){if(e=+e,t=+t,o=!!o,(i=+i)<0)throw new Error(`negative radius: ${i}`);let l=i*Math.cos(n),a=i*Math.sin(n),s=e+l,d=t+a,u=1^o,c=o?n-r:r-n;null===this._x1?this._append`M${s},${d}`:(Math.abs(this._x1-s)>li||Math.abs(this._y1-d)>li)&&this._append`L${s},${d}`,i&&(c<0&&(c=c%oi+oi),c>ai?this._append`A${i},${i},0,1,${u},${e-l},${t-a}A${i},${i},0,1,${u},${this._x1=s},${this._y1=d}`:c>li&&this._append`A${i},${i},0,${+(c>=ri)},${u},${this._x1=e+i*Math.cos(r)},${this._y1=t+i*Math.sin(r)}`)}rect(e,t,i,n){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}h${i=+i}v${+n}h${-i}Z`}toString(){return this._}}function ui(e){return function(){return e}}function ci(e){this._context=e}function hi(e){return new ci(e)}function vi(e){return e[0]}function gi(e){return e[1]}function pi(e,t){var i=ui(!0),n=null,r=hi,o=null,l=function(e){let t=3;return e.digits=function(i){if(!arguments.length)return t;if(null==i)t=null;else{const e=Math.floor(i);if(!(e>=0))throw new RangeError(`invalid digits: ${i}`);t=e}return e},()=>new di(t)}(a);function a(a){var s,d,u,c=(a=function(e){return"object"==typeof e&&"length"in e?e:Array.from(e)}(a)).length,h=!1;for(null==n&&(o=r(u=l())),s=0;s<=c;++s)!(s<c&&i(d=a[s],s,a))===h&&((h=!h)?o.lineStart():o.lineEnd()),h&&o.point(+e(d,s,a),+t(d,s,a));if(u)return o=null,u+""||null}return e="function"==typeof e?e:void 0===e?vi:ui(e),t="function"==typeof t?t:void 0===t?gi:ui(t),a.x=function(t){return arguments.length?(e="function"==typeof t?t:ui(+t),a):e},a.y=function(e){return arguments.length?(t="function"==typeof e?e:ui(+e),a):t},a.defined=function(e){return arguments.length?(i="function"==typeof e?e:ui(!!e),a):i},a.curve=function(e){return arguments.length?(r=e,null!=n&&(o=r(n)),a):r},a.context=function(e){return arguments.length?(null==e?n=o=null:o=r(n=e),a):n},a}function yi(e,t,i){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+i)/6)}function fi(e){this._context=e}function mi(e){return new fi(e)}function bi(e,t,i){this.k=e,this.x=t,this.y=i}ci.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t)}}},fi.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:yi(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:yi(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},bi.prototype={constructor:bi,scale:function(e){return 1===e?this:new bi(this.k*e,this.x,this.y)},translate:function(e,t){return 0===e&0===t?this:new bi(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},new bi(1,0,0),bi.prototype;class wi{constructor(){let e={stroke:nn.attribute.stroke,strokeWidth:nn.attribute.strokeWidth,strokeLinecap:"round",strokeLinejoin:"round"},{nodeId:t,element:i,attribute:n,size:r}=je(Math.ceil(1e9*Math.random()),{attribute:e});Ge(i,n);let o="",l="";return{start:e=>{o=`M ${e.x} ${e.y} L ${e.x} ${e.y}`},move:(e,t)=>{((e,t)=>{o+=` ${e} ${t}`,i.setAttribute("d",o)})(e.x,e.y)},end:(e,s)=>{var d;if(s.length>=3){let e=pi().x((e=>e[0])).y((e=>e[1])).curve(mi);l=null!==(d=e(s))&&void 0!==d?d:"",i.setAttribute("d",l)}else i.setAttribute("d",o);let u=Q(l||o),{minX:c,minY:h,maxX:v,maxY:g}=U(u);r.x=c,r.y=h,r.width=v-c||1,r.height=g-h||1,r.ratioMaps=W(r,u),nn.data.node=Object.assign({id:t,type:a.PATH,name:"Path"},{size:r,attribute:n})}}}}class Si{constructor(){let e={stroke:nn.attribute.stroke,strokeOpacity:.4,strokeWidth:nn.attribute.strokeWidth,strokeLinecap:"round",strokeLinejoin:"round"},{nodeId:t,element:i,attribute:n,size:r}=je(Math.ceil(1e9*Math.random()),{attribute:e});Ge(i,n);let o="";return{start:e=>{o=`M ${e.x} ${e.y} L ${e.x} ${e.y}`},move:(e,t)=>{((e,t)=>{o+=` ${e} ${t}`,i.setAttribute("d",o)})(e.x,e.y)},end:(e,i)=>{let l=Q(o),{minX:s,minY:d,maxX:u,maxY:c}=U(l);r.x=s,r.y=d,r.width=u-s||1,r.height=c-d||1,r.ratioMaps=W(r,l),nn.data.node=Object.assign({id:t,type:a.PATH,name:"Path"},{size:r,attribute:n})}}}}class xi{constructor(e,t){var i,n;let o={stroke:"#FF0000",strokeWidth:R(2),strokeLinecap:"round",strokeLinejoin:"round",strokeDasharray:R(8)},{element:l,attribute:a,size:s}=je(Math.ceil(1e9*Math.random()),{size:t});window.document.getElementById(r.INTERACTIVE_GROUP).querySelectorAll("path").forEach((e=>null==e?void 0:e.remove())),window.document.getElementById(r.INTERACTIVE_GROUP).querySelectorAll("circle").forEach((e=>null==e?void 0:e.remove())),null===(i=window.document.getElementById(r.INTERACTIVE_GROUP))||void 0===i||i.appendChild(l);var d=t=>{var i;if(!t.length)return;let n=[];if(1==t.length){let{size:r}=null!==(i=null!=e?e:nn.dataSelect.nodes[0])&&void 0!==i?i:{};if(!r)return;n=[[r.x+r.width/2,r.y+r.height/2],t[0]]}else n=[...t];c(n),u(n[0],"start"),u(n[n.length-1],"end")},u=(t,i)=>{t&&((()=>{var e;let{element:n}=P(Math.ceil(1e9*Math.random()),{attribute:{fill:"start"==i?"#FF0000":"#00BA00",strokeWidth:R(1)},size:{x:t[0]-5,y:t[1]-5,width:10,height:10}});null===(e=window.document.getElementById(r.INTERACTIVE_GROUP))||void 0===e||e.prepend(n)})(),(()=>{var i,n;let{size:o}=null!==(i=null!=e?e:nn.dataSelect.nodes[0])&&void 0!==i?i:{};if(!o)return;let l=[[t[0]-o.width/2,t[1]-o.height/2],[t[0]+o.width/2,t[1]-o.height/2],[t[0]+o.width/2,t[1]+o.height/2],[t[0]-o.width/2,t[1]+o.height/2],[t[0]-o.width/2,t[1]-o.height/2]],{element:a}=je(Math.ceil(1e9*Math.random()),{attribute:{fill:"#FFFFFF",fillOpacity:.6,stroke:"#5f6ce1",strokeWidth:R(1),strokeLinecap:"round",strokeLinejoin:"round",strokeDasharray:R(8)},size:{x:0,y:0,width:10,height:10,points:l}});null===(n=window.document.getElementById(r.INTERACTIVE_GROUP))||void 0===n||n.prepend(a)})())},c=e=>{let t=pi().x((e=>e[0])).y((e=>e[1])).curve(mi),i=t(e);l.setAttribute("d",i)};Ge(l,o),d(null!==(n=null==t?void 0:t.points)&&void 0!==n?n:[]);let h="";return{start:e=>{h=`M ${e.x} ${e.y} L ${e.x} ${e.y}`},move:(e,t)=>{h+=` ${e.x} ${e.y}`,l.setAttribute("d",h)},end:(e,t)=>{d(t),t.length&&(window.interactivePoints=t)}}}}const ki=e=>{switch(nn.pointer.pen_type){case l.DRAW:ot(e,new wi);break;case l.HIGHTLIGH:ot(e,new Si);break;case l.INTERACTIVE:Oi(e)}},Oi=e=>{var t,i,n;let o=We(r.INTERACTIVE_GROUP,"g"),l=null!==(n=null===(i=null===(t=nn.data.slide)||void 0===t?void 0:t.svg)||void 0===i?void 0:i.viewBox)&&void 0!==n?n:(()=>{let{width:e,height:t}=nn.screen.get;return{x:0,y:0,width:e,height:t}})();Ze(o,l),e&&ot(e,new xi)};function _i(e,t,i,n){return Math.sqrt(Math.pow(i-e,2)+Math.pow(n-t,2))}function Ni(e,t,i,n,r){return _i(e,t,i,n)<r?1:0}function Ei(e,t,i,n,r,o,l){var a=[];return a.push(Ni(e,t,i,n,l)),a.push(Ni(e,t,r,o,l)),a.push(function(e,t,i,n,r,o,l){var a=[r-i,o-n],s=[e-i,t-n],d=[-a[1],a[0]],u=Math.sqrt(Math.pow(d[0],2)+Math.pow(d[1],2)),c=[d[0]/u,d[1]/u],h=Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)),v=[a[0]/h,a[1]/h],g=s[0]*v[0]+s[1]*v[1];if(g<=0||g>=h)return 0;var p=s[0]*c[0]+s[1]*c[1];return p>=l||p<=-l?0:1}(e,t,i,n,r,o,l)),a}function Ii(e,t,i,n,r){var o=[i-e,n-t],l=[-o[1],o[0]],a=Math.sqrt(Math.pow(l[0],2)+Math.pow(l[1],2)),s=[l[0]/a,l[1]/a];return[[e+r*s[0],t+r*s[1]],[e-r*s[0],t-r*s[1]],[i-r*s[0],n-r*s[1]],[i+r*s[0],n+r*s[1]]]}function zi(e,t,i,n,r,o,l){var a,s=[r-e,o-t],d=[i-e,n-t],u=Math.sqrt(Math.pow(d[0],2)+Math.pow(d[1],2)),c=[d[0]/u,d[1]/u],h=s[0]*c[0]+s[1]*c[1],v=[e+h*c[0],t+h*c[1]],g=Math.sqrt(Math.pow(r-v[0],2)+Math.pow(o-v[1],2));a=0===g?l:Math.sqrt(Math.pow(l,2)-Math.pow(g,2));var p=[e+h*c[0]+a*c[0],t+h*c[1]+a*c[1]];return p[0]===e&&p[1]===t?null:p}function Ji(e,t,i,n,r,o,l){var a=[r-e,o-t],s=[i-e,n-t],d=[-s[1],s[0]],u=Math.sqrt(Math.pow(d[0],2)+Math.pow(d[1],2)),c=[d[0]/u,d[1]/u],h=a[0]*c[0]+a[1]*c[1],v=Ai([e,t],[i,n],[r,o]);if(Ci([v[0]-r,v[1]-o])>=l)return null;var g=Math.sqrt(Math.pow(l,2)-Math.pow(h,2)),p=[r-h*c[0],o-h*c[1]],y=Math.sqrt(Math.pow(s[0],2)+Math.pow(s[1],2)),f=[s[0]/y,s[1]/y],m=[[p[0]-f[0]*g,p[1]-f[1]*g],[p[0]+f[0]*g,p[1]+f[1]*g]];return m[0][0]===e&&m[0][1]===t?null:m}function ji(e,t,i,n,r,o,l,a){var s,d,u,c,h,v;return-(u=l-r)*(d=n-t)+(s=i-e)*(c=a-o)==0?null:(v=(u*(t-o)-c*(e-r))/(-u*d+s*c),(h=(-d*(e-r)+s*(t-o))/(-u*d+s*c))>=0&&h<=1&&v>=0&&v<=1?[e+v*s,t+v*d]:null)}function Ti(e,t,i,n,r,o,l,a,s,d){var u=Ii(o,l,a,s,d),c=[];if(i[0]&&!i[1])c.push(zi(e,t,n,r,o,l,d)),c.push(ji(e,t,n,r,u[0][0],u[0][1],u[3][0],u[3][1])),c.push(ji(e,t,n,r,u[1][0],u[1][1],u[2][0],u[2][1])),(h=Ji(e,t,n,r,a,s,d))&&c.push(h[0],h[1]);else if(!i[0]&&i[1])c.push(zi(e,t,n,r,a,s,d)),c.push(ji(e,t,n,r,u[0][0],u[0][1],u[3][0],u[3][1])),c.push(ji(e,t,n,r,u[1][0],u[1][1],u[2][0],u[2][1])),(h=Ji(e,t,n,r,o,l,d))&&c.push(h[0],h[1]);else if(i[0]&&i[1])c.push(zi(e,t,n,r,o,l,d)),c.push(ji(e,t,n,r,u[0][0],u[0][1],u[3][0],u[3][1])),c.push(ji(e,t,n,r,u[1][0],u[1][1],u[2][0],u[2][1])),c.push(zi(e,t,n,r,a,s,d));else{var h=Ji(e,t,n,r,a,s,d),v=Ji(e,t,n,r,o,l,d);h&&c.push(h[0],h[1]),v&&c.push(v[0],v[1]),c.push(ji(e,t,n,r,u[0][0],u[0][1],u[3][0],u[3][1])),c.push(ji(e,t,n,r,u[1][0],u[1][1],u[2][0],u[2][1]))}for(var g=[e,t],p=0;p<c.length;p++)c[p]&&_i(c[p][0],c[p][1],n,r)<_i(g[0],g[1],n,r)&&(g=c[p]);return g[0]===e&&g[1]===t?null:g}function $i(e,t,i,n,r,o,l,a,s){var d=Ii(r,o,l,a,s),u=[],c=Ji(e,t,i,n,r,o,s);c&&u.push(c[0],c[1]),(c=Ji(e,t,i,n,l,a,s))&&u.push(c[0],c[1]),u.push(ji(e,t,i,n,d[0][0],d[0][1],d[3][0],d[3][1])),u.push(ji(e,t,i,n,d[1][0],d[1][1],d[2][0],d[2][1]));for(var h=[i,n],v=[e,t],g=0;g<u.length;g++)u[g]&&_i(u[g][0],u[g][1],e,t)<_i(h[0],h[1],e,t)&&(h=u[g]);for(var p=0;p<u.length;p++)u[p]&&_i(u[p][0],u[p][1],i,n)<_i(v[0],v[1],i,n)&&(v=u[p]);return h[0]===i&&h[1]===n||v[0]===e&&v[1]===t?null:[h,v]}var Ci=function(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])},Ai=function(e,t,i){var n=[t[0]-e[0],t[1]-e[1]],r=Ci(n);if(r<1e-6)return e;var o=[i[0]-e[0],i[1]-e[1]],l=(n[0]*o[0]+n[1]*o[1])/r;return l<0?e:l>r?t:[e[0]+n[0]*l/r,e[1]+n[1]*l/r]};class Bi{constructor(){let{nodeId:e,element:t,attribute:i,size:n}=je(Math.ceil(1e9*Math.random()));Ge(t,{stroke:"#ddd",strokeWidth:10,strokeLinecap:"round",strokeLinejoin:"round"});let r="";return{start:e=>{r=`M ${e.x} ${e.y} L ${e.x} ${e.y}`},move:(e,i)=>{((e,i)=>{r+=` ${e} ${i}`,t.setAttribute("d",r)})(e.x,e.y)},end:(e,i)=>{t.remove(),(e=>{let t=9999,i=9999,r=-9999,o=-9999;e.forEach((e=>{t=Math.min(t,e[0]),i=Math.min(i,e[1]),r=Math.max(r,e[0]),o=Math.max(o,e[1])})),n=te(t,i,r,o,{points:e}),nn.data.getNodeInArea(0,0,1920,1920,a.PATH).forEach((t=>{let i=((e,t,i)=>{i=i||20;var n=[],r=function(e){var r=t[0][0],o=t[0][1],l=0,a=0;if(1!==e.length||Ni(e[0][0],e[0][1],r,o,i)){for(var s;l<e.length-1;){var d=e[l],u=e[l+1],c=Ni(d[0],d[1],r,o,i),h=Ni(u[0],u[1],r,o,i);if(c&&h)a=++l;else if(c&&!h)(v=zi(d[0],d[1],u[0],u[1],r,o,i))?(e[l]=v,a=l):l++;else if(!c&&h){var v;(v=zi(u[0],u[1],d[0],d[1],r,o,i))&&((s=e.slice(a,l+1)).push(v),n.push(s)),a=++l}else{var g=Ji(d[0],d[1],u[0],u[1],r,o,i);g?((s=e.slice(a,l+1))[s.length-1][0]===g[0][0]&&s[s.length-1][1]===g[0][1]||s.push(g[0]),s.length>1&&n.push(s),e[l]=g[1],e[l+1]&&e[l+1][0]==g[1][0]&&e[l+1][1]==g[1][1]&&l++,a=l):l++}}a!==l&&(s=e.slice(a,e.length))&&n.push(s)}else n.push(e)},o=function(e,r){var o,l=t[r],a=t[r+1],s=0,d=0;if(1!==e.length||-1!==(h=Ei(e[0][0],e[0][1],l[0],l[1],a[0],a[1],i)).indexOf(1)){for(;s<e.length-1;){var u=e[s],c=e[s+1],h=Ei(u[0],u[1],l[0],l[1],a[0],a[1],i),v=Ei(c[0],c[1],l[0],l[1],a[0],a[1],i);if(-1!==h.indexOf(1)&&-1!==v.indexOf(1))d=++s;else if(-1!==h.indexOf(1)&&-1===v.indexOf(1))(g=Ti(u[0],u[1],h,c[0],c[1],l[0],l[1],a[0],a[1],i))?(e[s]=g,d=s):s++;else if(-1===h.indexOf(1)&&-1!==v.indexOf(1)){var g;(g=Ti(c[0],c[1],v,u[0],u[1],l[0],l[1],a[0],a[1],i))?((o=e.slice(d,s+1)).push(g),n.push(o),d=++s):s++}else{var p=$i(u[0],u[1],c[0],c[1],l[0],l[1],a[0],a[1],i);p?((o=e.slice(d,s+1))[o.length-1][0]===p[0][0]&&o[o.length-1][1]===p[0][1]||o.push(p[0]),o.length>1&&n.push(o),e[s]=p[1],e[s+1]&&e[s+1][0]==p[1][0]&&e[s+1][1]==p[1][1]&&s++,d=s):s++}}d!==s&&(o=e.slice(d,e.length))&&n.push(o)}else n.push(e)};if(1===(t=function(e){var t=[];if(1===e.length)t=e;else{for(var i=0;i<e.length-1;)e[i][0]===e[i+1][0]&&e[i][1]===e[i+1][1]||t.push(e[i]),i++;0!==e.length&&0===t.length&&t.push(e[0]),e[e.length-1][0]===e[t.length-1][0]&&e[e.length-1][1]===e[t.length-1][1]||t.push(e[i])}return t}(t)).length){for(var l=0;l<e.length;l++)r(e[l]);e=n}else for(var a=0;a<t.length-1;a++){for(l=0;l<e.length;l++)o(e[l],a);e=n,n=[]}for(var s=0;s<e.length;s++)for(var d=0;d<e[s].length;d++)e[s][d][0]=Math.round(e[s][d][0]),e[s][d][1]=Math.round(e[s][d][1]);return e})(nn.data.getNode(t).size.points,e,2);console.log(i)}))})(i)}}}}class Ri{constructor(){let e=We(r.CREATE_GROUP,"g"),{nodeId:t,element:i,attribute:n,size:o,source:l}=de(Math.ceil(1e9*Math.random())),s=(t,r,l,s)=>{o=te(t,r,l,s),o.x=B(o.x),o.y=B(o.y),o.width=B(o.width),o.height=B(o.height),Object.assign(n,ie(a.TEXT,o,n)),Ge(i,n),Ve(e,o)};return{start:e=>{s(e.x,e.y,e.x+o.width,e.y+o.height)},move:(e,t)=>{s(t[0][0],t[0][1],e.x,e.y)},end:(r,s)=>{o.width<100&&(o.width=100),o.height<20&&(o.height=20),o.width+o.height<8&&(o.width=100,o.height=20,o.x=o.x-o.width/2,o.y=o.y-o.height/2,Object.assign(n,ie(a.TEXT,o,n)),Ge(i,n)),nn.data.node=Object.assign({id:t,type:a.TEXT,name:"Text"},{size:o,attribute:n,source:l}),null==e||e.remove()}}}}const Mi=e=>{var t,i,n,o,l,a,s;let d=(null===(t=e.mouseEvent)||void 0===t?void 0:t.target)||(null===(i=e.touchEvent)||void 0===i?void 0:i.target),u=(null==d?void 0:d.getAttribute("id"))||"",c=null==d?void 0:d.nodeName,h=jQuery(d).parents("g[id]").attr("id")||"";if(![r.INDEX_GROUP].includes(h))if((null===(n=e.mouseEvent)||void 0===n?void 0:n.altKey)||(null===(o=e.touchEvent)||void 0===o?void 0:o.altKey)||!u||u.match(/[^0-9]/)||!nn.dataSelect.nodeName.includes(c))nn.dataSelect.ids.length&&(nn.dataSelect.ids=[]),(0==(null===(l=e.mouseEvent)||void 0===l?void 0:l.button)||e.touchEvent)&&((e,t)=>{let i=We(r.SCAN_GROUP,"g"),n=te(0,0,1,1);Ye(i,n),((e,t,i,n)=>{ot(e,{start:e=>{},move:(e,n)=>{var r,o,l,a;r=n[0][0],o=n[0][1],l=e.x,a=e.y,t=te(r,o,l,a),Ye(i,t)},end:(e,t)=>{null==i||i.remove(),nn.dataSelect.ids=nn.data.getNodeInArea(Math.min(t[0][0],e.x),Math.min(t[0][1],e.y),Math.max(t[0][0],e.x),Math.max(t[0][1],e.y));let r=nn.dataSelect.nodes;n(r)}})})(e,n,i,t)})(e,Li);else{let t=parseFloat(u||"0");(null===(a=e.mouseEvent)||void 0===a?void 0:a.shiftKey)||(null===(s=e.touchEvent)||void 0===s?void 0:s.shiftKey)?nn.dataSelect.ids=[t].concat(nn.dataSelect.ids).filter(((e,t,i)=>i.indexOf(e)==t)):nn.dataSelect.ids=[t];let i=nn.dataSelect.nodes;Li(i)}},Li=e=>{var t,i,n,o,l,a;let s=1;if(e.length&&(s=Math.max.apply(null,null!==(n=null===(i=null===(t=nn.data.slide)||void 0===t?void 0:t.svg)||void 0===i?void 0:i.nodes.map((e=>{var t;return null!==(t=e.idx)&&void 0!==t?t:0})))&&void 0!==n?n:[0])+1),1==e.length)e[0].idx||(e[0].idx=s,e[0].time=0);else if(e.length>=0){let t=e.map((e=>{var t;return null!==(t=e.idx)&&void 0!==t?t:0})).filter((e=>e>0)),i=t.length?Math.min.apply(null,t):s;e.forEach((e=>{var t;e.idx=i,e.time=null!==(t=e.time)&&void 0!==t?t:0}))}let d=We(r.INDEX_GROUP,"g");et(d,null!==(a=null===(l=null===(o=nn.data.slide)||void 0===o?void 0:o.svg)||void 0===l?void 0:l.nodes)&&void 0!==a?a:[])},Pi=e=>{var t,i,n,o;(null===(t=null==e?void 0:e.svg)||void 0===t?void 0:t.nodes)&&e.svg.nodes.forEach((e=>{e.idx=0,e.time=null}));let l=We(r.INDEX_GROUP,"g");et(l,null!==(o=null===(n=null===(i=nn.data.slide)||void 0===i?void 0:i.svg)||void 0===n?void 0:n.nodes)&&void 0!==o?o:[])},Fi=e=>{new Me(e.container,e.target);var t=(t,i,n,r)=>{switch(t){case o.POINTER:jQuery(e.target).css({cursor:"auto"});break;case o.HAND:r?jQuery(e.target).css({cursor:"grabbing"}):jQuery(e.target).css({cursor:"grab"});break;case o.PEN:switch(i){case l.DRAW:jQuery(e.target).css({cursor:"url(assets/images/svg/icon/viet.png) 12 32,default"});break;case l.HIGHTLIGH:jQuery(e.target).css({cursor:"url(assets/images/svg/icon/highlight1.png) 12 32,default"})}break;case o.ERASER:jQuery(e.target).css({cursor:"url(assets/images/svg/icon/gom.png) 22 22,default"});break;case o.SHAPE:jQuery(e.target).css({cursor:"url(assets/images/svg/icon/point.png) 22 22,default"});break;case o.TEXT:case o.FOREIGNOBJECT:jQuery(e.target).css({cursor:"url(assets/images/svg/icon/textmouse.png) 22 22,default"})}};nn.pointer.onchange=(e,i,n)=>{t(e,i)},jQuery(e.container).off("mousedown.icdt-init-icon").on("mousedown.icdt-init-icon",(e=>{t(nn.pointer.pointer_type,void 0,0,!0)})).off("mouseup.icdt-init-icon").on("mouseup.icdt-init-icon",(e=>{t(nn.pointer.pointer_type,void 0,0,!1)})),document.addEventListener("wheel",(e=>{e.ctrlKey&&e.preventDefault()}),{passive:!1}),jQuery(e.container).off("wheel.icdt-init").on("wheel.icdt-init",(e=>{var t;e.preventDefault();let i=null!==(t=e.originalEvent)&&void 0!==t?t:e;if(!i.deltaX&&i.deltaY!=Math.floor(i.deltaY)||i.ctrlKey){var n=nn.screen.scale,r=.04*n*(i.deltaY>0?1:-1);nn.screen.scaleTo(n-r,rt({x:e.clientX,y:e.clientY},1,{x:0,y:0},nn.screen.offset))}else nn.screen.move(nn.screen.dislocation,{x:-i.deltaX,y:-i.deltaY})})),jQuery(window).off("mousedown.icdt-init").on("mousedown.icdt-init",(e=>{nn.screen.actived=!!jQuery(e.target).parents(nn.container).length})),jQuery(e.container).off("mouseenter.icdt-init").on("mouseenter.icdt-init",(e=>{})),jQuery(e.container).off("mouseleave.icdt-init").on("mouseleave.icdt-init",(e=>{nn.pointer.pointer_type_temp==o.HAND&&(nn.pointer.pointer_type_temp=o.POINTER)})),jQuery(e.container).off("mousedown.icdt-init").on("mousedown.icdt-init",(t=>{0==t.button&&(e.container.includes("#")&&e.container.includes(t.target.getAttribute("id"))||e.container.includes(".")&&e.container.includes(t.target.getAttribute("class"))||e.container.includes(t.target.nodeName))&&(nn.pointer.pointer_type_temp||nn.pointer.pointer_type)===o.POINTER&&(nn.dataSelect.ids=[])})),jQuery(e.container).off("touchmove.icdt-init").on("touchmove.icdt-init",(e=>{e.preventDefault()}));const i=e=>{var t,i,n,r,l,s,u,c,h,v,g,p,y,f,m,b,w,S,x;switch(nn.pointer.pointer_type_temp||nn.pointer.pointer_type){case o.POINTER:"touchstart"!=(null===(t=e.touchEvent)||void 0===t?void 0:t.type)&&"mousedown"!=(null===(i=e.mouseEvent)||void 0===i?void 0:i.type)&&"dblclick"!=(null===(n=e.mouseEvent)||void 0===n?void 0:n.type)||kt(e);break;case o.HAND:"touchstart"!=(null===(r=e.touchEvent)||void 0===r?void 0:r.type)&&"mousedown"!=(null===(l=e.mouseEvent)||void 0===l?void 0:l.type)||(e=>{ot(e,new Ot,1,{x:0,y:0})})(e);break;case o.PEN:"touchstart"!=(null===(s=e.touchEvent)||void 0===s?void 0:s.type)&&"mousedown"!=(null===(u=e.mouseEvent)||void 0===u?void 0:u.type)||ki(e);break;case o.SHAPE:"touchstart"!=(null===(c=e.touchEvent)||void 0===c?void 0:c.type)&&"mousedown"!=(null===(h=e.mouseEvent)||void 0===h?void 0:h.type)||(e=>{var t,i=null;switch(nn.pointer.shape_type){case a.CIRCLE:i=new _t;break;case a.ELLIPSE:i=new Nt;break;case a.LINE:i=new zt;break;case a.RECT:i=new Et;break;case a.POLYGON:i=new It(null===(t=d.find((e=>e.type==nn.pointer.polygon_type)))||void 0===t?void 0:t.ratios);break;case a.FOREIGNOBJECT:i=new jt;break;case a.IMAGE:i=new Tt;break;case a.TEXT:case a.PATH:i=new Jt}i&&ot(e,i)})(e);break;case o.FOREIGNOBJECT:"touchstart"!=(null===(v=e.touchEvent)||void 0===v?void 0:v.type)&&"mousedown"!=(null===(g=e.mouseEvent)||void 0===g?void 0:g.type)||(e=>{ot(e,new jt)})(e);break;case o.IMAGE:"touchstart"!=(null===(p=e.touchEvent)||void 0===p?void 0:p.type)&&"mousedown"!=(null===(y=e.mouseEvent)||void 0===y?void 0:y.type)||(e=>{ot(e,new Tt)})(e);break;case o.TEXT:"touchstart"!=(null===(f=e.touchEvent)||void 0===f?void 0:f.type)&&"mousedown"!=(null===(m=e.mouseEvent)||void 0===m?void 0:m.type)||(e=>{ot(e,new Ri)})(e);break;case o.ERASER:"touchstart"!=(null===(b=e.touchEvent)||void 0===b?void 0:b.type)&&"mousedown"!=(null===(w=e.mouseEvent)||void 0===w?void 0:w.type)||(e=>{ot(e,new Bi)})(e);break;case o.INDEX:"touchstart"!=(null===(S=e.touchEvent)||void 0===S?void 0:S.type)&&"mousedown"!=(null===(x=e.mouseEvent)||void 0===x?void 0:x.type)||Mi(e)}};let n=!1;jQuery(e.target).off("touchstart.icdt-init").on("touchstart.icdt-init",(e=>{n=!0,i({touchEvent:e})})),jQuery(e.target).off("mousedown.icdt-init").on("mousedown.icdt-init",(e=>{1!=e.button&&(n?n=!1:i({mouseEvent:e}))})),jQuery(e.target).off("dblclick.icdt-init").on("dblclick.icdt-init",(e=>{1!=e.button&&(n?n=!1:i({mouseEvent:e}))})),e.iskeyboard&&(jQuery(window).off("keydown.icdt-init").on("keydown.icdt-init",(e=>{e.keyCode||e.which||e.charCode,nn.screen.actived&&(nn.dataSelect.contenteditable_id||((e.ctrlKey||e.altKey)&&(e.stopPropagation(),e.preventDefault()),ni(e)))})),jQuery(window).off("keyup.icdt-init").on("keyup.icdt-init",(e=>{e.keyCode||e.which||e.charCode,nn.screen.actived&&(nn.dataSelect.contenteditable_id||((e.ctrlKey||e.altKey)&&(e.stopPropagation(),e.preventDefault()),ni(e)))})))};class Ki{constructor(){this._nodeName=["circle","ellipse","line","polygon","polyline","rect","text","tspan","path","image","foreignObject"],this._selected_Ids=[],this._contenteditable_Id=0,this._fnChanges=[]}get nodeName(){return this._nodeName}get ids(){return this._selected_Ids}set ids(e){this._selected_Ids=e,this.closeEditable(),this.change(this.ids)}get contenteditable_id(){return this._contenteditable_Id}get nodes(){return this._selected_Ids.map((e=>nn.data.getNode(e))).filter((e=>!e.isfake))}set onchange(e){this._fnChanges.push(e)}change(e){this.cleanSelected(),this._fnChanges.forEach((t=>t(e)))}deleteNode(){for(let e of this._selected_Ids){let t=nn.data.deleteNode(e);nn.history.push([{type:"delete",from:{id:t},to:{id:t}}])}nn.dataSelect.ids=[]}groupNode(){let e=[];if(nn.dataSelect.ids.length>=2){let t=nn.data.getNode(nn.dataSelect.ids[0]),{nodeId:i,attribute:n,size:r}=ue(Math.ceil(1e9*Math.random()),void 0,t.pid?window.document.getElementById(t.pid):null);nn.data.node=Object.assign({id:i,type:a.GROUP,name:"G"},{size:r,attribute:n});for(let t of nn.dataSelect.ids)e.push(nn.data.addGroup(t,i))}e.length&&(nn.dataSelect.ids=e,ct(nn.dataSelect.nodes))}ungroupNode(){let e=[];for(let t of nn.dataSelect.ids)e.push(nn.data.unGroup(t));e.length&&(nn.dataSelect.ids=e,ct(nn.dataSelect.nodes))}cleanSelected(){var e,t,i,n,o;null===(e=window.document.getElementById(r.RESIZE_GROUP))||void 0===e||e.remove(),null===(t=window.document.getElementById(r.SELECT_GROUP))||void 0===t||t.remove(),null===(i=window.document.getElementById(r.SCAN_GROUP))||void 0===i||i.remove(),null===(n=window.document.getElementById(r.CREATE_GROUP))||void 0===n||n.remove(),null===(o=window.document.getElementById(r.INTERACTIVE_GROUP))||void 0===o||o.remove(),jQuery('[id^="icdt-temp-"]').remove()}openEditable(){1==this._selected_Ids.length&&(this._contenteditable_Id=this._selected_Ids[0]);let e=nn.data.getNode(this._contenteditable_Id);if(e.id){let{id:t,source:i,size:n,attribute:r,style:o}=e;Ke(t,a.FOREIGNOBJECT,"foreignObject",{source:i,size:n,attribute:r,style:o})}this.cleanSelected()}closeEditable(){if(!this._contenteditable_Id)return;let e=nn.data.getNode(this._contenteditable_Id);if(e.id){this._contenteditable_Id=0;let{id:t,type:i,source:n,size:r,attribute:o,style:l}=e;Ke(t,i,void 0,{source:n,size:r,attribute:o,style:l}),this.cleanSelected(),ct(nn.dataSelect.nodes)}}}class Gi{createNodeImage(e,t){var i,n,r,o;let{nodeId:l,element:s,size:d,attribute:u,source:c}=L(Math.ceil(1e9*Math.random()),{size:{x:(null!==(i=null==t?void 0:t.x)&&void 0!==i?i:50)-50,y:(null!==(n=null==t?void 0:t.y)&&void 0!==n?n:50)-50,width:100,height:100},source:{type:"image",image:we(e)}});(e=>{if(!e)return;let t=new Image;t.onload=()=>{let e=B(t.naturalWidth/t.naturalHeight,100);e>=1?(d.width=Math.min(t.naturalWidth,512),d.height=B(d.width/e,100)):(d.height=Math.min(t.naturalHeight,512),d.width=B(d.height*e,100)),d.x=B(d.x+50-d.width/2,100),d.y=B(d.y+50-d.height/2,100),Object.assign(u,ie(a.IMAGE,d,u)),Ge(s,u),nn.data.node=Object.assign({id:l,type:a.IMAGE,name:"Image"},{size:d,attribute:u,source:c})},t.onerror=t=>{console.error(`ImgSrc load failed -> ${e}`,t),null==s||s.remove()},t.src=e})(null!==(o=null===(r=c.image)||void 0===r?void 0:r.url)&&void 0!==o?o:"")}createNodeIframe(e,t){var i,n;let{nodeId:r,element:o,size:l,attribute:s,style:d,source:u}=Je(Math.ceil(1e9*Math.random()),{size:{x:(null!==(i=null==t?void 0:t.x)&&void 0!==i?i:50)-50,y:(null!==(n=null==t?void 0:t.y)&&void 0!==n?n:50)-50,width:100,height:100},style:{},source:{type:"iframe",iframe:we(e)}});(()=>{var e,t;let i=(null===(t=null===(e=nn.data.slide)||void 0===e?void 0:e.svg)||void 0===t?void 0:t.viewBox)||{x:0,y:0,width:100,height:100},n=B(i.width/i.height,100);n>=1?(l.width=Math.min(i.width,512),l.height=B(l.width/n,100)):(l.height=Math.min(i.height,512),l.width=B(l.height*n,100)),l.x=B(l.x+50-l.width/2,100),l.y=B(l.y+50-l.height/2,100),Object.assign(s,ie(a.IMAGE,l,s)),Ge(o,s),nn.data.node=Object.assign({id:r,type:a.FOREIGNOBJECT,name:"ForeignObject"},{size:l,attribute:s,style:d,source:u})})()}createNodeEmbed(e,t){var i,n;let r={x:50,y:50,width:640,height:360};e.type==c.AUDIO&&(r.width=480,r.height=80);let{nodeId:o,element:l,size:s,attribute:d,style:u,source:h}=Je(Math.ceil(1e9*Math.random()),{size:{x:(null!==(i=null==t?void 0:t.x)&&void 0!==i?i:r.x)-r.x,y:(null!==(n=null==t?void 0:t.y)&&void 0!==n?n:r.y)-r.y,width:r.width,height:r.height},style:{},source:{type:"embed",embed:Object.assign(e,we(e))}});(()=>{let e=B(r.width/r.height,100);e>=1?(s.width=Math.min(s.width,r.width),s.height=B(s.width/e,1)):(s.height=Math.min(s.height,r.height),s.width=B(s.height*e,1)),s.x=B(s.x+r.x-s.width/2,1),s.y=B(s.y+r.y-s.height/2,1),Object.assign(d,ie(a.FOREIGNOBJECT,s,d)),Ge(l,d),nn.data.node=Object.assign({id:o,type:a.FOREIGNOBJECT,name:"ForeignObject"},{size:s,attribute:d,style:u,source:h})})()}createNodeMedia(e,t){var i,n,r,o;let{nodeId:l,element:s,size:d,attribute:u,source:c}=L(Math.ceil(1e9*Math.random()),{size:{x:(null!==(i=null==t?void 0:t.x)&&void 0!==i?i:50)-50,y:(null!==(n=null==t?void 0:t.y)&&void 0!==n?n:50)-50,width:100,height:100},source:{type:"image",image:we(e.cover)}}),h={click:{media:e.media}};(e=>{if(!e)return;let t=new Image;t.onload=()=>{let e=B(t.naturalWidth/t.naturalHeight,100);e>=1?(d.width=Math.min(t.naturalWidth,512),d.height=B(d.width/e,100)):(d.height=Math.min(t.naturalHeight,512),d.width=B(d.height*e,100)),d.x=B(d.x+50-d.width/2,100),d.y=B(d.y+50-d.height/2,100),Object.assign(u,ie(a.IMAGE,d,u)),Ge(s,u),nn.data.node=Object.assign({id:l,type:a.IMAGE,name:"Image"},{size:d,attribute:u,source:c,interactive:h})},t.onerror=t=>{console.error(`ImgSrc load failed -> ${e}`,t),null==s||s.remove()},t.src=e})(null!==(o=null===(r=c.image)||void 0===r?void 0:r.url)&&void 0!==o?o:"")}createNodeText(e,t){var i,n;let{nodeId:r,element:o,size:l,attribute:s,style:d,source:u}=Je(Math.ceil(1e9*Math.random()),{size:{x:(null!==(i=null==t?void 0:t.x)&&void 0!==i?i:0)-0,y:(null!==(n=null==t?void 0:t.y)&&void 0!==n?n:0)-0,width:320,height:80},style:{},source:{type:"html",html:{htmlContent:`<span style="font-family: Roboto; font-size: 24px;">${e.content}</span>`}}});(()=>{let e=B(4,100);e>=1?(l.width=Math.min(l.width,320),l.height=B(l.width/e,1)):(l.height=Math.min(l.height,80),l.width=B(l.height*e,1)),l.x=B(l.x+0-l.width/2,1),l.y=B(l.y+0-l.height/2,1),Object.assign(s,ie(a.FOREIGNOBJECT,l,s)),Ge(o,s),nn.data.node=Object.assign({id:r,type:a.FOREIGNOBJECT,name:"ForeignObject"},{size:l,attribute:s,style:d,source:u})})()}insert(e){var t;if(nn.data.insertSlide(nn.data.slideId,1),e.title){let{nodeId:t,size:i,attribute:n,style:r,source:o}=Je(Math.ceil(1e9*Math.random()),{size:{x:100,y:100,width:800,height:150},source:{type:"html",html:{htmlContent:`<span style="font-size: 40px;">${e.title}</span>`}}});nn.data.node=Object.assign({id:t,type:a.FOREIGNOBJECT,name:"ForeignObject"},{size:i,attribute:n,style:r,source:o})}if(e.description){let{nodeId:t,size:i,attribute:n,style:r,source:o}=Je(Math.ceil(1e9*Math.random()),{size:{x:100,y:300,width:600,height:300},source:{type:"html",html:{htmlContent:`<span style="font-size: 24px;">${e.description.replace(/\n/g,"<br/>")}</span>`}}});nn.data.node=Object.assign({id:t,type:a.FOREIGNOBJECT,name:"ForeignObject"},{size:i,attribute:n,style:r,source:o})}(null===(t=e.media)||void 0===t?void 0:t.prompt)&&((()=>{let{nodeId:e,size:t,attribute:i}=M(Math.ceil(1e9*Math.random()),{size:{x:775,y:275,width:350,height:350},attribute:{fill:"#FFFFFF",stroke:"#E6E6E6",strokeWidth:1,strokeDasharray:1,rx:4}});nn.data.node=Object.assign({id:e,type:a.RECT,name:"Rect"},{size:t,attribute:i})})(),(()=>{var t;let{nodeId:i,size:n,attribute:r,style:o,source:l}=Je(Math.ceil(1e9*Math.random()),{size:{x:800,y:300,width:300,height:300},source:{type:"html",html:{htmlContent:`<span style="font-size: 18px; color: #6633cc"><i>${null===(t=e.media)||void 0===t?void 0:t.prompt}</i></span>`}}});nn.data.node=Object.assign({id:i,type:a.FOREIGNOBJECT,name:"ForeignObject"},{size:n,attribute:r,style:o,source:l})})())}}class Di{get newSlideId(){return Math.ceil(1e9*Math.random())}get _defaultSlide(){return JSON.parse(JSON.stringify({id:this.newSlideId,name:"Trang mới",svg:{viewBox:nn.screen.frameSize,nodes:[]}}))}constructor(){this._dataSource={slides:[],resources:[]},this._slideIdx=0,this._fnChangeSlides=[],this.getNodeAll=()=>{var e;let t=null===(e=this._dataSource.slides)||void 0===e?void 0:e.find(((e,t)=>t==this._slideIdx)),i=null==t?void 0:t.svg,n=e=>{let t=[];return e.filter((e=>!e.isdeleted)).forEach((e=>{e.type==a.GROUP?t=t.concat(n(e.nodes||[])):t.push(e.id)})),t};return n((null==i?void 0:i.nodes)||[])}}get get(){var e;let t=e=>(null==e||e.filter((e=>e.type==a.GROUP)).forEach((e=>{var i;e.nodes=t(null===(i=e.nodes)||void 0===i?void 0:i.filter((e=>!e.isdeleted)))})),e=null==e?void 0:e.filter((e=>{var t,i;return e.type!=a.GROUP||(null!==(i=null===(t=e.nodes)||void 0===t?void 0:t.length)&&void 0!==i?i:0)>0})),e||[]);return null===(e=this._dataSource.slides)||void 0===e||e.forEach((e=>{var i,n;e.svg&&(e.svg.nodes=t(null===(n=null===(i=e.svg)||void 0===i?void 0:i.nodes)||void 0===n?void 0:n.filter((e=>!e.isdeleted))))})),this._dataSource}get getResource(){var e;let t=[];return null===(e=this._dataSource.slides)||void 0===e||e.forEach((e=>{var i,n,r,o,l,a,s,d,u,c,h,v,g,p,y;t.push(null===(n=null===(i=e.svg)||void 0===i?void 0:i.background)||void 0===n?void 0:n.path),null===(r=e.svg)||void 0===r||r.nodes.forEach((e=>{var i,n,r,o,l,a,s,d,u,c,h,v,g,p,y,f,m,b,w,S,x,k,O,_,N,E,I,z,J,j;t.push(null===(n=null===(i=e.source)||void 0===i?void 0:i.image)||void 0===n?void 0:n.path),t.push(null===(o=null===(r=e.source)||void 0===r?void 0:r.audio)||void 0===o?void 0:o.path),t.push(null===(a=null===(l=e.source)||void 0===l?void 0:l.video)||void 0===a?void 0:a.path),t.push(null===(d=null===(s=e.source)||void 0===s?void 0:s.file)||void 0===d?void 0:d.path),t.push(null===(c=null===(u=e.source)||void 0===u?void 0:u.iframe)||void 0===c?void 0:c.path),t.push(null===(v=null===(h=e.source)||void 0===h?void 0:h.embed)||void 0===v?void 0:v.path),t.push(null===(p=null===(g=e.source)||void 0===g?void 0:g.track)||void 0===p?void 0:p.path),t.push(null===(b=null===(m=null===(f=null===(y=e.interactive)||void 0===y?void 0:y.show)||void 0===f?void 0:f.audio)||void 0===m?void 0:m.source)||void 0===b?void 0:b.path),t.push(null===(k=null===(x=null===(S=null===(w=e.interactive)||void 0===w?void 0:w.click)||void 0===S?void 0:S.audio)||void 0===x?void 0:x.source)||void 0===k?void 0:k.path),t.push(null===(E=null===(N=null===(_=null===(O=e.interactive)||void 0===O?void 0:O.click)||void 0===_?void 0:_.image)||void 0===N?void 0:N.source)||void 0===E?void 0:E.path),t.push(null===(j=null===(J=null===(z=null===(I=e.interactive)||void 0===I?void 0:I.click)||void 0===z?void 0:z.video)||void 0===J?void 0:J.source)||void 0===j?void 0:j.path)})),t.push(null===(l=null===(o=e.test)||void 0===o?void 0:o.audiotrue)||void 0===l?void 0:l.path),t.push(null===(s=null===(a=e.test)||void 0===a?void 0:a.audiofalse)||void 0===s?void 0:s.path),t.push(null===(u=null===(d=e.test)||void 0===d?void 0:d.effecttrue)||void 0===u?void 0:u.path),t.push(null===(h=null===(c=e.test)||void 0===c?void 0:c.effectfalse)||void 0===h?void 0:h.path),t.push(null===(g=null===(v=e.test)||void 0===v?void 0:v.icontrue)||void 0===g?void 0:g.path),t.push(null===(y=null===(p=e.test)||void 0===p?void 0:p.iconfalse)||void 0===y?void 0:y.path)})),t.filter((e=>e)).map((e=>e.replace(/(\?|\#)[^\?\#]+/g,"").toLowerCase())).filter(((e,t,i)=>i.indexOf(e)==t))}get getFonts(){var e;return I(JSON.stringify(null!==(e=this._dataSource.slides)&&void 0!==e?e:[]))}set set(e){this._dataSource=e,this._dataSource.slides||(this._dataSource.slides=[]),this._dataSource.slides.length||(this._slideIdx=0,this._dataSource.slides.push(JSON.parse(JSON.stringify(this._defaultSlide)))),Fe(),this.changeSlide(this.slides,this.slideIdx,this._dataSource.slides.length,this.slide)}get dataSource(){var e;let t=e=>(null==e||e.filter((e=>e.type==a.GROUP)).forEach((e=>{var i;e.nodes=t(null===(i=e.nodes)||void 0===i?void 0:i.filter((e=>!e.isdeleted)))})),e=null==e?void 0:e.filter((e=>{var t,i;return e.type!=a.GROUP||(null!==(i=null===(t=e.nodes)||void 0===t?void 0:t.length)&&void 0!==i?i:0)>0})),e||[]);return null===(e=this._dataSource.slides)||void 0===e||e.forEach((e=>{var i,n;e.svg&&(e.svg.nodes=t(null===(n=null===(i=e.svg)||void 0===i?void 0:i.nodes)||void 0===n?void 0:n.filter((e=>!e.isdeleted))))})),this._dataSource.resources=this.getResource,this._dataSource}set dataSource(e){this._dataSource=e,this._dataSource.slides||(this._dataSource.slides=[]),this._dataSource.slides.length||(this._slideIdx=0,this._dataSource.slides.push(JSON.parse(JSON.stringify(this._defaultSlide)))),Fe(),this.changeSlide(this.slides,this.slideIdx,this._dataSource.slides.length,this.slide)}get slideId(){var e,t;return null!==(t=null===(e=this.slide)||void 0===e?void 0:e.id)&&void 0!==t?t:0}get slideIdx(){return this._slideIdx}get slide(){var e;return null===(e=this._dataSource.slides)||void 0===e?void 0:e.find(((e,t)=>t==this._slideIdx))}get slides(){return this._dataSource.slides||[]}backSlide(){this._slideIdx>0&&(this._slideIdx-=1,this.openSlide(void 0,this._slideIdx))}nextSlide(){var e,t;this._slideIdx<(null!==(t=null===(e=this._dataSource.slides)||void 0===e?void 0:e.length)&&void 0!==t?t:0)-1&&(this._slideIdx+=1,this.openSlide(void 0,this._slideIdx))}refreshSlide(){Fe(),Ht(this.slide)}openSlide(e,t){var i,n,r,o,l,a,s,d,u,c;if(e){for(let t=0,o=null!==(n=null===(i=this._dataSource.slides)||void 0===i?void 0:i.length)&&void 0!==n?n:0;t<o;t++)if((null!==(r=this._dataSource.slides)&&void 0!==r?r:[])[t].id==e){this._slideIdx=t;break}}else t&&t>=0&&t<(null!==(l=null===(o=this._dataSource.slides)||void 0===o?void 0:o.length)&&void 0!==l?l:0)?this._slideIdx=null!=t?t:0:(this._slideIdx=0,(null===(a=this._dataSource.slides)||void 0===a?void 0:a.length)||(this._dataSource.slides=[JSON.parse(JSON.stringify(this._defaultSlide))]));Fe(),(null===(d=null===(s=this.slide)||void 0===s?void 0:s.svg)||void 0===d?void 0:d.viewBox)&&(nn.screen.frameSize=this.slide.svg.viewBox),Ht(this.slide),this.changeSlide(this.slides,this.slideIdx,null!==(c=null===(u=this._dataSource.slides)||void 0===u?void 0:u.length)&&void 0!==c?c:0,this.slide)}addSlide(){var e,t,i;null===(e=this._dataSource.slides)||void 0===e||e.push(this._defaultSlide),this._slideIdx=(null!==(i=null===(t=this._dataSource.slides)||void 0===t?void 0:t.length)&&void 0!==i?i:0)-1,this.openSlide(void 0,this._slideIdx)}tryMergeSlide(e,t,i){var n,r,o;let l=null===(n=this._dataSource.slides)||void 0===n?void 0:n.find((t=>t.id==e));return l?(null===(r=l.test)||void 0===r?void 0:r.type)&&(null===(o=t.test)||void 0===o?void 0:o.type)?"boolean"!=typeof i?-1:i?this.mergeSlide(e,l,t):this.insertSlide(e,1,t):this.mergeSlide(e,l,t):this.insertSlide(e,1,t)}tryReplaceSlide(e,t){var i,n,r,o,l;let a=null===(i=this._dataSource.slides)||void 0===i?void 0:i.find((t=>t.id==e));if(!a||(null===(n=null==a?void 0:a.svg)||void 0===n?void 0:n.nodes.filter((e=>!e.isdeleted)).length))return this.insertSlide(e,1,t);let s=null!==(o=null===(r=this._dataSource.slides)||void 0===r?void 0:r.indexOf(a))&&void 0!==o?o:0;return null===(l=this._dataSource.slides)||void 0===l||l.splice(s,1,t),this._slideIdx=s,this.openSlide(void 0,this._slideIdx),1}mergeSlide(e,t,i){var n,r,o,l;return t.test=null!==(n=i.test)&&void 0!==n?n:t.test,t.audio=null!==(r=i.audio)&&void 0!==r?r:t.audio,t.svg?t.svg.nodes=t.svg.nodes.concat(null!==(l=null===(o=i.svg)||void 0===o?void 0:o.nodes)&&void 0!==l?l:[]):t.svg=i.svg,this.openSlide(e),1}insertSlide(e,t,i){var n,r,o,l,a,s;let d=null!==(r=null===(n=this._dataSource.slides)||void 0===n?void 0:n.find((t=>t.id==e)))&&void 0!==r?r:this._defaultSlide,u=(null!==(l=null===(o=this._dataSource.slides)||void 0===o?void 0:o.indexOf(d))&&void 0!==l?l:0)+t;return i?(i.id=this.newSlideId,i.code=void 0,i.name||(i.name="Trang mới"),(null===(a=i.svg)||void 0===a?void 0:a.viewBox)||i.svg&&(i.svg.viewBox=nn.screen.frameSize)):i=this._defaultSlide,null===(s=this._dataSource.slides)||void 0===s||s.splice(u,0,i),this._slideIdx=u,this.openSlide(void 0,this._slideIdx),1}copySlide(e){var t,i,n,r,o,l,a;let s=null!==(i=null===(t=this._dataSource.slides)||void 0===t?void 0:t.find((t=>t.id==e)))&&void 0!==i?i:this._defaultSlide,d=(null!==(r=null===(n=this._dataSource.slides)||void 0===n?void 0:n.indexOf(s))&&void 0!==r?r:0)+1,u=Object.assign(JSON.parse(JSON.stringify(s)),{id:this.newSlideId,code:void 0,name:`${s.name} + (Copy)`});null===(o=this._dataSource.slides)||void 0===o||o.splice(d,0,u),this.changeSlide(this.slides,this.slideIdx,null!==(a=null===(l=this._dataSource.slides)||void 0===l?void 0:l.length)&&void 0!==a?a:0,this.slide)}moveSlide(e,t){var i,n,r,o,l,a;let s=null!==(n=null===(i=this._dataSource.slides)||void 0===i?void 0:i.find((t=>t.id==e)))&&void 0!==n?n:this._defaultSlide,d=null!==(o=null===(r=this._dataSource.slides)||void 0===r?void 0:r.indexOf(s))&&void 0!==o?o:0;null===(l=this._dataSource.slides)||void 0===l||l.splice(d+t,0,null===(a=this._dataSource.slides)||void 0===a?void 0:a.splice(d,1)[0])}deleteSlide(e){var t,i,n,r,o,l,a,s;let d=null!==(i=null===(t=this._dataSource.slides)||void 0===t?void 0:t.find((t=>t.id==e)))&&void 0!==i?i:this._defaultSlide,u=null!==(r=null===(n=this._dataSource.slides)||void 0===n?void 0:n.indexOf(d))&&void 0!==r?r:0;null===(o=this._dataSource.slides)||void 0===o||o.splice(u,1),(null===(l=this._dataSource.slides)||void 0===l?void 0:l.length)?u<this._slideIdx?(--this._slideIdx,this.changeSlide(this.slides,this.slideIdx,null!==(s=null===(a=this._dataSource.slides)||void 0===a?void 0:a.length)&&void 0!==s?s:0,this.slide)):u==this._slideIdx&&(--this._slideIdx,this.openSlide(void 0,this._slideIdx)):this.addSlide()}deleteSlide1(e){var t,i,n,r,o,l;let a=null!==(i=null===(t=this._dataSource.slides)||void 0===t?void 0:t.find((t=>t.id==e)))&&void 0!==i?i:this._defaultSlide,s=null!==(r=null===(n=this._dataSource.slides)||void 0===n?void 0:n.indexOf(a))&&void 0!==r?r:0;if(a.isdeleted=!0,null===(l=null===(o=this._dataSource.slides)||void 0===o?void 0:o.filter((e=>!e.isdeleted)))||void 0===l?void 0:l.length){let e=!0;for(;a.isdeleted;)e?s++:s--,this._dataSource.slides[s]?a=this._dataSource.slides[s]:e=!e;this.openSlide(a.id)}else this.addSlide()}set onChangeSlide(e){this._fnChangeSlides.push(e)}changeSlide(e,t,i,n){this._fnChangeSlides.forEach((r=>r(e,t,i,n)))}set node(e){var t,i;let n=null===(t=this._dataSource.slides)||void 0===t?void 0:t.find(((e,t)=>t==this._slideIdx));(null===(i=null==n?void 0:n.svg)||void 0===i?void 0:i.nodes)&&n.svg.nodes.push(e),nn.history.push([{type:"add",from:{id:e.id},to:{id:e.id}}]),Ht(n),Ht(n,null==n?void 0:n.id)}findNode(e){var t,i,n,r,o,l;let a=null===(t=this._dataSource.slides)||void 0===t?void 0:t.find(((e,t)=>t==this._slideIdx)),s=null==a?void 0:a.svg,d=(t,i)=>{let n=null==t?void 0:t.find((t=>t.id==e));if(n)return n.pid=i,n;let r=0,o=t.length||0;for(;r<o&&!n&&(n=d(t[r].nodes||[],t[r].id),!n);)r++;return n},u=d((null==s?void 0:s.nodes)||[]);return u?(u.style=null!==(i=u.style)&&void 0!==i?i:{},u.source=null!==(n=u.source)&&void 0!==n?n:{},u.animate=null!==(r=u.animate)&&void 0!==r?r:{},u.interactive=null!==(o=u.interactive)&&void 0!==o?o:{},u.variable=null!==(l=u.variable)&&void 0!==l?l:{},u):{id:0,size:{x:0,y:0,width:0,height:0},attribute:{},isfake:!0}}getNode(e){var t;let i=null===(t=this._dataSource.slides)||void 0===t?void 0:t.find(((e,t)=>t==this._slideIdx)),n=null==i?void 0:i.svg,r=t=>{var i,n,o,l,s;let d=(null==t?void 0:t.find((t=>t.id==e)))||(e=>{var t,i,n,o,l;let a=null,s=0,d=e.length||0;for(;s<d&&!a;){if(a=r(e[s].nodes),a){a.pid=e[s].id;break}s++}return a&&(a.style=null!==(t=a.style)&&void 0!==t?t:{},a.source=null!==(i=a.source)&&void 0!==i?i:{},a.animate=null!==(n=a.animate)&&void 0!==n?n:{},a.interactive=null!==(o=a.interactive)&&void 0!==o?o:{},a.variable=null!==(l=a.variable)&&void 0!==l?l:{}),a})((null==t?void 0:t.filter((e=>e.type==a.GROUP)))||[]);return d&&(d.style=null!==(i=d.style)&&void 0!==i?i:{},d.source=null!==(n=d.source)&&void 0!==n?n:{},d.animate=null!==(o=d.animate)&&void 0!==o?o:{},d.interactive=null!==(l=d.interactive)&&void 0!==l?l:{},d.variable=null!==(s=d.variable)&&void 0!==s?s:{}),d};return r((null==n?void 0:n.nodes)||[])||{id:null,pid:null,type:null,element:document.createElement("div"),size:{x:0,y:0,width:0,height:0,points:[]},attribute:{},style:{},source:{},animate:{},interactive:{},variable:{},isfake:!0,isdeleted:!1,nodes:[]}}getNodeInArea(e,t,i,n,r){var o;let l=null===(o=this._dataSource.slides)||void 0===o?void 0:o.find(((e,t)=>t==this._slideIdx)),s=null==l?void 0:l.svg,d=o=>{let l=[];return o.filter((e=>!e.isdeleted)).forEach((o=>{o.type==a.GROUP?l=l.concat(d(o.nodes||[])):e>o.size.x||t>o.size.y||i<o.size.x+o.size.width||n<o.size.y+o.size.height||(r?o.type==r&&l.push(o.id):l.push(o.id))})),l};return d((null==s?void 0:s.nodes)||[])}getNodeOnArea(e,t,i,n,r){var o;let l=null===(o=this._dataSource.slides)||void 0===o?void 0:o.find(((e,t)=>t==this._slideIdx)),s=null==l?void 0:l.svg,d=o=>{let l=[];return o.filter((e=>!e.isdeleted)).forEach((o=>{o.type==a.GROUP?l=l.concat(d(o.nodes||[])):o.size.x+o.size.width<e||o.size.y+o.size.height<t||o.size.x>i||o.size.y>n||(r?o.type==r&&l.push(o.id):l.push(o.id))})),l};return d((null==s?void 0:s.nodes)||[])}deleteNode(e,t){var i;return this.getNode(e).isdeleted=null==t||t,Ht(this.slide),Ht(this.slide,null===(i=this.slide)||void 0===i?void 0:i.id),e}unGroup(e){var t,i,n;let r=this.getNode(e),o=Math.ceil(1e9*Math.random());return null===(i=null===(t=this.slide)||void 0===t?void 0:t.svg)||void 0===i||i.nodes.push(Object.assign(JSON.parse(JSON.stringify(r)),{id:o})),Object.assign(r,{isdeleted:!0}),Ht(this.slide),Ht(this.slide,null===(n=this.slide)||void 0===n?void 0:n.id),o}addGroup(e,t){var i;let n=this.getNode(e),r=this.getNode(t);r.nodes=r.nodes||[];let o=Math.ceil(1e9*Math.random());return r.nodes.push(Object.assign(JSON.parse(JSON.stringify(n)),{id:o})),Object.assign(n,{isdeleted:!0}),Ht(this.slide),Ht(this.slide,null===(i=this.slide)||void 0===i?void 0:i.id),o}setNodeP(e,t){var i,n;let r=null===(n=null===(i=this.slide)||void 0===i?void 0:i.svg)||void 0===n?void 0:n.nodes.find((t=>t.id==e));r&&(r.pid=t||null)}bringToFront(e){this.bringToFrontStep(e,0)}sendToBack(e){this.sendToBackStep(e,0)}bringToFrontStep(e,t){var i,n,o,l,a,s,d,u,c;null===(n=null===(i=this.slide)||void 0===i?void 0:i.svg)||void 0===n||n.nodes.forEach(((e,t)=>{e.index=t+1}));let h=(null!==(a=null===(l=null===(o=this.slide)||void 0===o?void 0:o.svg)||void 0===l?void 0:l.nodes.length)&&void 0!==a?a:0)+1;e.map((e=>{var t,i,n,r;return{id:e,index:null!==(r=null===(n=null===(i=null===(t=this.slide)||void 0===t?void 0:t.svg)||void 0===i?void 0:i.nodes.find((t=>t.id==e)))||void 0===n?void 0:n.index)&&void 0!==r?r:0}})).sort(((e,t)=>e.index-t.index)).forEach((e=>{var i,n,r,o;t?null===(o=null===(r=this.slide)||void 0===r?void 0:r.svg)||void 0===o||o.nodes.filter(((t,i)=>t.id==e.id)).forEach((i=>{i.index=t+e.index+e.index/1e3})):null===(n=null===(i=this.slide)||void 0===i?void 0:i.svg)||void 0===n||n.nodes.filter((t=>t.id==e.id)).forEach((t=>{t.index=h+e.index}))})),null===(d=null===(s=this.slide)||void 0===s?void 0:s.svg)||void 0===d||d.nodes.sort(((e,t)=>{var i,n;return(null!==(i=e.index)&&void 0!==i?i:0)-(null!==(n=t.index)&&void 0!==n?n:0)})),Xt(this.slide),null===(u=window.document.getElementById(r.RESIZE_GROUP))||void 0===u||u.remove(),null===(c=window.document.getElementById(r.SELECT_GROUP))||void 0===c||c.remove(),ct(nn.dataSelect.nodes)}sendToBackStep(e,t){var i,n,o,l,a,s;null===(n=null===(i=this.slide)||void 0===i?void 0:i.svg)||void 0===n||n.nodes.forEach(((e,t)=>{e.index=t+1})),e.map((e=>{var t,i,n,r;return{id:e,index:null!==(r=null===(n=null===(i=null===(t=this.slide)||void 0===t?void 0:t.svg)||void 0===i?void 0:i.nodes.find((t=>t.id==e)))||void 0===n?void 0:n.index)&&void 0!==r?r:0}})).sort(((e,t)=>e.index-t.index)).forEach((e=>{var i,n,r,o;t?null===(o=null===(r=this.slide)||void 0===r?void 0:r.svg)||void 0===o||o.nodes.filter((t=>t.id==e.id)).forEach((i=>{i.index=t+e.index+e.index/1e3})):null===(n=null===(i=this.slide)||void 0===i?void 0:i.svg)||void 0===n||n.nodes.filter((t=>t.id==e.id)).forEach((t=>{t.index=e.index/100-1}))})),null===(l=null===(o=this.slide)||void 0===o?void 0:o.svg)||void 0===l||l.nodes.sort(((e,t)=>{var i,n;return(null!==(i=e.index)&&void 0!==i?i:0)-(null!==(n=t.index)&&void 0!==n?n:0)})),Xt(this.slide),null===(a=window.document.getElementById(r.RESIZE_GROUP))||void 0===a||a.remove(),null===(s=window.document.getElementById(r.SELECT_GROUP))||void 0===s||s.remove(),ct(nn.dataSelect.nodes)}bringToFrontArea(e){var t,i,n,o,l,a;let s=e.map((e=>nn.data.getNode(e))).filter((e=>!e.isfake)),{x1:d,y1:u,x2:c,y2:h}=Qi(s),v=this.getNodeOnArea(d,u,c,h);null===(i=null===(t=this.slide)||void 0===t?void 0:t.svg)||void 0===i||i.nodes.forEach(((e,t)=>{e.index=t+1}));let g=v.map((e=>{var t,i,n,r;return null!==(r=null===(n=null===(i=null===(t=this.slide)||void 0===t?void 0:t.svg)||void 0===i?void 0:i.nodes.find((t=>t.id==e)))||void 0===n?void 0:n.index)&&void 0!==r?r:0})),p=Math.max.apply(null,g);e.forEach(((e,t)=>{var i,n;null===(n=null===(i=this.slide)||void 0===i?void 0:i.svg)||void 0===n||n.nodes.filter((t=>t.id==e)).forEach((e=>{e.index=p+(t+1)/100}))})),null===(o=null===(n=this.slide)||void 0===n?void 0:n.svg)||void 0===o||o.nodes.sort(((e,t)=>{var i,n;return(null!==(i=e.index)&&void 0!==i?i:0)-(null!==(n=t.index)&&void 0!==n?n:0)})),Xt(this.slide),null===(l=window.document.getElementById(r.RESIZE_GROUP))||void 0===l||l.remove(),null===(a=window.document.getElementById(r.SELECT_GROUP))||void 0===a||a.remove(),ct(nn.dataSelect.nodes)}sendToBackArea(e){var t,i,n,o,l,a;let s=e.map((e=>nn.data.getNode(e))).filter((e=>!e.isfake)),{x1:d,y1:u,x2:c,y2:h}=Qi(s),v=this.getNodeOnArea(d,u,c,h);null===(i=null===(t=this.slide)||void 0===t?void 0:t.svg)||void 0===i||i.nodes.forEach(((e,t)=>{e.index=t+1}));let g=v.map((e=>{var t,i,n,r;return null!==(r=null===(n=null===(i=null===(t=this.slide)||void 0===t?void 0:t.svg)||void 0===i?void 0:i.nodes.find((t=>t.id==e)))||void 0===n?void 0:n.index)&&void 0!==r?r:0})),p=Math.min.apply(null,g)-1;e.forEach(((e,t)=>{var i,n;null===(n=null===(i=this.slide)||void 0===i?void 0:i.svg)||void 0===n||n.nodes.filter((t=>t.id==e)).forEach((e=>{e.index=p+(t+1)/100}))})),null===(o=null===(n=this.slide)||void 0===n?void 0:n.svg)||void 0===o||o.nodes.sort(((e,t)=>{var i,n;return(null!==(i=e.index)&&void 0!==i?i:0)-(null!==(n=t.index)&&void 0!==n?n:0)})),Xt(this.slide),null===(l=window.document.getElementById(r.RESIZE_GROUP))||void 0===l||l.remove(),null===(a=window.document.getElementById(r.SELECT_GROUP))||void 0===a||a.remove(),ct(nn.dataSelect.nodes)}}const Qi=e=>{let t=999999,i=999999,n=-999999,r=-999999;return e.forEach((e=>{t=Math.min(t,e.size.x),i=Math.min(i,e.size.y),n=Math.max(n,e.size.x+e.size.width),r=Math.max(r,e.size.y+e.size.height)})),{x1:t,y1:i,x2:n,y2:r}};class Ui{constructor(){this._index=-1,this._dataSource=[],this.undoExecute=e=>{e.forEach((function(e){switch(e.type){case"add":nn.data.deleteNode(e.from.id);break;case"edit":break;case"delete":nn.data.deleteNode(e.from.id,!1);break;case"size":{let{id:t,type:i,size:n,attribute:r}=nn.data.getNode(e.from.id);Object.assign(n,e.from.size),Object.assign(r,ie(i,n,r)),Ge(window.document.getElementById(t),r);break}case"attribute":{let{id:t,attribute:i}=nn.data.getNode(e.from.id);Object.assign(i,e.from.attribute),Ge(window.document.getElementById(t),i);break}case"style":{let{id:t,style:i}=nn.data.getNode(e.from.id);Object.assign(null!=i?i:{},e.from.style),De(window.document.getElementById(t),i);break}case"source":{let{id:t,type:i,source:n}=nn.data.getNode(e.from.id);Object.assign(null!=n?n:{},e.from.source),Qe(window.document.getElementById(t),i,null!=n?n:{});break}case"animate":{let{animate:t}=nn.data.getNode(e.from.id);Object.assign(null!=t?t:{},e.from.animate);break}case"interactive":{let{interactive:t}=nn.data.getNode(e.from.id);Object.assign(null!=t?t:{},e.from.interactive);break}case"variable":{let{variable:t}=nn.data.getNode(e.from.id);Object.assign(null!=t?t:{},e.from.variable);break}}})),nn.dataSelect.ids=[]},this.redoExecute=e=>{e.forEach((function(e){switch(e.type){case"add":nn.data.deleteNode(e.to.id,!1);break;case"edit":break;case"delete":nn.data.deleteNode(e.to.id,!0);break;case"size":{let{id:t,type:i,size:n,attribute:r}=nn.data.getNode(e.to.id);Object.assign(n,e.to.size),Object.assign(r,ie(i,n,r)),Ge(window.document.getElementById(t),r);break}case"attribute":{let{id:t,attribute:i}=nn.data.getNode(e.to.id);Object.assign(i,e.to.attribute),Ge(window.document.getElementById(t),i);break}case"style":{let{id:t,style:i}=nn.data.getNode(e.to.id);Object.assign(null!=i?i:{},e.to.style),De(window.document.getElementById(t),i);break}case"source":{let{id:t,type:i,source:n}=nn.data.getNode(e.to.id);Object.assign(null!=n?n:{},e.to.source),Qe(window.document.getElementById(t),i,null!=n?n:{});break}case"animate":{let{animate:t}=nn.data.getNode(e.to.id);Object.assign(null!=t?t:{},e.to.animate);break}case"interactive":{let{interactive:t}=nn.data.getNode(e.to.id);Object.assign(null!=t?t:{},e.to.interactive);break}case"variable":{let{variable:t}=nn.data.getNode(e.to.id);Object.assign(null!=t?t:{},e.to.variable);break}}})),nn.dataSelect.ids=[]},this._fnChanges=[],this._index=-1,this._dataSource=[]}get index(){return this._index}get total(){return this._dataSource.length}get dataSource(){return this._dataSource}renew(){this._index=-1,this._dataSource=[],this.change()}push(e){this._index<0?(this._index=0,this._dataSource.length=0,this._dataSource[this._index]={data:e}):(this._index<this._dataSource.length-1&&this._dataSource.splice(this._index+1,this._dataSource.length-this._index-1),this._index++,this._dataSource.push({data:e})),this.change()}undo(){if(this._index<0)return;let e=this._dataSource[this._index];this.undoExecute(e.data),this._index--,this.change()}redo(){if(this._index>=this._dataSource.length-1)return;this._index++;let e=this._dataSource[this._index];this.redoExecute(e.data),this.change()}set onchange(e){this._fnChanges.push(e)}change(){this._fnChanges.forEach((e=>e(this.index,this.total)))}}class Wi{constructor(){this._x=0,this._y=0,this._width=0,this._height=0,this._scale=1,this._dislocation={x:0,y:0},this._offset={x:0,y:0},this._svgSize={x:0,y:0,width:0,height:0},this._svgViewBox={x:0,y:0,width:0,height:0},this._frameSize={x:0,y:0,width:1280,height:720},this._actived=!1,this._fnZoomChanges=[]}get actived(){return this._actived}set actived(e){this._actived=e}get get(){return{x:this._frameSize.x,y:this._frameSize.y,w:this._frameSize.width,h:this._frameSize.height,width:this._frameSize.width,height:this._frameSize.height}}set set(e){var t,i;this._frameSize.width=null!==(t=null==e?void 0:e.width)&&void 0!==t?t:1080,this._frameSize.height=null!==(i=null==e?void 0:e.height)&&void 0!==i?i:1080,this.zoomTo="fit"}get width(){return this._width}get height(){return this._height}get scale(){return this._scale}get dislocation(){return this._dislocation}get offset(){return this._offset}get svgSize(){return this._svgSize}get svgViewBox(){return this._svgViewBox}set svgViewBox(e){this._svgViewBox=e}get frameSize(){return this._frameSize}set frameSize(e){this._frameSize.x=e.x,this._frameSize.y=e.y,this._frameSize.width=e.width,this._frameSize.height=e.height,this.reset()}set screen(e){this._offset=e.offset,this._width=e.width,this._height=e.height,this.reset()}reset(){this.scaleTo(this._scale,void 0,!0)}scaleTo(e,t,i){if(!(e<.01||e>100)){if(t=null!=t?t:{x:this._width/2,y:this._height/2},i)this._dislocation.x=this._width/e/2-t.x,this._dislocation.y=this._height/e/2-t.y,this._dislocation.x+=(this._width-this._frameSize.width)/2,this._dislocation.y+=(this._height-this._frameSize.height)/2;else{var n={x:Math.max(0,Math.min(B(t.x/this._width,1e3),1)),y:Math.max(0,Math.min(B(t.y/this._height,1e3),1))},r={x:(this._width/e-this._width/this._scale)*n.x,y:(this._height/e-this._height/this._scale)*n.y};this._dislocation.x+=r.x,this._dislocation.y+=r.y}this._scale=e,this.change(),this.zoomChange(this.scale)}}set zoomTo(e){"fit"==e?this.scaleTo(Math.min((this._width-80)/this._frameSize.width,(this._height-80)/this._frameSize.height),void 0,!0):"number"==typeof e&&this.scaleTo(e/100,void 0,!0)}zoomIn(){this.scaleTo(this._scale+.04*this._scale)}zoomOut(){this.scaleTo(this._scale-.04*this._scale)}init(){return{svgViewBox:this.svgViewBox,svgSize:this.svgSize}}move(e,t){this._dislocation.x=e.x+t.x/this._scale,this._dislocation.y=e.y+t.y/this._scale,this._svgViewBox.x=-this._dislocation.x,this._svgViewBox.y=-this._dislocation.y,this.refScreen()}change(){this._svgSize.x=this._x,this._svgSize.y=this._y,this._svgSize.width=this._width,this._svgSize.height=this._height,this._svgViewBox.x=-this._dislocation.x,this._svgViewBox.y=-this._dislocation.y,this._svgViewBox.width=this._width/this._scale,this._svgViewBox.height=this._height/this._scale,this.refScreen()}refScreen(){Pe()}set onZoomChange(e){this._fnZoomChanges.push(e)}zoomChange(e){this._fnZoomChanges.forEach((t=>t(e)))}}class Vi{constructor(){this._fill="#D9D9D9",this._stroke="#AAAAAA",this._strokeWidth=1,this._strokeLinecap="round",this._strokeLinejoin="round",this._fontFamily=void 0,this._fontSize=20,this._textLength=void 0,this._fnChangeFills=[],this._fnChangeStrokes=[],this._fnChangeStrokeWidths=[],this.loadConfig()}loadConfig(){Qt({callback:e=>{this._fill=(null==e?void 0:e.fill)||this._fill,this._stroke=(null==e?void 0:e.stroke)||this._stroke,this._strokeWidth=(null==e?void 0:e.strokeWidth)||this._strokeWidth,this._strokeLinecap=(null==e?void 0:e.strokeLinecap)||this._strokeLinecap,this._strokeLinejoin=(null==e?void 0:e.strokeLinejoin)||this._strokeLinejoin,this.changeFill(this.fill),this.changeStroke(this.stroke),this.changeStrokeWidth(this.strokeWidth)}})}saveConfig(){Ut({params:{fill:this._fill,stroke:this._stroke,strokeWidth:this._strokeWidth,strokeLinecap:this._strokeLinecap,strokeLinejoin:this._strokeLinejoin}})}get fill(){return this._fill}set fill(e){this._fill=e,this.changeFill(this.fill)}get stroke(){return this._stroke}set stroke(e){this._stroke=e,this.changeStroke(this.stroke)}get strokeWidth(){return this._strokeWidth}set strokeWidth(e){this._strokeWidth=e,this.changeStrokeWidth(this.strokeWidth)}get strokeLinecap(){return this._strokeLinecap}set strokeLinecap(e){this._strokeLinecap=e}get strokeLinejoin(){return this._strokeLinejoin}set strokeLinejoin(e){this._strokeLinejoin=e}get fontFamily(){return this._fontFamily}get fontSize(){return this._fontSize}get textLength(){return this._textLength}set onchangefill(e){this._fnChangeFills.push(e)}changeFill(e){this._fnChangeFills.forEach((t=>t(e))),this.saveConfig()}set onchangestroke(e){this._fnChangeStrokes.push(e)}changeStroke(e){this._fnChangeStrokes.forEach((t=>t(e))),this.saveConfig()}set onchangestrokewidth(e){this._fnChangeStrokeWidths.push(e)}changeStrokeWidth(e){this._fnChangeStrokeWidths.forEach((t=>t(e))),this.saveConfig()}}var Hi=function(e){return e?JSON.parse(JSON.stringify(e)):e},Xi=[{key:"FinishedTest",type:"boolean",value:!1,note:"Hoàn thành BKT",system:!0,readonly:!1},{key:"TotalTest",type:"number",value:0,note:"Tổng số BKT",system:!0,readonly:!1},{key:"TotalTestDidNotPass",type:"number",value:0,note:"Số BKT không vượt qua",system:!0,readonly:!1},{key:"TotalTestPassed",type:"number",value:0,note:"Số BKT đã vượt qua",system:!0,readonly:!1}],qi=[],Yi={key:"BienSo",value:"0",type:"number",note:null,readonly:!1},Zi={if:[{type:"variable",variable:"BienSo",variables:null,slide:null,node:null,condition:">",operator:null,valuetype:"value",value:5}],then:[{type:"variable",variable:"BienChu",variables:null,slide:null,node:null,condition:null,operator:"=",valuetype:"value",value:"BienSo > 5"}],else:[{type:"variable",variable:"BienChu",variables:null,slide:null,node:null,condition:null,operator:"=",valuetype:"value",value:"BienSo <= 5"}],id:"57623302",idx:1,variables:["BienSo"]};class en{constructor(){this._data_variables=Hi(Xi).concat(Hi(qi)),this._data_conditions=[],this.GetActionExecutings=[],this.GetActionExecuteds=[],this.FuncGetExecuteds=e=>{"function"==typeof e&&this.GetActionExecuteds.push(e)},this.OnGetActionExecuted=e=>{this.GetActionExecuteds.forEach((t=>{t(e)}))},this.SetActionExecutings=[],this.FuncSetExecutings=e=>{"function"==typeof e&&this.SetActionExecutings.push(e)},this.OnSetActionExecuting=e=>{this.SetActionExecutings.forEach((t=>{t(e)}))},this.SetActionExecuteds=[],this.FuncSetExecuteds=e=>{"function"==typeof e&&this.SetActionExecuteds.push(e)},this.OnSetActionExecuted=e=>{for(var t of(this.SetActionExecuteds.forEach((t=>{t(e)})),this.getCondition(e.key)||[]))t.if&&t.if.length>0&&(this.checkValueConditions(t.if)?this.setValueOperators(t.then||[]):this.setValueOperators(t.else||[]))}}renew(){this._data_variables=Hi(Xi).concat(Hi(qi)),this._data_conditions=[]}get totalVariable(){return this._data_variables.length}get totalCondition(){return this._data_conditions.length}get get(){return{variables:this._data_variables||[],conditions:this._data_conditions||[]}}set set(e){if(!e)return;let t={};"string"==typeof e?t=JSON.parse(e):"object"==typeof e&&(t=e),this._data_variables=t.variables||[],this._data_conditions=t.conditions||(e=>(this._data_variables.map((e=>e.change||[])).forEach((t=>{e=e.concat(t)})),e))([]),Xi.forEach((e=>{var t=this._data_variables.filter((t=>t.key==e.key));t.length?t.forEach((function(t,i,n){t.type=e.type,t.readonly=e.readonly,t.system=e.system})):this._data_variables.push(e)}))}getVariableTemp(){return Hi(Yi)}getConditionTemp(){return Hi(Zi)}getKeys(){return this._data_variables.map((function(e){return e.key})).sort((function(e,t){return e.localeCompare(t)}))}getVariableAll(){return this._data_variables.length?Hi((e=this._data_variables,t="key",function(i){for(var n of e.map((function(e){return e[t]})).sort())e.filter((function(e){return e[t]==n})).forEach((function(e){i.push(e)})),e=e.filter((function(e){return e[t]!=n}));return i}([]))):Hi(Xi).concat(Hi(qi));var e,t}setVariableAll(e){e&&("string"==typeof e&&(e=JSON.parse(e)),"object"==typeof e&&(this._data_variables=e),Xi.forEach((e=>{var t=this._data_variables.filter((t=>t.key==e.key));t.length?t.forEach(((t,i,n)=>{t.type=e.type,t.readonly=e.readonly,t.system=e.system})):this._data_variables.push(e)})))}getVariable(e){return e?Hi(this._data_variables.filter((t=>t.key==e))[0]||{}):{}}setVariable(e,t,i){if(e){switch([null,void 0,NaN,1/0].indexOf(t)>=0&&(t=""),i||(i=(this._data_variables.filter((t=>t.key==e))[0]||{}).type||null),i){case"string":"string"!=typeof t&&(t=t.toString().trim());break;case"number":"number"!=typeof t&&(t=parseFloat(t)||0);break;case"boolean":"string"==typeof t&&(t=t.toLowerCase()),"boolean"!=typeof t&&(t="1"==t||"true"==t||"yes"==t||"dung"==t)}var n=this._data_variables.filter((t=>t.key==e));n.length?n.forEach((function(e,n,r){e.value=t,e.type=i})):this._data_variables.push({key:e,value:t,type:i})}}getValue(e,t){if(!e)return"";var i=this._data_variables.filter((function(t){return t.key==e}));if(i.length){var n,r=i[0]||{};switch(this.OnGetActionExecuting(r),t||(t=r.type||null),t){case"string":n=[null,void 0,NaN,1/0].indexOf(r.value)>=0?"":"string"==typeof r.value?r.value||"":r.value.toString().trim();break;case"number":n=[null,void 0,NaN,1/0].indexOf(r.value)>=0?0:"number"==typeof r.value?r.value||0:parseFloat(r.value)||0;break;case"boolean":[null,void 0,NaN,1/0].indexOf(r.value)>=0?n=!1:"boolean"==typeof r.value?n=r.value:(n=(r.value+"").toLowerCase(),n="1"==r.value||"true"==r.value||"yes"==r.value||"dung"==r.value);break;case"audio-src":n=[null,void 0,NaN,1/0].indexOf(r.value)>=0?"":r.value?`<audio controls style="width:280px;vertical-align:middle;"><source src="${r.value}"></source></audio>`:"";break;case"video-src":n=[null,void 0,NaN,1/0].indexOf(r.value)>=0?"":r.value?`<video controls style="width:280px;vertical-align:middle;"><source src="${r.value}"></source></video>`:"";break;case"img-src":n=[null,void 0,NaN,1/0].indexOf(r.value)>=0?"":r.value?`<img style="width:100%;vertical-align:middle;" src="${r.value}"/>`:"";break;default:n=[null,void 0,NaN,1/0].indexOf(r.value)>=0?"":r.value}return this.OnGetActionExecuted(r),n}return null}setValue(e,t,i){if(e){switch([null,void 0,NaN,1/0].indexOf(t)>=0&&(t=""),i||(i=(this._data_variables.filter((function(t){return t.key==e}))[0]||{}).type||null),i){case"string":"string"!=typeof t&&(t=t.toString().trim());break;case"number":"number"!=typeof t&&(t=parseFloat(t)||0);break;case"boolean":"string"==typeof t&&(t=t.toLowerCase()),"boolean"!=typeof t&&(t="1"==t||"true"==t||"yes"==t||"dung"==t)}var n=this._data_variables.filter((function(t){return t.key==e}));if(n.length){var r=n[0];this.OnSetActionExecuting(r),r&&(r.value=t),this.OnSetActionExecuted(r)}}}getConditionAll(){return Hi(this._data_conditions.sort((function(e,t){return e.idx-t.idx})))}setConditionAll(e){e&&("string"==typeof e&&(e=JSON.parse(e)),"object"==typeof e&&(this._data_conditions=e))}getCondition(e){return e?Hi(this._data_conditions.filter((t=>t.variable==e||(t.variables||[]).indexOf(e)>=0)).sort((function(e,t){return e.idx-t.idx}))):{}}switchCondition(e,t,i){switch(e){case"==":return"string"==typeof i?(i=i.toLowerCase().trim(),"string"==typeof t&&(t=t.toLowerCase().trim()),i.split(";").map((function(e){return t==e.trim()?1:0})).reduce((function(e,t){return e+t}))>0):t==i;case"!=":return"string"==typeof i?(i=i.toLowerCase().trim(),"string"==typeof t&&(t=t.toLowerCase().trim()),0==i.split(";").map((function(e){return t==e.trim()?1:0})).reduce((function(e,t){return e+t}))):t!=i;case">=":return t>=i;case"<=":return t<=i;case">":return t>i;case"<":return t<i;case"∈":return i=(i+"").toLowerCase().trim(),t=(t+"").toLowerCase().trim(),i.split(";").map((function(e){return t.indexOf(e.trim())>=0?1:0})).reduce((function(e,t){return e+t}))>0;case"∉":return i=(i+"").toLowerCase().trim(),t=(t+"").toLowerCase().trim(),0==i.split(";").map((function(e){return t.indexOf(e.trim())>=0?1:0})).reduce((function(e,t){return e+t}));default:return!1}}switchOperator(e,t,i){switch(e){case"+":return t+i;case"-":return t-i;case"*":return t*i;case"/":return t/i;case"=":return i;case"=!":return!i;case"==":return t==i;case"!=":return t!=i}}switchFormula(e,t){switch(e){case"sum":return t.reduce((function(e,t){return e+t}));case"sub":return t.reduce((function(e,t){return e-t}));case"pro":return t.reduce((function(e,t){return e*t}));case"div":return t.reduce((function(e,t){return e/t}));case"avg":var i=t.reduce((function(e,t){return e+t}))/(t.length||1);return Math.round(1e4*(i+Number.EPSILON))/1e4;case"min":return Math.min.apply(null,t);case"max":return Math.max.apply(null,t);case"and":return t.reduce((function(e,t){return e&&t}));case"or":return t.reduce((function(e,t){return e||t}));default:return 0}}switchValueType_Condition(e){switch(e.valuetype){case"value":return this.switchCondition(e.condition,this.getValue(e.variable),e.value);case"variable":return this.switchCondition(e.condition,this.getValue(e.variable),this.getValue(e.value));default:return 0}}switchValueType_Operator(e){switch(e.valuetype){case"value":return this.switchOperator(e.operator,this.getValue(e.variable),e.value);case"variable":return this.switchOperator(e.operator,this.getValue(e.variable),this.getValue(e.value));case"variables":var t=this.switchFormula(e.valueformula,e.value.map((e=>this.getValue(e))));return this.switchOperator(e.operator,this.getValue(e.variable),t)}}checkValueCondition(e){return this.switchValueType_Condition(e)}getValueOperator(e){return this.switchValueType_Operator(e)}setValueOperator(e){(null==e?void 0:e.variable)&&this.setValue(e.variable,this.getValueOperator(e))}checkValueConditions(e){return 0==e.map((e=>{switch(e.type){case"variable":return this.switchValueType_Condition(e)?0:1;case"variables":return 0==e.variables.map((t=>this.switchValueType_Condition(Object.assign(Hi(e),{variable:t}))?0:1)).reduce((function(e,t){return e+t}))?0:1;default:return 0}})).reduce(((e,t)=>(null!=e?e:0)+(null!=t?t:0)))}setValueOperators(e){var t;for(var i of e)switch(i.type){case"variable":this.setValue(i.variable,this.getValueOperator(i));break;case"variables":for(var n of i.variables)this.setValue(n,this.getValueOperator(Object.assign(Hi(i),{variable:n})));break;case"slide":Be.runSlide(void 0,void 0,i.slide);break;case"node":{oe({id:i.node,nodeStatus:Be.nodeStatus,slideStatus:Be.slideStatus});let e=Be.findNode(i.node);(null===(t=null==e?void 0:e.interactive)||void 0===t?void 0:t.click)&&se(e,Be.nodeStatus,Be.slideStatus);break}}}FuncGetExecutings(e){"function"==typeof e&&this.GetActionExecutings.push(e)}OnGetActionExecuting(e){this.GetActionExecutings.forEach((t=>{t(e)}))}}class tn{constructor(){this._fnChangePointerTypes=[],this._fnChangePointerTypeTemps=[],this._fnChangePenTypes=[],this._fnChangeShapeTypes=[],this._fnChangePolygonTypes=[],this._fnChanges=[],this._pointer_type=0,this._pointer_type_temp=0,this._pen_type=0,this._shape_type=0,this._polygon_type=0}setPointer_nochange(e,t,i){if(this._pointer_type=e,t)switch(e){case o.PEN:this._pen_type=t;break;case o.SHAPE:this._shape_type=t,i&&t===a.POLYGON&&(this._polygon_type=i)}}get pointer_type(){return this._pointer_type}set pointer_type(e){switch(this._pointer_type=e,e){case o.PEN:this._pen_type||(this._pen_type=l.DRAW);break;case o.SHAPE:this._shape_type||(this._shape_type=a.RECT)}this.changePointerType(this.pointer_type),this.change(this.pointer_type)}get pointer_type_temp(){return this._pointer_type_temp}set pointer_type_temp(e){this._pointer_type_temp=e,this.changePointerTypeTemp(this.pointer_type),this.change(this.pointer_type_temp)}get pen_type(){return this._pen_type}set pen_type(e){this._pen_type=e,this.changePenType(this.pointer_type,this.pen_type),this.change(this.pointer_type,this.pen_type)}get shape_type(){return this._shape_type}set shape_type(e){this._shape_type=e,this.changeShapeType(this.pointer_type,this.shape_type),this.change(this.pointer_type,this.shape_type)}get polygon_type(){return this._polygon_type}set polygon_type(e){this._polygon_type=e,this.changePolygonType(this.pointer_type,this.shape_type,this.polygon_type),this.change(this.pointer_type,this.shape_type,this.polygon_type)}set onchangePointerType(e){this._fnChangePointerTypes.push(e)}changePointerType(e,t,i){this._fnChangePointerTypes.forEach((n=>n(e,t,i)))}set onchangePointerTypeTemp(e){this._fnChangePointerTypeTemps.push(e)}changePointerTypeTemp(e,t,i){this._fnChangePointerTypeTemps.forEach((n=>n(e,t,i)))}set onchangePenType(e){this._fnChangePenTypes.push(e)}changePenType(e,t,i){this._fnChangePenTypes.forEach((n=>n(e,t,i)))}set onchangeShapeType(e){this._fnChangeShapeTypes.push(e)}changeShapeType(e,t,i){this._fnChangeShapeTypes.forEach((n=>n(e,t,i)))}set onchangePolygonType(e){this._fnChangePolygonTypes.push(e)}changePolygonType(e,t,i){this._fnChangePolygonTypes.forEach((n=>n(e,t,i)))}set onchange(e){this._fnChanges.push(e)}change(e,t,i){this._fnChanges.forEach((n=>n(e,t,i)))}}const nn=new class{constructor(){this._container="",this._svg="",this._screen=Wi.prototype,this._data=Di.prototype,this._dataSelect=Ki.prototype,this._slide=Gi.prototype,this._history=Ui.prototype,this._attribute=Vi.prototype,this._pointer=tn.prototype,this._variable=en.prototype,this._data=new Di,this._dataSelect=new Ki,this._slide=new Gi,this._history=new Ui,this._attribute=new Vi,this._pointer=new tn,this._variable=new en,this._pointer.onchangePointerType=()=>{this._dataSelect.ids.length&&(this._dataSelect.ids=[])},this._data.onChangeSlide=()=>{this._dataSelect.ids.length&&(this._dataSelect.ids=[])}}get config(){return this._config}set config(e){this._config=e}get dataSource(){return{modules:"icdtV2",screen:this._screen.get,data:this._data.get,variable:this._variable.get,resources:this._data.getResource,fonts:this._data.getFonts,info:{}}}set dataSource(e){this._screen.set=e.screen||{width:1080,height:1080},this._data.set=e.data||{},this._variable.set=e.variable||{}}get container(){return this._container}set container(e){this._container=e}get svg(){return this._svg}set svg(e){this._svg=e}get target(){return window.document.querySelector(this._svg)}get screen(){return this._screen}get data(){return this._data}get dataSelect(){return this._dataSelect}get slide(){return this._slide}get history(){return this._history}get attribute(){return this._attribute}get pointer(){return this._pointer}get variable(){return this._variable}reloadView(){var e,t,i,n,r;this._screen.screen=(e=jQuery(this._container).offset(),t=jQuery(this._container).width(),i=jQuery(this._container).height(),{offset:{x:null!==(n=null==e?void 0:e.left)&&void 0!==n?n:0,y:null!==(r=null==e?void 0:e.top)&&void 0!==r?r:0},width:null!=t?t:0,height:null!=i?i:0})}init(e){this._container=e.container,this._svg=e.target,this._screen=new Wi,Fi({container:e.container,target:e.target,iskeyboard:e.iskeyboard})}},rn=e=>!!e.match("^#[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$"),on=e=>!!e.match(/^rgba?/),ln=e=>!!e.match(/^none|transparent$/),an=(e,t)=>{var i;dn(e,null,t,e);var n=e=>{var t;"text"==e.nodeName?(e=>{var t;(null===(t=e.child)||void 0===t?void 0:t.length)&&(e.nodeName="g",e.child=e.child.reduce(((e,t,i,n)=>{var r,o;if("tspan"==t.nodeName){let i=e.find((e=>e.fill==t.fill&&e.y==t.y&&e["font-family"]==t["font-family"]&&e["font-weight"]==t["font-weight"]&&e["font-style"]==t["font-style"]&&e["font-size"]==t["font-size"]));i?(i.x=Math.min(parseFloat(null!==(r=i.x)&&void 0!==r?r:"0"),parseFloat(null!==(o=t.x)&&void 0!==o?o:"0")),i.textContent+=t.textContent):(t.nodeName="text",e.push(t))}else e.push(t);return e}),[]))})(e):(null===(t=e.child)||void 0===t?void 0:t.length)&&e.child.forEach((e=>n(e)))},r=e=>e.reduce(((e,t,i,n)=>{var o,l,a;if("g"==t.nodeName&&(null===(o=t.child)||void 0===o?void 0:o.length)&&(t.child=r(t.child)),"text"==t.nodeName){let i=e.find((e=>e.fill==t.fill&&e.y==t.y&&e["font-family"]==t["font-family"]&&e["font-weight"]==t["font-weight"]&&e["font-style"]==t["font-style"]&&e["font-size"]==t["font-size"]));i?(i.x=Math.min(parseFloat(null!==(l=i.x)&&void 0!==l?l:"0"),parseFloat(null!==(a=t.x)&&void 0!==a?a:"0")),i.textContent+=t.textContent):e.push(t)}else e.push(t);return e}),[]);t.forEach((e=>n(e))),t=r(t),console.log("SVG2JSON",t);let o=(()=>{var t,i,n,r,o,l,a;let s=null===(n=null===(i=null===(t=e.getAttribute("viewBox"))||void 0===t?void 0:t.replace(/^([0-9\.]+)[\s]([0-9\.]+)[\s\,]([0-9\.]+)[\s\,]([0-9\.]+)$/g,"$1,$2,$3,$4"))||void 0===i?void 0:i.split(","))||void 0===n?void 0:n.map((e=>B(parseFloat(e),1)));return 4==(null==s?void 0:s.length)?{x:s[0],y:s[1],width:s[2],height:s[3]}:{x:null!==(r=hn(e.getAttribute("x")))&&void 0!==r?r:0,y:null!==(o=hn(e.getAttribute("y")))&&void 0!==o?o:0,width:null!==(l=hn(e.getAttribute("width")))&&void 0!==l?l:0,height:null!==(a=hn(e.getAttribute("height")))&&void 0!==a?a:0}})(),l={id:nn.data.newSlideId,name:"SVG",svg:{viewBox:o,nodes:sn(t)}};if(console.log(l),l.svg&&(!l.svg.viewBox.width||!l.svg.viewBox.height)){let e=0,t=0,n=i=>{i.forEach((i=>{var r;let{size:o}=i;e=Math.max(e,o.width),t=Math.max(t,o.height),n(null!==(r=i.nodes)&&void 0!==r?r:[])}))};n(null!==(i=l.svg.nodes)&&void 0!==i?i:[]),l.svg.viewBox.width=e,l.svg.viewBox.height=t}return l},sn=(e,t)=>{let i=[];return e.forEach((e=>{let n={id:Math.ceil(1e9*Math.random()),pid:t,name:e.nodeName,type:(()=>{switch(e.nodeName){case"polygon":return a.POLYGON;case"polyline":return a.POLYLINE;case"path":return a.PATH;case"circle":return a.CIRCLE;case"ellipse":return a.ELLIPSE;case"line":return a.LINE;case"rect":return a.RECT;case"foreignObject":return a.FOREIGNOBJECT;case"image":return a.IMAGE;case"text":return a.TEXT;case"tspan":return a.TSPAN;case"g":return a.GROUP}return 0})(),size:(()=>{var t,i,n;let r={},o=0,l=0,a=0,s=0,d=null!==(t=e.rotate)&&void 0!==t?t:null;switch(e.nodeName){case"circle":{let t=parseFloat(e.cx||"0"),i=parseFloat(e.cy||"0"),n=parseFloat(e.r||"0");o=t-n,l=i-n,a=2*n,s=2*n;break}case"ellipse":{let t=parseFloat(e.cx||"0"),i=parseFloat(e.cy||"0"),n=parseFloat(e.rx||"0"),r=parseFloat(e.ry||"0");o=t-n,l=i-r,a=2*n,s=2*r;break}case"line":{let t=parseFloat(e.x1||"0"),i=parseFloat(e.y1||"0"),n=parseFloat(e.x2||"0"),d=parseFloat(e.y2||"0"),u=999999999,c=999999999,h=0,v=0;u=Math.min(t,n),c=Math.min(i,d),h=Math.max(t,n),v=Math.max(i,d),o=u,l=c,a=h-o||1,s=v-l||1;let g=[[(t-o)/a,(i-l)/s],[(n-o)/a,(d-l)/s]];Object.assign(r,{ratios:g});break}case"rect":o=parseFloat(e.x||"0"),l=parseFloat(e.y||"0"),a=parseFloat(e.width||"0"),s=parseFloat(e.height||"0"),Object.assign(r,{x:o,y:l,width:a,height:s});break;case"foreignObject":case"image":o=parseFloat(e.x||"0"),l=parseFloat(e.y||"0"),a=parseFloat(e.width||"0"),s=parseFloat(e.height||"0");break;case"text":case"tspan":r.x||r.y||(e.x&&(o=parseFloat(e.x||"0")),e.y&&(l=parseFloat(e.y||"0"))),(t=>{let i=16;t&&(i=t.match(/rem/)?16*parseInt(t):parseInt(t)),(t=>{var i,n;s=1.2*t,a=t/14*8*(null!==(n=null===(i=e.textContent)||void 0===i?void 0:i.length)&&void 0!==n?n:1),e["alignment-baseline"]||e["dominant-baseline"]||(l-=t)})(i)})(e["font-size"]||"16");break;case"polygon":case"polyline":{if(!e.points)break;let t=(e=>{return(t=e.replace(/\,/g," ").replace(/\-/g," -").replace(/[^0-9\.\-]/g," ").replace(/\s+/g," ").trim())?t.split(/\s/).map((e=>parseFloat(e))):[];var t})(e.points),{minX:i,minY:n,maxX:d,maxY:u}=(e=>{let t=[],i=[];return e.forEach(((e,n)=>{n%2==0?t.push(e):i.push(e)})),{minX:Math.min.apply(null,t),minY:Math.min.apply(null,i),maxX:Math.max.apply(null,t),maxY:Math.max.apply(null,i)}})(t);o=i,l=n,a=d-o||1,s=u-l||1,Object.assign(r,{ratios:H({x:o,y:l,width:a,height:s},t)});break}case"path":{if(!e.d)break;let t=Q(e.d),{minX:i,minY:n,maxX:d,maxY:u}=U(t);o=i,l=n,a=d-o||1,s=u-l||1,Object.assign(r,{ratioMaps:W({x:o,y:l,width:a,height:s},t)});break}}return(e=>{var t,i,n,a,s,u;(null==e?void 0:e.match(/rotate\([^\)]+\)/))&&(e=>{var t,i,n,o;e&&(o=null===(n=null===(i=null===(t=null==e?void 0:e.replace(/[^0-9\-\.\,\ ]/g,""))||void 0===t?void 0:t.replace(/\,/g," "))||void 0===i?void 0:i.replace(/\s+/g," "))||void 0===n?void 0:n.split(" ")).length&&Object.assign(r,{rotate:parseFloat(o[0]||"0")})})(null===(n=null===(i=null!==(t=null==e?void 0:e.match(/rotate\([^\)]+\)/))&&void 0!==t?t:[])||void 0===i?void 0:i.shift())||void 0===n?void 0:n.toString()),(null==e?void 0:e.match(/translate\([^\)]+\)/))&&(e=>{var t,i,n,r;e&&(r=null===(n=null===(i=null===(t=null==e?void 0:e.replace(/[^0-9\-\.\,\ ]/g,""))||void 0===t?void 0:t.replace(/\,/g," "))||void 0===i?void 0:i.replace(/\s+/g," "))||void 0===n?void 0:n.split(" ")).length>=2&&(o+=parseFloat(r[0]||"0"),l+=parseFloat(r[1]||"0"))})(null===(u=null===(s=null!==(a=null==e?void 0:e.match(/translate\([^\)]+\)/))&&void 0!==a?a:[])||void 0===s?void 0:s.shift())||void 0===u?void 0:u.toString()),(null==e?void 0:e.match(/matrix\([^\)]+\)/))&&(e=>{var t;if(e){let i=q({x:o,y:l},e);o=i.x,l=i.y,d=null!==(t=i.rotate)&&void 0!==t?t:null}})(e)})(null===(n=null===(i=e.transform)||void 0===i?void 0:i.replace(/\,/," "))||void 0===n?void 0:n.replace(/\s+/g," ")),Object.assign(r,{x:o,y:l,width:a,height:s,rotate:d}),r})(),attribute:(()=>{var t,i,n,r,o,l,a,s,d,u,c,h,v,g;let p={};var y;switch(e.fill&&(y=e.fill,on(y)?p.fill=z(y):rn(y)?p.fill=y:ln(y)?p.fill="rgba(0,0,0,0)":p.fill="#000000"),e["fill-opacity"]&&(p.fillOpacity=e["fill-opacity"]),e["fill-rule"]&&(p.fillRule=e["fill-rule"]),e.stroke&&(e=>{on(e)?p.stroke=z(e):rn(e)?p.stroke=e:ln(e)?p.stroke="rgba(0,0,0,0)":p.stroke="#000000"})(e.stroke),e["stroke-opacity"]&&(p.strokeOpacity=e["stroke-opacity"]),e["stroke-width"]&&(p.strokeWidth=parseFloat(e["stroke-width"])||0),e["stroke-linecap"]&&(p.strokeLinecap=e["stroke-linecap"]),e["stroke-linejoin"]&&(p.strokeLinejoin=e["stroke-linejoin"]),e["stroke-miterlimit"]&&(p.strokeMiterlimit=parseFloat(e["stroke-miterlimit"])||0),e["stroke-dasharray"]&&(p.strokeDasharray=parseFloat(e["stroke-dasharray"])||0),e.nodeName){case"polygon":case"polyline":{let i=null!==(t=e.points)&&void 0!==t?t:null;Object.assign(p,{points:i});break}case"path":{let t=null!==(i=e.d)&&void 0!==i?i:null;Object.assign(p,{d:t});break}case"circle":case"ellipse":case"line":case"rect":case"foreignObject":case"image":break;case"text":case"tspan":{let t=null!==(n=e["font-family"])&&void 0!==n?n:null,i=null!==(r=e["font-weight"])&&void 0!==r?r:null,y=null!==(o=e["font-style"])&&void 0!==o?o:null,f=null!==(l=e["font-size"])&&void 0!==l?l:null,m=null!==(a=e["letter-spacing"])&&void 0!==a?a:null,b=null!==(s=e["word-spacing"])&&void 0!==s?s:null,w=null!==(d=e["alignment-baseline"])&&void 0!==d?d:null,S=null!==(u=e["dominant-baseline"])&&void 0!==u?u:null,x=null!==(c=e["text-anchor"])&&void 0!==c?c:null;if(t){let e=E(t);t=null!==(h=e.fontFamily)&&void 0!==h?h:t,i=null!==(v=e.fontWeight)&&void 0!==v?v:i,y=null!==(g=e.fontStyle)&&void 0!==g?g:y}w||S||(S="text-before-edge"),Object.assign(p,{fontFamily:t,fontWeight:i,fontStyle:y,letterSpacing:m,wordSpacing:b,alignmentBaseline:w,dominantBaseline:S,textAnchor:x}),f&&(f.match(/rem/)?Object.assign(p,{fontSize:16*parseInt(f)}):Object.assign(p,{fontSize:parseInt(f)}));break}}return p})(),style:(e.nodeName,{}),source:(()=>{let t={};switch(e.nodeName){case"polygon":case"polyline":case"circle":case"ellipse":case"line":case"rect":case"foreignObject":break;case"image":e.base64&&Object.assign(t,{type:"image",image:{base64:e.base64}});break;case"text":case"tspan":e.textContent&&Object.assign(t,{type:"text",text:{textContent:e.textContent}})}return t})()};if(i.push(n),e.child){let t=sn(e.child,n.id);i=[...i,...t]}})),i},dn=(e,t,i,n)=>{e.querySelectorAll(":scope > *").forEach((e=>{var r,o,l,a,s,d,u,c,h,v,g,p,y,f,m,b,w,S,x,k,O;if(["defs","script"].includes(e.nodeName))return;let _=[],N={};switch(un(e,N),N=Object.assign({},null!=t?t:{},N),"use"===N.nodeName&&(N.href?un(n.querySelector(N.href),N):N["xlink:href"]&&un(n.querySelector(N["xlink:href"]),N)),N.nodeName){case"circle":case"ellipse":if(null===(r=N.transform)||void 0===r?void 0:r.match(/matrix\([^\)]+\)/)){let e=parseFloat(null!==(o=N.x)&&void 0!==o?o:"0"),t=parseFloat(null!==(l=N.y)&&void 0!==l?l:"0");(i=>{var n;if(i){let r=q({x:e,y:t},i);N.x=r.x,N.y=r.y,N.rotate=null!==(n=r.rotate)&&void 0!==n?n:null}})(N.transform),N.transform=null}break;case"text":{if(null===(a=N.transform)||void 0===a?void 0:a.match(/matrix\([^\)]+\)/)){let e=parseFloat(null!==(s=N.x)&&void 0!==s?s:"0"),t=parseFloat(null!==(d=N.y)&&void 0!==d?d:"0");(i=>{var n;if(i){let r=q({x:e,y:t},i);N.x=r.x,N.y=r.y,N.rotate=null!==(n=r.rotate)&&void 0!==n?n:null}})(N.transform),N.transform=null}else if(null===(u=N.transform)||void 0===u?void 0:u.match(/translate\([^\)]+\)/)){let e=parseFloat(null!==(c=N.x)&&void 0!==c?c:"0"),t=parseFloat(null!==(h=N.y)&&void 0!==h?h:"0");(i=>{var n,r,o,l;i&&(l=null===(o=null===(r=null===(n=null==i?void 0:i.replace(/[^0-9\-\.\,\ ]/g,""))||void 0===n?void 0:n.replace(/\,/g," "))||void 0===r?void 0:r.replace(/\s+/g," "))||void 0===o?void 0:o.split(" ")).length>=2&&(N.x=e+parseFloat(l[0]||"0"),N.y=t+parseFloat(l[1]||"0"))})(null===(y=null===(p=null!==(g=null===(v=N.transform)||void 0===v?void 0:v.match(/translate\([^\)]+\)/))&&void 0!==g?g:[])||void 0===p?void 0:p.shift())||void 0===y?void 0:y.toString()),N.transform=null}let t=e.textContent;t&&Object.assign(N,{textContent:t}),N.fill||N.stroke||(N.fill="#000000");break}case"tspan":{if(null===(f=N.transform)||void 0===f?void 0:f.match(/matrix\([^\)]+\)/)){let e=parseFloat(null!==(m=N.x)&&void 0!==m?m:"0"),t=parseFloat(null!==(b=N.y)&&void 0!==b?b:"0");(i=>{if(i){let n=q({x:e,y:t},i);N.x=n.x,N.y=n.y}})(N.transform),N.transform=null}else{let e=parseFloat(null!==(w=N.x)&&void 0!==w?w:"0"),i=parseFloat(null!==(S=N.y)&&void 0!==S?S:"0");N.x=B(e+(null!==(x=null==t?void 0:t.x)&&void 0!==x?x:0),10),N.y=B(i+(null!==(k=null==t?void 0:t.y)&&void 0!==k?k:0),10)}let i=e.textContent;i&&Object.assign(N,{textContent:i}),N.fill||N.stroke||(N.fill="#000000");break}case"path":if(N.d){let e=((e,t)=>{let i=Y(t);return i?window.Snap.path.map(e,window.Snap.matrix(i.a,i.b,i.c,i.d,i.e,i.f)).toString():e})(N.d,(null===(O=N.transform)||void 0===O?void 0:O.match(/matrix/))?N.transform:"matrix(1 0 0 1 0 0)");Object.assign(N,{d:e}),N.transform=null}N.fill||N.stroke||(N.fill="#000000");break;case"image":{let e=N["xlink:href"]||N.href;(null==e?void 0:e.match(/;base64,/))&&Object.assign(N,{base64:e});break}}dn(e,N,_,n),_.length&&Object.assign(N,{child:_}),i.push(N)}))},un=(e,t)=>{e&&(["symbol"].includes(e.nodeName)?un((e.querySelectorAll(":scope > *")||[])[0],t):(t.nodeName=e.nodeName,[["x","y","width","height"],["x1","x2","y1","y2"],["rx","ry","r"],["cx","cy"],["fill","fill-opacity","fill-rule"],["stroke","stroke-opacity","stroke-width","stroke-miterlimit","stroke-linecap","stroke-linejoin","stroke-dasharray"],["d","points"],["font-family","font-weight","font-style","font-size","letter-spacing","word-spacing","alignment-baseline","dominant-baseline","text-anchor"],["transform","transform-origin"],["href","xlink:href"]].forEach((i=>{i.forEach((i=>{cn(e,t,i)}))}))))},cn=(e,t,i)=>{let n=e.getAttribute(i);if(n){let e={};e[i]=n.trim(),Object.assign(t,e)}},hn=e=>{var t,i;return e?"string"==typeof e?e.match(/in/)?B(96*parseFloat(null!==(t=e.replace(/[^0-9\.]/g,""))&&void 0!==t?t:"0"),1):B(parseFloat(null!==(i=e.replace(/[^0-9\.]/g,""))&&void 0!==i?i:"0"),1):"number"==typeof e?e:0:0},vn=(e,t)=>{var i={data:{slides:[]},info:{},resources:[],screen:{w:0,h:0,width:0,height:0},variable:{conditions:[],variables:[]}};return(i=e.shift()).data=i.data||{slides:[]},i.data.slides=i.data.slides||[],i.variable=i.variable||{conditions:[],variables:[]},i.variable.conditions=i.variable.conditions||[],i.variable.variables=i.variable.variables||[],e.forEach(((e,t)=>{var n=(e.data||{slides:[]}).slides||[],r=e.variable||{conditions:[],variables:[]},o=r.conditions||[],l=r.variables||[];n.forEach((function(e){if(n.find((function(t){return t.id==e.id}))){var t=e.id.toString(),i=nn.data.newSlideId;e.id=i,n.forEach((function(e){var n;(null===(n=e.svg)||void 0===n?void 0:n.nodes)&&(e.svg.nodes=JSON.parse(JSON.stringify(e.svg.nodes).replace(new RegExp(t,"g"),i.toString())))})),o=JSON.parse(JSON.stringify(o).replace(new RegExp(t,"g"),i.toString()))}}));var a=i.variable.variables.map((function(e){return e.key}));l=l.filter((function(e){return a.indexOf(e.key)<0}));var s=i.variable.conditions.length;o.sort((function(e,t){return e.idx-t.idx})).map((function(e,t){return e.idx=t+1,e})).forEach((function(i,n){console.log(`${t}(b=${e.board_id}) -> ${i.idx} + ${s} = ${i.idx+s}`),i.idx=i.idx+s})),i.data.slides=i.data.slides.concat(n),i.variable.conditions=i.variable.conditions.concat(o),i.variable.variables=i.variable.variables.concat(l)})),i},gn=(e,t)=>{let{id:i,size:n,animate:r}=e,o=JSON.parse(JSON.stringify({id:i,size:n,animate:r}));r?r.value=t:r={value:t},nn.history.push([{type:"animate",from:o,to:JSON.parse(JSON.stringify({id:i,size:n,animate:r}))}])},pn=(e,t)=>{let{id:i,size:n,animate:r}=e,o=JSON.parse(JSON.stringify({id:i,size:n,animate:r}));r?r.in=t:r={in:t},nn.history.push([{type:"animate",from:o,to:JSON.parse(JSON.stringify({id:i,size:n,animate:r}))}])},yn=(e,t)=>{let{id:i,size:n,animate:r}=e,o=JSON.parse(JSON.stringify({id:i,size:n,animate:r}));r?r.out=t:r={out:t},nn.history.push([{type:"animate",from:o,to:JSON.parse(JSON.stringify({id:i,size:n,animate:r}))}])},fn=(e,t)=>{let{id:i,interactive:n}=e,r=JSON.parse(JSON.stringify({id:i,interactive:n}));n?n.show?n.show.action?n.show.action.value=t:n.show.action={value:t}:n.show={action:{value:t}}:n={show:{action:{value:t}}},nn.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:i,interactive:n}))}])},mn=(e,t)=>{let{id:i,interactive:n}=e,r=JSON.parse(JSON.stringify({id:i,interactive:n}));n?n.show?n.show.action?n.show.action.points=t:n.show.action={points:t}:n.show={action:{points:t}}:n={show:{action:{points:t}}},nn.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:i,interactive:n}))}])},bn=(e,t)=>{let{id:i,interactive:n}=e,r=JSON.parse(JSON.stringify({id:i,interactive:n}));n?n.show?n.show.action?n.show.action.time=t:n.show.action={time:t}:n.show={action:{time:t}}:n={show:{action:{time:t}}},nn.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:i,interactive:n}))}])},wn=(e,t)=>{let{id:i,interactive:n}=e,r=JSON.parse(JSON.stringify({id:i,interactive:n}));n?n.show?n.show.action?n.show.action.iteration=t:n.show.action={iteration:t}:n.show={action:{iteration:t}}:n={show:{action:{iteration:t}}},nn.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:i,interactive:n}))}])},Sn=(e,t)=>{let{id:i,interactive:n}=e,r=JSON.parse(JSON.stringify({id:i,interactive:n}));n?n.show?n.show.action?n.show.action.finish=t:n.show.action={finish:t}:n.show={action:{finish:t}}:n={show:{action:{finish:t}}},nn.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:i,interactive:n}))}])},xn=(e,t)=>{let{id:i,interactive:n}=e,r=JSON.parse(JSON.stringify({id:i,interactive:n}));n?n.show?n.show.audio?n.show.audio.source=t:n.show.audio={source:t}:n.show={audio:{source:t}}:n={show:{audio:{source:t}}},nn.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:i,interactive:n}))}])},kn=(e,t)=>{let{id:i,interactive:n}=e,r=JSON.parse(JSON.stringify({id:i,interactive:n}));n?n.show?n.show.audio?n.show.audio.iteration=t:n.show.audio={iteration:t}:n.show={audio:{iteration:t}}:n={show:{audio:{iteration:t}}},nn.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:i,interactive:n}))}]),-1==t&&_n(e,"change-slide")},On=(e,t)=>{let{id:i,interactive:n}=e,r=JSON.parse(JSON.stringify({id:i,interactive:n}));n?n.show?n.show.audio?n.show.audio.finish=t:n.show.audio={finish:t}:n.show={audio:{finish:t}}:n={show:{audio:{finish:t}}},nn.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:i,interactive:n}))}])},_n=(e,t)=>{let{id:i,interactive:n}=e,r=JSON.parse(JSON.stringify({id:i,interactive:n}));n?n.show?n.show.audio?n.show.audio.async=t:n.show.audio={async:t}:n.show={audio:{async:t}}:n={show:{audio:{async:t}}},nn.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:i,interactive:n}))}])},Nn=(e,t)=>{let{id:i,interactive:n}=e,r=JSON.parse(JSON.stringify({id:i,interactive:n}));n?n.show?n.show.audio?n.show.audio.time=t:n.show.audio={time:t}:n.show={audio:{time:t}}:n={show:{audio:{time:t}}},nn.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:i,interactive:n}))}])},En=(e,t)=>{let{id:i,interactive:n}=e,r=JSON.parse(JSON.stringify({id:i,interactive:n}));n?n.show?n.show.triggershow?n.show.triggershow.id=t:n.show.triggershow={id:t}:n.show={triggershow:{id:t}}:n={show:{triggershow:{id:t}}},nn.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:i,interactive:n}))}])},In=(e,t)=>{let{id:i,interactive:n}=e,r=JSON.parse(JSON.stringify({id:i,interactive:n}));n?n.show?n.show.triggershow?n.show.triggershow.ids=t:n.show.triggershow={ids:t}:n.show={triggershow:{ids:t}}:n={show:{triggershow:{ids:t}}},nn.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:i,interactive:n}))}])},zn=(e,t)=>{let{id:i,interactive:n}=e,r=JSON.parse(JSON.stringify({id:i,interactive:n}));n?n.show?n.show.triggershow?n.show.triggershow.async=t:n.show.triggershow={async:t}:n.show={triggershow:{async:t}}:n={show:{triggershow:{async:t}}},nn.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:i,interactive:n}))}])},Jn=(e,t)=>{let{id:i,interactive:n}=e,r=JSON.parse(JSON.stringify({id:i,interactive:n}));n?n.show?n.show.triggershow?n.show.triggershow.time=t:n.show.triggershow={time:t}:n.show={triggershow:{time:t}}:n={show:{triggershow:{time:t}}},nn.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:i,interactive:n}))}])},jn=(e,t)=>{let{id:i,interactive:n}=e,r=JSON.parse(JSON.stringify({id:i,interactive:n}));n?n.show?n.show.triggerrun?n.show.triggerrun.id=t:n.show.triggerrun={id:t}:n.show={triggerrun:{id:t}}:n={show:{triggerrun:{id:t}}},nn.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:i,interactive:n}))}])},Tn=(e,t)=>{let{id:i,interactive:n}=e,r=JSON.parse(JSON.stringify({id:i,interactive:n}));n?n.show?n.show.triggerrun?n.show.triggerrun.ids=t:n.show.triggerrun={ids:t}:n.show={triggerrun:{ids:t}}:n={show:{triggerrun:{ids:t}}},nn.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:i,interactive:n}))}])},$n=(e,t)=>{let{id:i,interactive:n}=e,r=JSON.parse(JSON.stringify({id:i,interactive:n}));n?n.show?n.show.triggerrun?n.show.triggerrun.async=t:n.show.triggerrun={async:t}:n.show={triggerrun:{async:t}}:n={show:{triggerrun:{async:t}}},nn.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:i,interactive:n}))}])},Cn=(e,t)=>{let{id:i,interactive:n}=e,r=JSON.parse(JSON.stringify({id:i,interactive:n}));n?n.show?n.show.triggerrun?n.show.triggerrun.time=t:n.show.triggerrun={time:t}:n.show={triggerrun:{time:t}}:n={show:{triggerrun:{time:t}}},nn.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:i,interactive:n}))}])},An=(e,t)=>{let{id:i,interactive:n}=e,r=JSON.parse(JSON.stringify({id:i,interactive:n}));n?n.show?n.show.triggerhide?n.show.triggerhide.id=t:n.show.triggerhide={id:t}:n.show={triggerhide:{id:t}}:n={show:{triggerhide:{id:t}}},nn.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:i,interactive:n}))}])},Bn=(e,t)=>{let{id:i,interactive:n}=e,r=JSON.parse(JSON.stringify({id:i,interactive:n}));n?n.show?n.show.triggerhide?n.show.triggerhide.ids=t:n.show.triggerhide={ids:t}:n.show={triggerhide:{ids:t}}:n={show:{triggerhide:{ids:t}}},nn.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:i,interactive:n}))}])},Rn=(e,t)=>{let{id:i,interactive:n}=e,r=JSON.parse(JSON.stringify({id:i,interactive:n}));n?n.show?n.show.triggerhide?n.show.triggerhide.async=t:n.show.triggerhide={async:t}:n.show={triggerhide:{async:t}}:n={show:{triggerhide:{async:t}}},nn.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:i,interactive:n}))}])},Mn=(e,t)=>{let{id:i,interactive:n}=e,r=JSON.parse(JSON.stringify({id:i,interactive:n}));n?n.show?n.show.triggerhide?n.show.triggerhide.time=t:n.show.triggerhide={time:t}:n.show={triggerhide:{time:t}}:n={show:{triggerhide:{time:t}}},nn.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:i,interactive:n}))}])},Ln=(e,t)=>{let{id:i,interactive:n}=e,r=JSON.parse(JSON.stringify({id:i,interactive:n}));n?n.click?n.click.action?n.click.action.value=t:n.click.action={value:t}:n.click={action:{value:t}}:n={click:{action:{value:t}}},nn.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:i,interactive:n}))}])},Pn=(e,t)=>{let{id:i,interactive:n}=e,r=JSON.parse(JSON.stringify({id:i,interactive:n}));n?n.click?n.click.action?n.click.action.points=t:n.click.action={points:t}:n.click={action:{points:t}}:n={click:{action:{points:t}}},nn.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:i,interactive:n}))}])},Fn=(e,t)=>{let{id:i,interactive:n}=e,r=JSON.parse(JSON.stringify({id:i,interactive:n}));n?n.click?n.click.action?n.click.action.time=t:n.click.action={time:t}:n.click={action:{time:t}}:n={click:{action:{time:t}}},nn.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:i,interactive:n}))}])},Kn=(e,t)=>{let{id:i,interactive:n}=e,r=JSON.parse(JSON.stringify({id:i,interactive:n}));n?n.click?n.click.action?n.click.action.iteration=t:n.click.action={iteration:t}:n.click={action:{iteration:t}}:n={click:{action:{iteration:t}}},nn.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:i,interactive:n}))}])},Gn=(e,t)=>{let{id:i,interactive:n}=e,r=JSON.parse(JSON.stringify({id:i,interactive:n}));n?n.click?n.click.action?n.click.action.finish=t:n.click.action={finish:t}:n.click={action:{finish:t}}:n={click:{action:{finish:t}}},nn.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:i,interactive:n}))}])},Dn=(e,t)=>{let{id:i,interactive:n}=e,r=JSON.parse(JSON.stringify({id:i,interactive:n}));n?n.click?n.click.audio?n.click.audio.source=t:n.click.audio={source:t}:n.click={audio:{source:t}}:n={click:{audio:{source:t}}},nn.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:i,interactive:n}))}])},Qn=(e,t)=>{let{id:i,interactive:n}=e,r=JSON.parse(JSON.stringify({id:i,interactive:n}));n?n.click?n.click.audio?n.click.audio.iteration=t:n.click.audio={iteration:t}:n.click={audio:{iteration:t}}:n={click:{audio:{iteration:t}}},nn.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:i,interactive:n}))}]),-1==t&&_n(e,"change-slide")},Un=(e,t)=>{let{id:i,interactive:n}=e,r=JSON.parse(JSON.stringify({id:i,interactive:n}));n?n.click?n.click.audio?n.click.audio.finish=t:n.click.audio={finish:t}:n.click={audio:{finish:t}}:n={click:{audio:{finish:t}}},nn.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:i,interactive:n}))}])},Wn=(e,t)=>{let{id:i,interactive:n}=e,r=JSON.parse(JSON.stringify({id:i,interactive:n}));n?n.click?n.click.audio?n.click.audio.async=t:n.click.audio={async:t}:n.click={audio:{async:t}}:n={click:{audio:{async:t}}},nn.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:i,interactive:n}))}])},Vn=(e,t)=>{let{id:i,interactive:n}=e,r=JSON.parse(JSON.stringify({id:i,interactive:n}));n?n.click?n.click.audio?n.click.audio.time=t:n.click.audio={time:t}:n.click={audio:{time:t}}:n={click:{audio:{time:t}}},nn.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:i,interactive:n}))}])},Hn=(e,t)=>{let{id:i,interactive:n}=e,r=JSON.parse(JSON.stringify({id:i,interactive:n}));n?n.click?n.click.triggershow?n.click.triggershow.id=t:n.click.triggershow={id:t}:n.click={triggershow:{id:t}}:n={click:{triggershow:{id:t}}},nn.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:i,interactive:n}))}])},Xn=(e,t)=>{let{id:i,interactive:n}=e,r=JSON.parse(JSON.stringify({id:i,interactive:n}));n?n.click?n.click.triggershow?n.click.triggershow.ids=t:n.click.triggershow={ids:t}:n.click={triggershow:{ids:t}}:n={click:{triggershow:{ids:t}}},nn.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:i,interactive:n}))}])},qn=(e,t)=>{let{id:i,interactive:n}=e,r=JSON.parse(JSON.stringify({id:i,interactive:n}));n?n.click?n.click.triggershow?n.click.triggershow.async=t:n.click.triggershow={async:t}:n.click={triggershow:{async:t}}:n={click:{triggershow:{async:t}}},nn.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:i,interactive:n}))}])},Yn=(e,t)=>{let{id:i,interactive:n}=e,r=JSON.parse(JSON.stringify({id:i,interactive:n}));n?n.click?n.click.triggershow?n.click.triggershow.time=t:n.click.triggershow={time:t}:n.click={triggershow:{time:t}}:n={click:{triggershow:{time:t}}},nn.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:i,interactive:n}))}])},Zn=(e,t)=>{let{id:i,interactive:n}=e,r=JSON.parse(JSON.stringify({id:i,interactive:n}));n?n.click?n.click.triggerrun?n.click.triggerrun.id=t:n.click.triggerrun={id:t}:n.click={triggerrun:{id:t}}:n={click:{triggerrun:{id:t}}},nn.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:i,interactive:n}))}])},er=(e,t)=>{let{id:i,interactive:n}=e,r=JSON.parse(JSON.stringify({id:i,interactive:n}));n?n.click?n.click.triggerrun?n.click.triggerrun.ids=t:n.click.triggerrun={ids:t}:n.click={triggerrun:{ids:t}}:n={click:{triggerrun:{ids:t}}},nn.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:i,interactive:n}))}])},tr=(e,t)=>{let{id:i,interactive:n}=e,r=JSON.parse(JSON.stringify({id:i,interactive:n}));n?n.click?n.click.triggerrun?n.click.triggerrun.async=t:n.click.triggerrun={async:t}:n.click={triggerrun:{async:t}}:n={click:{triggerrun:{async:t}}},nn.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:i,interactive:n}))}])},ir=(e,t)=>{let{id:i,interactive:n}=e,r=JSON.parse(JSON.stringify({id:i,interactive:n}));n?n.click?n.click.triggerrun?n.click.triggerrun.time=t:n.click.triggerrun={time:t}:n.click={triggerrun:{time:t}}:n={click:{triggerrun:{time:t}}},nn.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:i,interactive:n}))}])},nr=(e,t)=>{let{id:i,interactive:n}=e,r=JSON.parse(JSON.stringify({id:i,interactive:n}));n?n.click?n.click.triggerhide?n.click.triggerhide.id=t:n.click.triggerhide={id:t}:n.click={triggerhide:{id:t}}:n={click:{triggerhide:{id:t}}},nn.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:i,interactive:n}))}])},rr=(e,t)=>{let{id:i,interactive:n}=e,r=JSON.parse(JSON.stringify({id:i,interactive:n}));n?n.click?n.click.triggerhide?n.click.triggerhide.ids=t:n.click.triggerhide={ids:t}:n.click={triggerhide:{ids:t}}:n={click:{triggerhide:{ids:t}}},nn.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:i,interactive:n}))}])},or=(e,t)=>{let{id:i,interactive:n}=e,r=JSON.parse(JSON.stringify({id:i,interactive:n}));n?n.click?n.click.triggerhide?n.click.triggerhide.async=t:n.click.triggerhide={async:t}:n.click={triggerhide:{async:t}}:n={click:{triggerhide:{async:t}}},nn.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:i,interactive:n}))}])},lr=(e,t)=>{let{id:i,interactive:n}=e,r=JSON.parse(JSON.stringify({id:i,interactive:n}));n?n.click?n.click.triggerhide?n.click.triggerhide.time=t:n.click.triggerhide={time:t}:n.click={triggerhide:{time:t}}:n={click:{triggerhide:{time:t}}},nn.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:i,interactive:n}))}])},ar=(e,t)=>{let{id:i,interactive:n}=e,r=JSON.parse(JSON.stringify({id:i,interactive:n}));n?n.click?n.click.slide?(n.click.slide.id=null==t?void 0:t.id,n.click.slide.code=null==t?void 0:t.code):n.click.slide=t:n.click={slide:t}:n={click:{slide:t}},nn.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:i,interactive:n}))}])},sr=(e,t)=>{let{id:i,interactive:n}=e,r=JSON.parse(JSON.stringify({id:i,interactive:n}));n?n.click?n.click.media=t:n.click={media:t}:n={click:{media:t}},nn.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:i,interactive:n}))}])},dr=(e,t)=>{let{id:i,interactive:n}=e,r=JSON.parse(JSON.stringify({id:i,interactive:n}));n?n.click?n.click.image?n.click.image.source=t:n.click.image={source:t}:n.click={image:{source:t}}:n={click:{image:{source:t}}},nn.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:i,interactive:n}))}])},ur=(e,t)=>{let{id:i,interactive:n}=e,r=JSON.parse(JSON.stringify({id:i,interactive:n}));n?n.click?n.click.video?n.click.video.source=t:n.click.video={source:t}:n.click={video:{source:t}}:n={click:{video:{source:t}}},nn.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:i,interactive:n}))}])},cr=(e,t)=>{let{id:i,interactive:n}=e,r=JSON.parse(JSON.stringify({id:i,interactive:n}));n?n.click?n.click.link?n.click.link.source=t:n.click.link={source:t}:n.click={link:{source:t}}:n={click:{link:{source:t}}},nn.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:i,interactive:n}))}])},hr=(e,t)=>{let{id:i,interactive:n}=e,r=JSON.parse(JSON.stringify({id:i,interactive:n}));n?n.click?n.click.link?n.click.link.source?n.click.link.source.url=t:n.click.link.source={url:t}:n.click.link={source:{url:t}}:n.click={link:{source:{url:t}}}:n={click:{link:{source:{url:t}}}},nn.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:i,interactive:n}))}])},vr=(e,t)=>{let{id:i,interactive:n}=e,r=JSON.parse(JSON.stringify({id:i,interactive:n}));n?n.click?n.click.text?n.click.text.content=t:n.click.text={content:t}:n.click={text:{content:t}}:n={click:{text:{content:t}}},nn.history.push([{type:"interactive",from:r,to:JSON.parse(JSON.stringify({id:i,interactive:n}))}])},gr=(e,t)=>{let{id:i,variable:n}=e,r=JSON.parse(JSON.stringify({id:i,variable:n}));n?n.input?n.input.variable=t:n.input={variable:t}:n={input:{variable:t}},nn.history.push([{type:"variable",from:r,to:JSON.parse(JSON.stringify({id:i,variable:n}))}])},pr=(e,t)=>{let{id:i,variable:n}=e,r=JSON.parse(JSON.stringify({id:i,variable:n}));n?n.click?n.click.variable=t:n.click={variable:t}:n={click:{variable:t}},nn.history.push([{type:"variable",from:r,to:JSON.parse(JSON.stringify({id:i,variable:n}))}])},yr=(e,t)=>{let{id:i,variable:n}=e,r=JSON.parse(JSON.stringify({id:i,variable:n}));n?n.click?n.click.operator=t:n.click={operator:t}:n={click:{operator:t}},nn.history.push([{type:"variable",from:r,to:JSON.parse(JSON.stringify({id:i,variable:n}))}])},fr=(e,t)=>{let{id:i,variable:n}=e,r=JSON.parse(JSON.stringify({id:i,variable:n}));n?n.click?n.click.valuetype=t:n.click={valuetype:t}:n={click:{valuetype:t}},nn.history.push([{type:"variable",from:r,to:JSON.parse(JSON.stringify({id:i,variable:n}))}])},mr=(e,t)=>{let{id:i,variable:n}=e,r=JSON.parse(JSON.stringify({id:i,variable:n}));n?n.click?n.click.value=t:n.click={value:t}:n={click:{value:t}},nn.history.push([{type:"variable",from:r,to:JSON.parse(JSON.stringify({id:i,variable:n}))}])},br=e=>{let t=[];e.forEach(((e,i)=>{let{id:n,size:r,attribute:o}=e;t.push(JSON.parse(JSON.stringify({id:n,size:r,attribute:o})))}));let i=999999;for(let{size:t}of e)i=Math.min(i,t.x);for(let{id:t,type:n,size:r,attribute:o}of e)r.x=i,Object.assign(o,ie(n,r,o)),Ge(window.document.getElementById(t),o);nn.history.push(e.map(((e,i)=>{let{id:n,size:r,attribute:o}=e;return{type:"size",from:t[i],to:JSON.parse(JSON.stringify({id:n,size:r,attribute:o}))}})))},wr=e=>{let t=[];e.forEach(((e,i)=>{let{id:n,size:r,attribute:o}=e;t.push(JSON.parse(JSON.stringify({id:n,size:r,attribute:o})))}));let i=999999;for(let{size:t}of e)i=Math.min(i,t.y);for(let{id:t,type:n,size:r,attribute:o}of e)r.y=i,Object.assign(o,ie(n,r,o)),Ge(window.document.getElementById(t),o);nn.history.push(e.map(((e,i)=>{let{id:n,size:r,attribute:o}=e;return{type:"size",from:t[i],to:JSON.parse(JSON.stringify({id:n,size:r,attribute:o}))}})))},Sr=e=>{let t=[];e.forEach(((e,i)=>{let{id:n,size:r,attribute:o}=e;t.push(JSON.parse(JSON.stringify({id:n,size:r,attribute:o})))}));let i=-999999;for(let{size:t}of e)i=Math.max(i,t.x+t.width);for(let{id:t,type:n,size:r,attribute:o}of e)r.x=i-r.width,Object.assign(o,ie(n,r,o)),Ge(window.document.getElementById(t),o);nn.history.push(e.map(((e,i)=>{let{id:n,size:r,attribute:o}=e;return{type:"size",from:t[i],to:JSON.parse(JSON.stringify({id:n,size:r,attribute:o}))}})))},xr=e=>{let t=[];e.forEach(((e,i)=>{let{id:n,size:r,attribute:o}=e;t.push(JSON.parse(JSON.stringify({id:n,size:r,attribute:o})))}));let i=-999999;for(let{size:t}of e)i=Math.max(i,t.y+t.height);for(let{id:t,type:n,size:r,attribute:o}of e)r.y=i-r.height,Object.assign(o,ie(n,r,o)),Ge(window.document.getElementById(t),o);nn.history.push(e.map(((e,i)=>{let{id:n,size:r,attribute:o}=e;return{type:"size",from:t[i],to:JSON.parse(JSON.stringify({id:n,size:r,attribute:o}))}})))},kr=e=>{let t=[];e.forEach(((e,i)=>{let{id:n,size:r,attribute:o}=e;t.push(JSON.parse(JSON.stringify({id:n,size:r,attribute:o})))}));let i=999999,n=-999999,r=0;for(let{size:t}of e)i=Math.min(i,t.x),n=Math.max(n,t.x+t.width);r=B((i+n)/2);for(let{id:t,type:i,size:n,attribute:o}of e)n.x=B(r-n.width/2),Object.assign(o,ie(i,n,o)),Ge(window.document.getElementById(t),o);nn.history.push(e.map(((e,i)=>{let{id:n,size:r,attribute:o}=e;return{type:"size",from:t[i],to:JSON.parse(JSON.stringify({id:n,size:r,attribute:o}))}})))},Or=e=>{let t=[];e.forEach(((e,i)=>{let{id:n,size:r,attribute:o}=e;t.push(JSON.parse(JSON.stringify({id:n,size:r,attribute:o})))}));let i=999999,n=-999999,r=0;for(let{size:t}of e)i=Math.min(i,t.y),n=Math.max(n,t.y+t.height);r=B((i+n)/2);for(let{id:t,type:i,size:n,attribute:o}of e)n.y=B(r-n.height/2),Object.assign(o,ie(i,n,o)),Ge(window.document.getElementById(t),o);nn.history.push(e.map(((e,i)=>{let{id:n,size:r,attribute:o}=e;return{type:"size",from:t[i],to:JSON.parse(JSON.stringify({id:n,size:r,attribute:o}))}})))},_r=e=>{var t,i,n;let r=[];e.forEach(((e,t)=>{let{id:i,size:n,attribute:o}=e;r.push(JSON.parse(JSON.stringify({id:i,size:n,attribute:o})))}));let o=null!==(n=null===(i=null===(t=nn.data.slide)||void 0===t?void 0:t.svg)||void 0===i?void 0:i.viewBox.x)&&void 0!==n?n:0;for(let{id:t,type:i,size:n,attribute:r}of e)n.x=o,Object.assign(r,ie(i,n,r)),Ge(window.document.getElementById(t),r);nn.history.push(e.map(((e,t)=>{let{id:i,size:n,attribute:o}=e;return{type:"size",from:r[t],to:JSON.parse(JSON.stringify({id:i,size:n,attribute:o}))}})))},Nr=e=>{var t,i,n;let r=[];e.forEach(((e,t)=>{let{id:i,size:n,attribute:o}=e;r.push(JSON.parse(JSON.stringify({id:i,size:n,attribute:o})))}));let o=null!==(n=null===(i=null===(t=nn.data.slide)||void 0===t?void 0:t.svg)||void 0===i?void 0:i.viewBox.y)&&void 0!==n?n:0;for(let{id:t,type:i,size:n,attribute:r}of e)n.y=o,Object.assign(r,ie(i,n,r)),Ge(window.document.getElementById(t),r);nn.history.push(e.map(((e,t)=>{let{id:i,size:n,attribute:o}=e;return{type:"size",from:r[t],to:JSON.parse(JSON.stringify({id:i,size:n,attribute:o}))}})))},Er=e=>{var t,i,n;let r=[];e.forEach(((e,t)=>{let{id:i,size:n,attribute:o}=e;r.push(JSON.parse(JSON.stringify({id:i,size:n,attribute:o})))}));let{x:o,width:l}=null!==(n=null===(i=null===(t=nn.data.slide)||void 0===t?void 0:t.svg)||void 0===i?void 0:i.viewBox)&&void 0!==n?n:{x:0,width:0},a=o+l;for(let{id:t,type:i,size:n,attribute:r}of e)n.x=a-n.width,Object.assign(r,ie(i,n,r)),Ge(window.document.getElementById(t),r);nn.history.push(e.map(((e,t)=>{let{id:i,size:n,attribute:o}=e;return{type:"size",from:r[t],to:JSON.parse(JSON.stringify({id:i,size:n,attribute:o}))}})))},Ir=e=>{var t,i,n;let r=[];e.forEach(((e,t)=>{let{id:i,size:n,attribute:o}=e;r.push(JSON.parse(JSON.stringify({id:i,size:n,attribute:o})))}));let{y:o,height:l}=null!==(n=null===(i=null===(t=nn.data.slide)||void 0===t?void 0:t.svg)||void 0===i?void 0:i.viewBox)&&void 0!==n?n:{y:0,height:0},a=o+l;for(let{id:t,type:i,size:n,attribute:r}of e)n.y=a-n.height,Object.assign(r,ie(i,n,r)),Ge(window.document.getElementById(t),r);nn.history.push(e.map(((e,t)=>{let{id:i,size:n,attribute:o}=e;return{type:"size",from:r[t],to:JSON.parse(JSON.stringify({id:i,size:n,attribute:o}))}})))},zr=e=>{var t,i,n;let r=[];e.forEach(((e,t)=>{let{id:i,size:n,attribute:o}=e;r.push(JSON.parse(JSON.stringify({id:i,size:n,attribute:o})))}));let{x:o,width:l}=null!==(n=null===(i=null===(t=nn.data.slide)||void 0===t?void 0:t.svg)||void 0===i?void 0:i.viewBox)&&void 0!==n?n:{x:0,width:0},a=B((o+(o+l))/2);for(let{id:t,type:i,size:n,attribute:r}of e)n.x=B(a-n.width/2),Object.assign(r,ie(i,n,r)),Ge(window.document.getElementById(t),r);nn.history.push(e.map(((e,t)=>{let{id:i,size:n,attribute:o}=e;return{type:"size",from:r[t],to:JSON.parse(JSON.stringify({id:i,size:n,attribute:o}))}})))},Jr=e=>{var t,i,n;let r=[];e.forEach(((e,t)=>{let{id:i,size:n,attribute:o}=e;r.push(JSON.parse(JSON.stringify({id:i,size:n,attribute:o})))}));let{y:o,height:l}=null!==(n=null===(i=null===(t=nn.data.slide)||void 0===t?void 0:t.svg)||void 0===i?void 0:i.viewBox)&&void 0!==n?n:{y:0,height:0},a=B((o+(o+l))/2);for(let{id:t,type:i,size:n,attribute:r}of e)n.y=B(a-n.height/2),Object.assign(r,ie(i,n,r)),Ge(window.document.getElementById(t),r);nn.history.push(e.map(((e,t)=>{let{id:i,size:n,attribute:o}=e;return{type:"size",from:r[t],to:JSON.parse(JSON.stringify({id:i,size:n,attribute:o}))}})))},jr=e=>{if(e.length<3)return;let t=[];e.forEach(((e,i)=>{let{id:n,type:r,size:o,attribute:l}=e;t.push(JSON.parse(JSON.stringify({id:n,size:o,attribute:l})))}));let i=999999,n=-999999,r=[],o=e.length;for(let t=0;t<o;t++){let{id:i,size:n}=e[t];r.push({idx:t,id:i,x:n.x+n.width/2})}r=r.sort(((e,t)=>e.x-t.x)),i=r[0].x,n=r[o-1].x;let l=n-i;for(let t=1,n=r.length-2;t<=n;t++){let{id:n,type:a,size:s,attribute:d}=e[r[t].idx];s.x=i+l*t/(o-1)-s.width/2,Object.assign(d,ie(a,s,d)),Ge(window.document.getElementById(n),d)}nn.history.push(e.map(((e,i)=>{let{id:n,type:r,size:o,attribute:l}=e;return{type:"size",from:t[i],to:JSON.parse(JSON.stringify({id:n,size:o,attribute:l}))}})))},Tr=e=>{if(e.length<3)return;let t=[];e.forEach(((e,i)=>{let{id:n,size:r,attribute:o}=e;t.push(JSON.parse(JSON.stringify({id:n,size:r,attribute:o})))}));let i=999999,n=-999999,r=[],o=e.length;for(let t=0;t<o;t++){let{id:i,size:n}=e[t];r.push({idx:t,id:i,y:n.y+n.height/2})}r=r.sort(((e,t)=>e.y-t.y)),i=r[0].y,n=r[o-1].y;let l=n-i;for(let t=1,n=r.length-2;t<=n;t++){let{id:n,type:a,size:s,attribute:d}=e[r[t].idx];s.y=i+l*t/(o-1)-s.height/2,Object.assign(d,ie(a,s,d)),Ge(window.document.getElementById(n),d)}nn.history.push(e.map(((e,i)=>{let{id:n,size:r,attribute:o}=e;return{type:"size",from:t[i],to:JSON.parse(JSON.stringify({id:n,size:r,attribute:o}))}})))},$r=e=>{var t,i,n;let r=[];e.forEach(((e,t)=>{let{id:i,type:n,size:o,attribute:l}=e;r.push(JSON.parse(JSON.stringify({id:i,size:o,attribute:l})))}));let{x:o,width:l}=null!==(n=null===(i=null===(t=nn.data.slide)||void 0===t?void 0:t.svg)||void 0===i?void 0:i.viewBox)&&void 0!==n?n:{x:0,width:0};for(let{id:t,type:i,size:n,attribute:r}of e)n.x=o,n.width=l,Object.assign(r,ie(i,n,r)),Ge(window.document.getElementById(t),r);nn.history.push(e.map(((e,t)=>{let{id:i,type:n,size:o,attribute:l}=e;return{type:"size",from:r[t],to:JSON.parse(JSON.stringify({id:i,size:o,attribute:l}))}})))},Cr=e=>{var t,i,n;let r=[];e.forEach(((e,t)=>{let{id:i,size:n,attribute:o}=e;r.push(JSON.parse(JSON.stringify({id:i,size:n,attribute:o})))}));let{y:o,height:l}=null!==(n=null===(i=null===(t=nn.data.slide)||void 0===t?void 0:t.svg)||void 0===i?void 0:i.viewBox)&&void 0!==n?n:{y:0,height:0};for(let{id:t,type:i,size:n,attribute:r}of e)n.y=o,n.height=l,Object.assign(r,ie(i,n,r)),Ge(window.document.getElementById(t),r);nn.history.push(e.map(((e,t)=>{let{id:i,size:n,attribute:o}=e;return{type:"size",from:r[t],to:JSON.parse(JSON.stringify({id:i,size:n,attribute:o}))}})))},Ar=(e,t)=>{let{id:i,size:n,attribute:r}=e,o=JSON.parse(JSON.stringify({id:i,size:n,attribute:r}));r.opacity="number"==typeof t?B(t,100):void 0,Ge(window.document.getElementById(i),r),nn.history.push([{type:"attribute",from:o,to:JSON.parse(JSON.stringify({id:i,size:n,attribute:r}))}])},Br=(e,t)=>{let{id:i,size:n,attribute:r}=e,o=JSON.parse(JSON.stringify({id:i,size:n,attribute:r}));t?rn(t)&&(r.fill=t):r.fill=void 0,Ge(window.document.getElementById(i),r),nn.history.push([{type:"attribute",from:o,to:JSON.parse(JSON.stringify({id:i,size:n,attribute:r}))}])},Rr=(e,t)=>{let{id:i,size:n,attribute:r}=e,o=JSON.parse(JSON.stringify({id:i,size:n,attribute:r}));r.fillOpacity="number"==typeof t?B(t/100,100):void 0,Ge(window.document.getElementById(i),r),nn.history.push([{type:"attribute",from:o,to:JSON.parse(JSON.stringify({id:i,size:n,attribute:r}))}])},Mr=(e,t)=>{let{id:i,size:n,attribute:r}=e,o=JSON.parse(JSON.stringify({id:i,size:n,attribute:r}));t?rn(t)&&(r.stroke=t):r.stroke=void 0,Ge(window.document.getElementById(i),r),nn.history.push([{type:"attribute",from:o,to:JSON.parse(JSON.stringify({id:i,size:n,attribute:r}))}])},Lr=(e,t)=>{let{id:i,size:n,attribute:r}=e,o=JSON.parse(JSON.stringify({id:i,size:n,attribute:r}));r.strokeOpacity="number"==typeof t?B(t/100,100):void 0,Ge(window.document.getElementById(i),r),nn.history.push([{type:"attribute",from:o,to:JSON.parse(JSON.stringify({id:i,size:n,attribute:r}))}])},Pr=(e,t)=>{let{id:i,size:n,attribute:r}=e,o=JSON.parse(JSON.stringify({id:i,size:n,attribute:r}));r.strokeWidth="number"==typeof t?B(t,100):void 0,Ge(window.document.getElementById(i),r),nn.history.push([{type:"attribute",from:o,to:JSON.parse(JSON.stringify({id:i,size:n,attribute:r}))}])},Fr=(e,t)=>{let{id:i,size:n,attribute:r}=e,o=JSON.parse(JSON.stringify({id:i,size:n,attribute:r}));r.strokeDasharray="number"==typeof t?B(t,100):void 0,Ge(window.document.getElementById(i),r),nn.history.push([{type:"attribute",from:o,to:JSON.parse(JSON.stringify({id:i,size:n,attribute:r}))}])},Kr=(e,t)=>{let{id:i,size:n,attribute:r}=e,o=JSON.parse(JSON.stringify({id:i,size:n,attribute:r}));r.strokeLinecap=t,Ge(window.document.getElementById(i),r),nn.history.push([{type:"attribute",from:o,to:JSON.parse(JSON.stringify({id:i,size:n,attribute:r}))}])},Gr=(e,t)=>{let{id:i,size:n,attribute:r}=e,o=JSON.parse(JSON.stringify({id:i,size:n,attribute:r}));r.strokeLinejoin=t,Ge(window.document.getElementById(i),r),nn.history.push([{type:"attribute",from:o,to:JSON.parse(JSON.stringify({id:i,size:n,attribute:r}))}])},Dr=(e,t)=>{let{id:i,size:n,attribute:r}=e,o=JSON.parse(JSON.stringify({id:i,size:n,attribute:r}));r.preserveAspectRatio=t,Ge(window.document.getElementById(i),r),nn.history.push([{type:"attribute",from:o,to:JSON.parse(JSON.stringify({id:i,size:n,attribute:r}))}])},Qr=(e,t)=>{let{id:i,size:n,attribute:r}=e,o=JSON.parse(JSON.stringify({id:i,size:n,attribute:r}));r.fontFamily=t,Ge(window.document.getElementById(i),r),nn.history.push([{type:"attribute",from:o,to:JSON.parse(JSON.stringify({id:i,size:n,attribute:r}))}])},Ur=(e,t)=>{let{id:i,size:n,attribute:r}=e,o=JSON.parse(JSON.stringify({id:i,size:n,attribute:r}));r.fontWeight=t,Ge(window.document.getElementById(i),r),nn.history.push([{type:"attribute",from:o,to:JSON.parse(JSON.stringify({id:i,size:n,attribute:r}))}])},Wr=(e,t)=>{let{id:i,size:n,attribute:r}=e,o=JSON.parse(JSON.stringify({id:i,size:n,attribute:r}));r.fontStyle=t,Ge(window.document.getElementById(i),r),nn.history.push([{type:"attribute",from:o,to:JSON.parse(JSON.stringify({id:i,size:n,attribute:r}))}])},Vr=(e,t)=>{let{id:i,size:n,attribute:r}=e,o=JSON.parse(JSON.stringify({id:i,size:n,attribute:r}));r.fontSize="number"==typeof t?B(t,100):void 0,Ge(window.document.getElementById(i),r),nn.history.push([{type:"attribute",from:o,to:JSON.parse(JSON.stringify({id:i,size:n,attribute:r}))}])},Hr=(e,t)=>{let{id:i,size:n,attribute:r}=e,o=JSON.parse(JSON.stringify({id:i,size:n,attribute:r}));r.textLength="number"==typeof t?B(t,100):void 0,Ge(window.document.getElementById(i),r),nn.history.push([{type:"attribute",from:o,to:JSON.parse(JSON.stringify({id:i,size:n,attribute:r}))}])},Xr=(e,t)=>{let{id:i,size:n,attribute:r}=e,o=JSON.parse(JSON.stringify({id:i,size:n,attribute:r}));r.letterSpacing="number"==typeof t?B(t,100):void 0,Ge(window.document.getElementById(i),r),nn.history.push([{type:"attribute",from:o,to:JSON.parse(JSON.stringify({id:i,size:n,attribute:r}))}])},qr=(e,t)=>{let{id:i,size:n,attribute:r}=e,o=JSON.parse(JSON.stringify({id:i,size:n,attribute:r}));r.wordSpacing="number"==typeof t?B(t,100):void 0,Ge(window.document.getElementById(i),r),nn.history.push([{type:"attribute",from:o,to:JSON.parse(JSON.stringify({id:i,size:n,attribute:r}))}])},Yr=(e,t)=>{let{id:i,size:n,attribute:r}=e,o=JSON.parse(JSON.stringify({id:i,size:n,attribute:r}));r.textDecoration=t,Ge(window.document.getElementById(i),r),nn.history.push([{type:"attribute",from:o,to:JSON.parse(JSON.stringify({id:i,size:n,attribute:r}))}])},Zr=(e,t)=>{let{id:i,size:n,attribute:r}=e,o=JSON.parse(JSON.stringify({id:i,size:n,attribute:r}));r.textAnchor=t,Ge(window.document.getElementById(i),r),nn.history.push([{type:"attribute",from:o,to:JSON.parse(JSON.stringify({id:i,size:n,attribute:r}))}])},eo=(e,t)=>{let{id:i,size:n,attribute:r}=e,o=JSON.parse(JSON.stringify({id:i,size:n,attribute:r}));r.dominantBaseline=t,Ge(window.document.getElementById(i),r),nn.history.push([{type:"attribute",from:o,to:JSON.parse(JSON.stringify({id:i,size:n,attribute:r}))}])},to=(e,t)=>{let{id:i,size:n,attribute:r}=e,o=JSON.parse(JSON.stringify({id:i,size:n,attribute:r}));r.r="number"==typeof t?B(t,100):void 0,Ge(window.document.getElementById(i),r),nn.history.push([{type:"attribute",from:o,to:JSON.parse(JSON.stringify({id:i,size:n,attribute:r}))}])},io=(e,t)=>{let{id:i,size:n,attribute:r}=e,o=JSON.parse(JSON.stringify({id:i,size:n,attribute:r}));r.rx="number"==typeof t?B(t,100):void 0,Ge(window.document.getElementById(i),r),nn.history.push([{type:"attribute",from:o,to:JSON.parse(JSON.stringify({id:i,size:n,attribute:r}))}])},no=(e,t)=>{let{id:i,size:n,attribute:r}=e,o=JSON.parse(JSON.stringify({id:i,size:n,attribute:r}));r.ry="number"==typeof t?B(t,100):void 0,Ge(window.document.getElementById(i),r),nn.history.push([{type:"attribute",from:o,to:JSON.parse(JSON.stringify({id:i,size:n,attribute:r}))}])},ro=(e,t)=>{let{id:i,style:n}=e,r=JSON.parse(JSON.stringify({id:i,style:n}));n?n.padding=B(t):n={padding:B(t)},De(window.document.getElementById(i),n),nn.history.push([{type:"style",from:r,to:JSON.parse(JSON.stringify({id:i,style:n}))}])},oo=(e,t)=>{let{id:i,style:n}=e,r=JSON.parse(JSON.stringify({id:i,style:n}));n?n.borderWidth=t:n={borderWidth:t},De(window.document.getElementById(i),n),nn.history.push([{type:"style",from:r,to:JSON.parse(JSON.stringify({id:i,style:n}))}])},lo=(e,t)=>{let{id:i,style:n}=e,r=JSON.parse(JSON.stringify({id:i,style:n}));n?n.borderStyle=t:n={borderStyle:t},De(window.document.getElementById(i),n),nn.history.push([{type:"style",from:r,to:JSON.parse(JSON.stringify({id:i,style:n}))}])},ao=(e,t)=>{let{id:i,style:n}=e,r=JSON.parse(JSON.stringify({id:i,style:n})),o=e=>{n?n.borderColor=e:n={borderColor:e}};t?rn(t)&&o(t):o(),De(window.document.getElementById(i),n),nn.history.push([{type:"style",from:r,to:JSON.parse(JSON.stringify({id:i,style:n}))}])},so=(e,t)=>{let{id:i,style:n}=e,r=JSON.parse(JSON.stringify({id:i,style:n}));n?n.borderOpacity="number"==typeof t?B(t/100,100):void 0:n={borderOpacity:"number"==typeof t?B(t/100,100):void 0},De(window.document.getElementById(i),n),nn.history.push([{type:"style",from:r,to:JSON.parse(JSON.stringify({id:i,style:n}))}])},uo=(e,t)=>{let{id:i,style:n}=e,r=JSON.parse(JSON.stringify({id:i,style:n}));n?n.borderRadius=B(t):n={borderRadius:B(t)},De(window.document.getElementById(i),n),nn.history.push([{type:"style",from:r,to:JSON.parse(JSON.stringify({id:i,style:n}))}])},co=(e,t)=>{let{id:i,style:n}=e,r=JSON.parse(JSON.stringify({id:i,style:n}));n?n.fontFamily=t:n={fontFamily:t},De(window.document.getElementById(i),n),nn.history.push([{type:"style",from:r,to:JSON.parse(JSON.stringify({id:i,style:n}))}])},ho=(e,t)=>{let{id:i,style:n}=e,r=JSON.parse(JSON.stringify({id:i,style:n}));n?n.fontSize=t:n={fontSize:t},De(window.document.getElementById(i),n),nn.history.push([{type:"style",from:r,to:JSON.parse(JSON.stringify({id:i,style:n}))}])},vo=(e,t)=>{let{id:i,style:n}=e,r=JSON.parse(JSON.stringify({id:i,style:n})),o=e=>{n?n.color=e:n={color:e}};t?rn(t)&&o(t):o(),De(window.document.getElementById(i),n),nn.history.push([{type:"style",from:r,to:JSON.parse(JSON.stringify({id:i,style:n}))}])},go=(e,t)=>{let{id:i,style:n}=e,r=JSON.parse(JSON.stringify({id:i,style:n}));n?n.opacity="number"==typeof t?B(t/100,100):void 0:n={opacity:"number"==typeof t?B(t/100,100):void 0},De(window.document.getElementById(i),n),nn.history.push([{type:"style",from:r,to:JSON.parse(JSON.stringify({id:i,style:n}))}])},po=(e,t)=>{let{id:i,style:n}=e,r=JSON.parse(JSON.stringify({id:i,style:n})),o=e=>{n?n.backgroundColor=e:n={backgroundColor:e}};t?rn(t)&&o(t):o(),De(window.document.getElementById(i),n),nn.history.push([{type:"style",from:r,to:JSON.parse(JSON.stringify({id:i,style:n}))}])},yo=(e,t)=>{let{id:i,style:n}=e,r=JSON.parse(JSON.stringify({id:i,style:n}));n?n.backgroundOpacity="number"==typeof t?B(t/100,100):void 0:n={backgroundOpacity:"number"==typeof t?B(t/100,100):void 0},De(window.document.getElementById(i),n),nn.history.push([{type:"style",from:r,to:JSON.parse(JSON.stringify({id:i,style:n}))}])},fo=(e,t)=>{e.svg?e.svg.viewBox?e.svg.viewBox.x=B(t):e.svg.viewBox={x:B(t),y:0,width:1e3,height:1e3}:e.svg={viewBox:{x:B(t),y:0,width:1e3,height:1e3}}},mo=(e,t)=>{e.svg?e.svg.viewBox?e.svg.viewBox.y=B(t):e.svg.viewBox={x:0,y:B(t),width:1e3,height:1e3}:e.svg={viewBox:{x:0,y:B(t),width:1e3,height:1e3}}},bo=(e,t,i)=>{e.svg?e.svg.viewBox?(i&&(e.svg.viewBox.height=B(t*e.svg.viewBox.height/e.svg.viewBox.width)),e.svg.viewBox.width=B(t)):e.svg.viewBox={x:0,y:0,width:B(t),height:B(t)}:e.svg={viewBox:{x:0,y:0,width:B(t),height:B(t)}}},wo=(e,t,i)=>{e.svg?e.svg.viewBox?(i&&(e.svg.viewBox.width=B(t*e.svg.viewBox.width/e.svg.viewBox.height)),e.svg.viewBox.height=B(t)):e.svg.viewBox={x:0,y:0,width:B(t),height:B(t)}:e.svg={viewBox:{x:0,y:0,width:B(t),height:B(t)}}},So=(e,t)=>{e.svg?e.svg.background?e.svg.background.color=t:e.svg.background={color:t}:e.svg={background:{color:t}},Le(e)},xo=(e,t)=>{e.svg?e.svg.background?e.svg.background.opacity="number"==typeof t?B(t/100,100):void 0:e.svg.background={opacity:"number"==typeof t?B(t/100,100):void 0}:e.svg={background:{opacity:"number"==typeof t?B(t/100,100):void 0}},Le(e)},ko=(e,t)=>{e.svg?e.svg.background?(e.svg.background.path=null==t?void 0:t.path,e.svg.background.url=null==t?void 0:t.url,e.svg.background.name=null==t?void 0:t.name):e.svg.background=t:e.svg={background:t},Le(e)}}},i={};function n(e){var r=i[e];if(void 0!==r)return r.exports;var o=i[e]={exports:{}};return t[e](o,o.exports,n),o.exports}n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},e=n(249),window.addEventListener("load",(function(){var t;e.icdt.container="#mainContainer",e.icdt.svg="#mainSvg";var i,n,r,o=document.getElementById("mainActionList"),l=0,a=1;(null===_board_setting||void 0===_board_setting?void 0:_board_setting.buttons.paging)&&(n=document.createElement("button"),(r=new Image).height=40,r.title="Fullscreen",r.src="public/icon/Back.png",n.append(r),o.append(n),n.onclick=function(){l>0&&(l--,e.icdt_Run.runSlide(l))},(i=document.createElement("div")).className="page-info",i.textContent="".concat(l+1,"/").concat(a),o.append(i),e.icdt_Run.onChangeSlide=function(e,t,n,r,o){l=n,a=r,i.textContent="".concat(l+1,"/").concat(a)},function(){var t=document.createElement("button"),i=new Image;i.height=40,i.title="Fullscreen",i.src="public/icon/Next.png",t.append(i),o.append(t),t.onclick=function(){l<a-1&&(l++,e.icdt_Run.runSlide(l))}}()),(null===_board_setting||void 0===_board_setting?void 0:_board_setting.buttons.refresh)&&function(){var t=document.createElement("button"),i=new Image;i.height=40,i.title="Fullscreen",i.src="public/icon/Refresh.png",t.append(i),o.append(t),t.onclick=function(){e.icdt_Run.runSlide(l)}}(),(null===(t=null===_board_setting||void 0===_board_setting?void 0:_board_setting.buttons)||void 0===t?void 0:t.fullscreen)&&function(){var e=function(){return!!((e=document).fullscreen||e.fullscreenElement||e.webkitFullscreenElement||e.mozFullScreenElement||e.msFullscreenElement);var e},t=document.createElement("button"),i=new Image;i.height=40,i.title="Fullscreen",i.src=e()?"public/icon/Fullscreen_on.png":"public/icon/Fullscreen_off.png",t.append(i),o.append(t),t.onclick=function(){var t;e()?(t=document).exitFullscreen?t.exitFullscreen():t.mozCancelFullScreen?t.mozCancelFullScreen():t.webkitExitFullscreen?t.webkitExitFullscreen():t.msExitFullscreen&&t.msExitFullscreen():function(){var e;(e=document.body).requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen()}(),setTimeout((function(){i.src=e()?"public/icon/Fullscreen_on.png":"public/icon/Fullscreen_off.png"}),600)}}();e.icdt.config={fileuploadurl:"/",readfileuploadurl:"files/"},e.icdt_Run.data=_board_content,e.icdt_Run.runSlide();var s=_board_content.fonts||[];(0,e.APP_FONT_Content)(s.filter((function(e){return"Roboto"!=e})),"https://www.tabca.vn/fonts")}))})();